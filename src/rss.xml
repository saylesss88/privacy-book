<?xml version="1.0" encoding="utf-8"?><rss version="2.0"><channel><title>privacy-book</title><link>https://saylesss88.github.io/privacy-book/</link><description>An mdBook-generated site</description><generator>mdbook-rss-feed 1.0.0</generator><item><title>RethinkDNS</title><link>https://saylesss88.github.io/privacy-book/android/RethinkDNS_Guide.html</link><description><![CDATA[<h1>RethinkDNS</h1>
<details>
<summary> ‚úîÔ∏è Click to Expand Table of Contents</summary>
<!-- toc -->
</details>
<p><img src="images/rethinkdns.cleaned.png" alt="RethinkDNS Logo" /></p>
<blockquote>
<p>I‚Äôm not affiliated with RethinkDNS in any way, I‚Äôm just a technologist and
privacy advocate.</p>
</blockquote>
<h3>üîë Key Terms</h3>
<details>
<summary> ‚úîÔ∏è Click to Expand Key Terms </summary>
<ul>
<li>
<p><strong>HTTP</strong> (HyperText Transfer Protocol): The standard protocol used by web
browsers and servers to transfer web pages and related resources over the
internet.</p>
</li>
<li>
<p><strong>HTTPS</strong>: HTTP encrypted using TLS is often referred to as HTTPS.
TLS-encrypted web traffic is by convention exchanged on port 443 by default,
while unencrypted HTTP uses port 80 by default.</p>
</li>
<li>
<p><strong>TLS</strong> (Transport Layer Security) is an encryption protocol and is the
standard for enabling two networked applications or devices to exchange
information privately and robustly.</p>
</li>
<li>
<p><strong>Mixed content</strong>: is when an otherwise secure website uses resources fetched
via HTTP or other insecure protocols.</p>
</li>
<li>
<p><strong>IP</strong> (Internet Protocol): The address system of the internet that routes
data packets from source to destination devices. IP operates at the network
layer and does not guarantee delivery order or error checking, which is
handled by TCP.</p>
</li>
<li>
<p><strong>IP Address</strong> (Internet Protocol Address): A unique numeric label assigned to
each device on a network, used to identify and locate the device for
communication.</p>
</li>
<li>
<p><strong>Subnet</strong> (Subnet Range): represents a block of IP addresses grouped together
under a single rule. Instead of allowing or blocking individual IP addresses
one by one, you define a subnet to include a wide range of IPs within that
block.(Useful for apps that you <code>Isolate</code>).</p>
</li>
<li>
<p><strong>Host</strong>: Any device connected to a network with an IP address, capable of
sending and receiving data, including computers, phones, or servers.</p>
</li>
<li>
<p><strong>Client</strong>: A device or software (often your computer or phone) that initiates
requests to servers to access resources or services, forming the client-server
model of communication.</p>
</li>
<li>
<p><strong>Port</strong>: A port in networking is a virtual communication endpoint managed by
a computer‚Äôs operating system that helps direct network traffic to specific
apps or services. While an IP address identifies a device on a network, ports
allow the system to know exactly which app or service should handle the
incoming or outgoing data. Web traffic commonly uses port 80 (HTTP) or 443
(HTTPS), so when data arrives for those ports, it‚Äôs routed to the web server
application on the device. When we block port 80, we block insecure HTTP
connections.</p>
</li>
<li>
<p><strong>TCP</strong> (Transmission Control Protocol) is responsible for maintaining a
connection through a handshake and putting the packets in the correct order.
TCP will also ask for missing pieces and is known as a reliable but slow
protocol.</p>
</li>
<li>
<p><strong>UDP</strong> (User Datagram Protocol) (UDP/IP): is a fast protocol used across the
internet for time-sensitive transmissions such as DNS lookups or VoIP. UDP
allows a computer to send data straight to another without requiring a
handshake.</p>
</li>
<li>
<p><strong>DNS</strong> (Domain Name System): stores domain information in a distributed
database and translates domain names into IP addresses and vice versa. This
enables us to only have to remember simple domain names rather than complex IP
addresses.</p>
</li>
</ul>
<blockquote>
<p>Domain Name</p>
<pre><code class="language-text">ssd.eff.org
 |   |   |
 |   |  top-level domain
 |   |
 |   second-level domain
 |
subdomain
</code></pre>
<p>‚òùÔ∏è The hierarchy is read from right to left, the TLD is the highest-level
domain (<code>.org</code> here), the second-level domain (<code>eff</code>) is directly to the left
of the TLD, and anything further left (like <code>ssd</code>) is a subdomain under that
second-level domain.</p>
</blockquote>
<ul>
<li>
<p><strong>DNS Server</strong>: When you search for a domain name (rethinkdns.com) it triggers
a DNS lookup. Several different types of DNS servers typically work together
to complete a single DNS lookup.</p>
</li>
<li>
<p><strong>DNS Resolver</strong>: is a server or software component that translates domain
names into IP addresses that devices use to communicate.</p>
</li>
<li>
<p><strong>Unicast DNS</strong>: The traditional DNS setup where each DNS server is assigned a
unique, single IP address. DNS queries from clients are directed to this
specific server regardless of the clients location.</p>
</li>
<li>
<p><strong>Anycast DNS</strong>: Anycast allows a single IP address to be used by multiple
servers. In Anycast DNS, a DNS query can be answered by any one of several DNS
servers, usually the one closest to the user by geographic or network
proximity. This setup reduces latency, increases the availability of DNS
resolution services, and offers protection against DNS flood DDoS attacks by
distributing traffic across multiple servers.</p>
</li>
<li>
<p><strong>Recursive resolver</strong> (DNS recursor): is typically the first stop in the
series of the above servers.</p>
</li>
<li>
<p><strong>Iterative resolver</strong>: In an iterative DNS query, each DNS server responds
directly to the client with a referral to another server, and the client
continues querying successive servers until it receives the IP address for the
requested domain.</p>
</li>
<li>
<p><strong>Proxy</strong>: A proxy, in relation to Orbot with Rethink, is an intermediary
service that routes internet traffic from your device through the Tor network
to provide privacy and anonymity.</p>
</li>
<li>
<p><strong>HTTP(S) Proxy</strong>: An HTTP proxy is an intermediary server that forwards
HTTP/HTTPS web traffic from a client (e.g., a browser or app) to destination
servers, allowing for privacy, filtering, or routing control while masking the
user‚Äôs IP. HTTP proxies only work with web traffic (HTTP/HTTPS).</p>
</li>
<li>
<p><strong>SOCKS5</strong> (Socket Secure 5): Is an internet proxy protocol that transfers
info from one server to another while redirecting the user‚Äôs IP address. It
supports both UDP and TCP and can actually improve speed in some cases.</p>
</li>
<li>
<p><a href="https://github.com/pi-hole/pi-hole">pi-hole</a>: a DNS sinkhole that protects
your devices content without installing any client-side software.</p>
</li>
<li>
<p><a href="https://github.com/evilsocket/opensnitch">OpenSnitch</a>: is a GNU/Linux
application firewall.</p>
</li>
<li>
<p><em>proxifier</em>: a proxifier acts as a proxy client, routing specific application
traffic through proxy servers without encrypting data or providing global IP
masking.</p>
</li>
<li>
<p><em>VPN</em> (Virtual Private Network): a VPN creates an encrypted tunnel that routes
all network traffic from your device through a remote server, masking your IP
address and securing your entire connection.</p>
</li>
<li>
<p>WireGuard: a modern VPN encryption protocol, its fast and has gained
widespread adoption among VPN providers.</p>
</li>
<li>
<p>OpenVPN: an older, more mature VPN protocol that uses SSL/TLS for encryption.
It‚Äôs known for being very reliable and highly configurable but tends to be
slower and more complex than WireGuard. Good VPNs often give you the choice
between protocols.</p>
</li>
<li>
<p><code>Bypass DNS and Firewall</code>: Bypass the DNS and Firewall for this app, <strong>this
only works with Rethink‚Äôs DNS</strong>.</p>
</li>
<li>
<p><code>Bypass Universal</code>: Bypass the Universal firewall for this app.</p>
</li>
<li>
<p><code>Exclude</code>: The app is excluded from the dns and firewall, Rethink is unaware
of this app.</p>
</li>
<li>
<p><code>Isolate</code>: When an app is isolated, only trusted IPs are allowed. (i.e., IPs
or domains you explicitly set trust rules for).</p>
</li>
<li>
<p>üõú(Unmetered Wi-Fi): Wi-Fi settings, either blocked or allowed.</p>
</li>
<li>
<p>üì∂ (Metered mobile): Mobile data settings, either blocked or allowed.</p>
</li>
</ul>
</details>
<hr />
<h2><a href="#rethinkdns-overview">RethinkDNS Overview</a></h2>
<ul>
<li>
<p><code>Bypass DNS and Firewall</code>: Bypass the DNS and Firewall for this app, <strong>this
only works with Rethink‚Äôs DNS</strong>.</p>
</li>
<li>
<p><code>Bypass Universal</code>: Bypass the Universal firewall for this app.</p>
</li>
<li>
<p><code>Exclude</code>: The app is excluded from the dns and firewall, Rethink is unaware
of this app.</p>
</li>
<li>
<p><code>Isolate</code>: When an app is isolated, only trusted IPs are allowed. (i.e., IPs
or domains you explicitly set trust rules for).</p>
</li>
<li>
<p>üõú(Unmetered Wi-Fi): Wi-Fi settings, either blocked or allowed.</p>
</li>
<li>
<p>üì∂ (Metered mobile): Mobile data settings, either blocked or allowed.</p>
</li>
</ul>
<p>The DNS mode routes all DNS traffic generated by all apps to <strong>any</strong> user chosen
DNS-over-HTTPS, DNS-over-TLS, DNSCrypt, or Oblivious DNS-over-HTTPS resolver.</p>
<p>Firewalls like Rethink that block both UDP and TCP connections are usually
sufficient because nearly all applications rely on these two protocols for their
networking and communication. Almost every app communicates over TCP or UDP, so
blocking these protocols effectively restricts most network traffic from and to
apps, preventing them from connecting without permission.</p>
<p>I will share how I use RethinkDNS, obviously feel free to make changes based on
your threat model and needs.</p>
<p>Different versions of the RethinkDNS have different features and capabilities.
The best version in my opinion is the F-Droid version.</p>
<ul>
<li><a href="https://f-droid.org/en/">F-Droid Download</a></li>
</ul>
<hr />
<h2>Getting Started</h2>
<h3>DNS</h3>
<p>I was surprised to see that GrapheneOS recommends that people use their own
‚Äúnetwork provided DNS servers for general purpose usage‚Äù (i.e., Your ISPs DNS).
They say that ‚Äúusing the network-provided DNS servers is the best way to blend
in with other users‚Äù. Network and web sites can fingerprint and track users
based on non-default DNS configurations.
‚Äì<a href="https://grapheneos.org/faq#default-dns">grapheneos default-dns</a></p>
<p>Given that it is a fact that many ISPs are known to share this data and do other
privacy disrespecting things, I would personally rather make it harder for them.
I included this because they are the experts and the choice is yours, I use a
custom DNS myself. I guess since so many people virtue-signal saying that they
‚Äúhave nothing to hide‚Äù(a reckless, privileged notion) that not many people truly
care about privacy and are likely using the default. The more people that we can
convince to use privacy respecting tools, the better it is for everybody.</p>
<p>Recommended Resolvers:</p>
<details>
<summary> ‚úîÔ∏è Click to Expand recommended resolvers </summary>
<p>These are just the providers I‚Äôve researched personally and not in a specific
order. It‚Äôs recommended to regularly test and switch between DNS providers as
location and network conditions play a factor. There are DNS benchmarking tools
available to either download or use in-browser.</p>
<p>A few examples:</p>
<ul>
<li>
<p><a href="https://dnsspeedtest.online/">https://dnsspeedtest.online/</a></p>
</li>
<li>
<p><a href="https://www.grc.com/dns/benchmark.htm">https://www.grc.com/dns/benchmark.htm</a></p>
</li>
</ul>
<hr />
<ul>
<li>
<p><strong>Quad9</strong> is known to enforce strong standards in cryptography and was the
first to use DNSSEC cryptographic validation.</p>
<ul>
<li><a href="https://quad9.net/privacy/policy/">Quad9 privacy policy</a></li>
</ul>
</li>
<li>
<p>Mullvad DNS</p>
<ul>
<li><a href="https://mullvad.net/en/help/privacy-policy">Mullvad privacy policy</a></li>
</ul>
</li>
<li>
<p>NextDNS</p>
<ul>
<li><a href="https://nextdns.io/privacy">NextDNS privacy policy</a></li>
</ul>
</li>
<li>
<p>Cloudflare publishes regular transparency reports and undergoes independent
audits and have a great blog explaining the technology which is a major plus.
GrapheneOS sets Cloudflare as the fallback due to their good privacy policy,
and widespread usage.</p>
<ul>
<li><a href="https://www.cloudflare.com/privacypolicy/">Cloudflare Privacy Policy</a></li>
</ul>
</li>
<li>
<p>RethinkDNS: Their DNS code is open source so anyone can audit it themselves.
They do not collect PII nor seek to profile its users, transparency is great.</p>
<ul>
<li><a href="https://rethinkdns.com/privacy">DNS Privacy Policy for stub resolvers</a></li>
<li><a href="https://fly.io/legal/privacy-policy/">Fly.io privacy policy for the recursive resolver</a></li>
</ul>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/dns/">PrivacyGuides DNS Recommendations</a></p>
</li>
</ul>
</details>
<p>Throughout this article, I‚Äôll be discussing the <strong>RethinkDNS Android App</strong>.
We‚Äôll later reference the <strong>DNS Blocklist configuring website</strong>, which is
available at <a href="https://rethinkdns.com/configure">rethinkdns.com/configure</a>.</p>
<blockquote>
<p>‚ùó NOTE: When you switch to an encrypted DNS resolver, you are shifting your
trust from your ISP‚Äôs DNS servers to the third-party DNS provider you choose.
Encryption protects your DNS queries from being seen or intercepted by
outsiders, like your ISP or network eavesdroppers, which improves privacy.
However, the DNS resolver itself still sees all your queries and could
potentially log, analyze, or misuse that data.</p>
</blockquote>
<p>That said, it‚Äôs quite common for ISPs to engage in practices that compromise
user privacy. Do some research, whats their business model, privacy policy, etc.
Unfortunately, with a VPN you are also just shifting the trust. Don‚Äôt blindly
choose a VPN either.</p>
<ul>
<li><a href="https://cyberinsider.com/internet-service-providers-isp-privacy-data-collection/">ISP data-collection</a></li>
</ul>
<p><code>Configure -&gt; DNS -&gt; Other DNS</code>:</p>
<ul>
<li>
<p>Choose the type of resolver you want, I use DNSCrypt. Once you click you can
choose the specific resolver you want such as Quad9. You may notice that it
says <code>Failed: using fallback DNS</code>. This is only because we haven‚Äôt turned it
on yet, we will recheck this once we turn it on.</p>
</li>
<li>
<p>If you want a relay in a specific country, you can click the <code>Relays</code> tab. For
DNSCrypt you are given the choice between the Netherlands, France, Sweden, Los
Angeles, and Singapore. You might do this if you were trying to circumvent
censorship.</p>
</li>
</ul>
<p><strong>Rules</strong> set the following:</p>
<ul>
<li>
<p><code>Advanced DNS filtering (experimental)</code>: Assign unique IP per DNS request.</p>
</li>
<li>
<p><code>Prompt on blocklist updates</code>: This is for if you use Rethink‚Äôs custom
blocklists.</p>
</li>
<li>
<p><code>Prevent DNS leaks</code>: When enabled, Rethink captures all packets on port 53 and
forwards it to a user-set DNS endpoint.</p>
</li>
</ul>
<p>Leave all the <code>Advanced</code> defaults unless you plan on setting up a SOCKS5 proxy,
in which case you will want to enable <code>Configure -&gt; DNS -&gt; Never proxy DNS</code>.</p>
<hr />
<p>F-Droid Specific:</p>
<ul>
<li>
<p><code>Split DNS (experimental)</code>: Forward DNS queries from proxied apps to the
proxy‚Äôs DNS servers.</p>
</li>
<li>
<p><code>Treat DNS rules as firewall rules (experimental)</code>: DNS blocking will be
bypassed during resolution; the decision will be made at connection time.</p>
</li>
<li>
<p>Set <code>Use fallback DNS as bypass</code>: where it always uses your fallback DNS for
bypassed apps, domains and IPs.</p>
</li>
<li>
<p>You can also set <code>Use System DNS for undelgated domains</code> which is generally
safe to enable and useful if access to local network devices or custom
internal domains is needed.</p>
</li>
</ul>
<hr />
<p><strong>Blocklists</strong>:</p>
<p>This is a cool feature, similar to NextDNS if I understand correctly. Since it‚Äôs
a system-wide DNS filter it applys to any app that is run through Rethink, not
only your browser, <strong>every app</strong>.</p>
<p>Blocklists are available when you use Rethink‚Äôs DNS.</p>
<p><code>Configure -&gt; DNS -&gt; Rethink DNS</code>:</p>
<ul>
<li>
<p>Choose between <code>Sky</code> with higher uptime and a stub resolver at cloudflare.com,
OR <code>Max</code> which is more private and has its recursive resolver at fly.io.</p>
</li>
<li>
<p>Choose between the preconfigured blocklists, OR Click <code>RDNS Plus</code>, <code>EDIT</code>,
<code>ADVANCED</code>, Search blocklists: <code>hagezi</code>, <code>Multi Pro++ (HaGeZi)</code>,
<code>APPLY (RDNS PLUS)</code></p>
</li>
<li>
<p>You can manually Check for an update to the blocklists, which you should
because they are updated regularly with new identified threats. You can also
enable <code>Prompt on blocklist update</code>.</p>
</li>
<li>
<p><a href="https://github.com/hagezi/dns-blocklists/wiki/FAQ#sources">hagezi which version should I use?</a></p>
</li>
<li>
<p><a href="https://oisd.nl/">oisd</a></p>
</li>
</ul>
<hr />
<p><strong>F-Droid &amp; Github Versions</strong></p>
<p>When on the F-Droid and GitHub versions of the Rethink, you can download
blocklists from <code>Configure -&gt; DNS -&gt; On-device blocklists</code>, and have them setup
for <strong>any</strong> DNS upstream.</p>
<p>There is a known bug where it sometimes when you click <code>DOWNLOAD BLOCKLISTS</code> it
just keeps listening and never receives anything. The GitHub <code>v05.5n</code> was
affected by this.</p>
<p>This <strong>does work</strong> on the F-Droid version.</p>
<p>For example, if you want to use ODoH with the HAGEZI Blocklist you could:</p>
<p>Go to <code>Configure -&gt; DNS -&gt; Other DNS</code>, Choose <code>ODoH</code> with <code>Cloudflare</code>. Start
it.</p>
<p>Now in <code>Configure -&gt; DNS -&gt; RULES</code>, tap <code>On-device blocklists</code>, and click the
disabled logo, then click <code>DOWNLOAD BLOCKLISTS</code>. Once the download is complete,
you can select <code>Configure</code> and select <code>ADVANCED</code> and search for HAGEZI, choose
MULTI PRO++ and maybe oisd small, then press <code>APPLY (ON-DEVICE)</code>.</p>
<p>Now any app that doesn‚Äôt bypass Rethink will use your chosen blocklists, denying
access to malicious URLs.</p>
<p>The HAGEZI blocklists are respected for being updated frequently. There are
different levels with MULTI PRO++ (HAGEZI) being the highest and 4 other lest
strict levels.</p>
<hr />
<h3>Network</h3>
<p>Settings explained:</p>
<ul>
<li>
<p><strong>Loopback proxy forwarder apps</strong>: Enable when you want all of your devices
proxy-related traffic to also flow through Rethinks encrypted tunnel. It
ensures apps that proxy DNS/HTTP/SOCKS traffic don‚Äôt leak outside the VPN.</p>
</li>
<li>
<p><strong>Do not route Private IPs</strong>: Prevents routing traffic destined for private IP
address ranges (like 192.168.x.x, 10.x.x.x) through the tunnel. Instead, this
traffic goes directly over the local network or system default route. Most
useful when you want devices on your local network (NAS, printers, etc.) to be
reachable by apps on your phone without routing the traffic through Rethinks
tunnel, improving performance and reliability of local connections but
possibly reducing privacy.</p>
</li>
<li>
<p><strong>Loopback (experimental)</strong>: When enabled, this routes RethinkDNS‚Äôs own
internal traffic, such as blocklist downloads, connectivity checks, and DNS
queries made by the app itself, back into the encrypted tunnel through the
loopback device.</p>
</li>
</ul>
<table><thead><tr><th>Setting</th><th>Function</th><th>When to Use</th></tr></thead><tbody>
<tr><td>Loopback Proxy Forwarder Apps</td><td>Route proxy-forwarder app traffic back into Rethink VPN tunnel</td><td>When you want consistent VPN/privacy coverage for proxies</td></tr>
<tr><td>Do Not Route Private IPs</td><td>Avoid routing local network/private IP traffic through VPN (send directly)</td><td>To access local devices without VPN bottlenecks</td></tr>
<tr><td>Loopback (Experimental)</td><td>Route Rethink‚Äôs own app traffic (updates/checks) back through VPN tunnel</td><td>To fully protect app‚Äôs own DNS/blocklist traffic</td></tr>
</tbody></table>
<p>NOTE: The above settings are disabled by default because some are experimental
and can easily break functionality. I have found that the settings below give
the most functionality without breakage üëáÔ∏è:</p>
<p><code>Configure -&gt; Network</code>:</p>
<ul>
<li>
<p>Set <code>Use all available networks</code> to ON. This enables Wifi and mobile data to
be used at the same time by Rethink. (Optional, may use more battery)</p>
</li>
<li>
<p><strong>Set your IP version</strong>: The default is <code>IPv4</code>, you can choose between
<code>IPv6 (experimental)</code> and <code>Auto (experimental)</code>.</p>
</li>
<li>
<p><strong>Choose fallback DNS</strong>: When your user-preferred DNS is not reachable,
fallback DNS will used.</p>
<ul>
<li>With the F-Droid version in <code>Configure -&gt; DNS -&gt; ADVANCED</code>. You can enable
<code>Use fallback DNS as bypass</code>, which always uses fallback DNS for bypassed
apps, domains, and IPs.</li>
</ul>
</li>
<li>
<p>I personally disable <code>Enable network visibility</code>, just keep in mind that some
apps may break.</p>
<ul>
<li>‚ÄúShutting this off prevents apps from accessing all available networks,
stopping them from bypassing Rethinks tunnel‚Äù. This caused issues with the
browser when turned off.(Some audio/video conference apps like Zoom and Meet
require this)</li>
</ul>
</li>
</ul>
<hr />
<h3>Firewall</h3>
<p><code>Configure -&gt; Firewall -&gt; Universal firewall rules</code> and set the following to ON:</p>
<ul>
<li>
<p><code>Block all apps when device is locked</code></p>
</li>
<li>
<p><code>Block when DNS is bypassed</code></p>
</li>
<li>
<p><code>Block port 80 (insecure HTTP) traffic</code></p>
</li>
</ul>
<p>You can get more restrictive from here, but it will take some manual
intervention to get everything working correctly.</p>
<p>Keep your firewall rules in mind when you‚Äôre configuring per app settings. If
the Universal firewall blocks all apps when the device is locked, do you want
this app affected by this or do you want to let it Bypass the Universal
firewall?</p>
<hr />
<h2>Turn ON DNS and Firewall</h2>
<p><code>Home</code> üè†:</p>
<ul>
<li>Click the big <code>Start</code> button on the bottom of the screen and leave it set to
the default <code>DNS and Firewall (default)</code></li>
</ul>
<p>Now that we‚Äôve started the DNS and Firewall, we can go back to
<code>Configure -&gt; DNS</code> and ensure the provider we chose started successfully. You
can also experiment with different types of resolvers, make sure to wait for
below the chosen resolver to say <code>Connected</code>.</p>
<p>Now, all apps on your device by default allow both Wi-Fi and mobile data access
<strong>through the RethinkDNS encrypted tunnel</strong>. Try some of your most used Apps to
see if they function correctly.</p>
<p>RethinkDNS‚Äôs firewall blocks or restricts any network traffic that isn‚Äôt
explicitly allowed. Although by default all apps are allowed network access,
some apps require special permissions or bypasses due to their network behavior.
Many apps rely on multiple external services, backend APIs, etc. that may be
blocked by the firewall.</p>
<hr />
<h3>Apps that Don‚Äôt work</h3>
<p>I will use Reddit as an example, the process is the same for any app. Reddit‚Äôs
app and website rely on multiple third-party services and external domains
beyond just <code>reddit.com</code> itself.</p>
<p>For apps that don‚Äôt work it‚Äôs important to ensure that your Android systems
<code>Private DNS</code> is set to <code>Automatic</code>.</p>
<p><code>Home -&gt; Apps</code>:</p>
<p>Search for <code>Reddit</code>, click on it and the Firewall Rules For Reddit will pop up.
Since it is already allowed <code>Unmetered</code> and <code>Metered</code> connections and still
doesn‚Äôt work, we can try one setting at a time until it does work and this is
the same process for other Apps that aren‚Äôt working.</p>
<ul>
<li>
<p>First, you should check your logs and see why it‚Äôs being blocked. Look at the
domains involved and set trust rules for said domains. (start by trusting
reddit.com). Check the logs again, add any domains that were blocked related
to reddit. If it is unclear why networking still isn‚Äôt working, you can:</p>
</li>
<li>
<p><code>Bypass Universal</code>, this allows it to bypass any Universal Firewall rules you
have set.</p>
</li>
<li>
<p>If you‚Äôre using Rethink‚Äôs DNS, you can try allowing the app to
<code>Bypass DNS &amp; Firewall</code>. Try the app again, does it work? If not:</p>
</li>
<li>
<p>You can also <code>Isolate</code> an App, you then have to set up <em>trust | allow</em> rules
for domains or IPs over a period of time which can take a while. You can go to
<code>Apps</code> and search for the app in question, click on it and at the bottom of
the screen you‚Äôll see <code>IP Logs</code>, and <code>Domain Logs</code> to help with this.</p>
</li>
<li>
<p><code>Exclude</code> the app. This makes RethinkDNS completely unaware of the app and is
often what is required for Reddit. It is my understanding that after you
<code>Exclude</code> Reddit for example, your systems Automatic Secure DNS will pick it
up.</p>
</li>
</ul>
<hr />
<h3>Other Methods</h3>
<p>Rather than watching the logs and setting trust rules over time, you could use
tools like <code>nslookup</code> and <code>dig</code> to resolve said domain and reveal IP ranges
used.</p>
<pre><code class="language-bash">nslookup reddit.com
Server:         127.0.0.1
Address:        127.0.0.1#53

Non-authoritative answer:
Name:   reddit.com
Address: 151.101.129.140
Name:   reddit.com
Address: 151.101.193.140
Name:   reddit.com
Address: 151.101.1.140
Name:   reddit.com
Address: 151.101.65.140
Name:   reddit.com
Address: 2a04:4e42::396
Name:   reddit.com
Address: 2a04:4e42:600::396
Name:   reddit.com
Address: 2a04:4e42:200::396
Name:   reddit.com
Address: 2a04:4e42:400::396
</code></pre>
<p>Resolving a domain (like <code>reddit.com</code>) using tools like <code>nslookup</code> or <code>dig</code>
reveals multiple IPs because large services use multiple servers across CDNs and
networks for redundancy and performance.</p>
<p>You can then run <code>whois</code> on one of those IPs (e.g., <code>whois 151.101.129.140</code>) to
identify the subnet ranges owned by Reddit‚Äôs CDN provider (Fastly in this case),
which helps when setting up subnet range allow rules in Rethink.</p>
<details>
<summary> ‚úîÔ∏è Click to Expand `whois` Example Output </summary>
<pre><code class="language-bash">whois 151.101.129.140

#
# ARIN WHOIS data and services are subject to the Terms of Use
# available at: https://www.arin.net/resources/registry/whois/tou/
#
# If you see inaccuracies in the results, please report at
# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
#
# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.
#


NetRange:       151.101.0.0 - 151.101.255.255
CIDR:           151.101.0.0/16
NetName:        SKYCA-3
NetHandle:      NET-151-101-0-0-1
Parent:         RIPE-ERX-151 (NET-151-0-0-0-0)
NetType:        Direct Allocation
OriginAS:
Organization:   Fastly, Inc. (SKYCA-3)
RegDate:        2016-02-01
Updated:        2021-12-14
Ref:            https://rdap.arin.net/registry/ip/151.101.0.0


OrgName:        Fastly, Inc.
OrgId:          SKYCA-3
Address:        PO Box 78266
City:           San Francisco
StateProv:      CA
PostalCode:     94107
Country:        US
RegDate:        2011-09-16
Updated:        2025-03-25
Ref:            https://rdap.arin.net/registry/entity/SKYCA-3


OrgNOCHandle: FNO19-ARIN
OrgNOCName:   Fastly Network Operations
OrgNOCPhone:  +1-415-404-9374
OrgNOCEmail:  noc@fastly.com
OrgNOCRef:    https://rdap.arin.net/registry/entity/FNO19-ARIN

OrgTechHandle: FRA19-ARIN
OrgTechName:   Fastly RIR Administrator
OrgTechPhone:  +1-415-518-9103
OrgTechEmail:  rir-admin@fastly.com
OrgTechRef:    https://rdap.arin.net/registry/entity/FRA19-ARIN

OrgAbuseHandle: ABUSE4771-ARIN
OrgAbuseName:   Abuse Account
OrgAbusePhone:  +1-415-496-9353
OrgAbuseEmail:  abuse@fastly.com
OrgAbuseRef:    https://rdap.arin.net/registry/entity/ABUSE4771-ARIN


#
# ARIN WHOIS data and services are subject to the Terms of Use
# available at: https://www.arin.net/resources/registry/whois/tou/
#
# If you see inaccuracies in the results, please report at
# https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
#
# Copyright 1997-2025, American Registry for Internet Numbers, Ltd.
</code></pre>
<blockquote>
<p>‚ö†Ô∏è Use caution when setting trust rules for subnet ranges, as this grants
access to all services hosted within that range, potentially including
services unrelated to the one you intend to access. Best practice is to first
attempt to trust the specific domain name (e.g., reddit.com), which is
generally the most granular and secure method. Only consider trusting broader
subnet ranges (like 151.101.0.0/16) as a last resort if domain-based rules
fail to resolve connectivity issues for the intended service.</p>
</blockquote>
<p>We can see that:</p>
<ul>
<li>The subnet range for that IP: <code>151.101.0.0 - 151.101.255.255</code> (CIDR notation:
<code>151.101.0.0/16</code>)</li>
</ul>
<p>So as a starting point to get Reddit working we could trust the following subnet
range:</p>
<ul>
<li>
<p>IPv4: <code>151.101.0.0/16</code></p>
</li>
<li>
<p>This subnet covers the full range from <code>151.101.0.0</code> to <code>151.101.255.255</code>,
which includes all related IPs Reddit uses via Fastly‚Äôs CDN.</p>
</li>
<li>
<p>The owning organization: <code>Fastly, Inc.</code> &amp; More‚Ä¶</p>
</li>
</ul>
</details>
<hr />
<h3>Firefox Encrypted DNS through Rethink</h3>
<p>First, make sure you can visit a few sites in Firefox. If you can, then your
browser traffic should be routed through the Rethink tunnel, we will check here.
If you can‚Äôt, go to <code>Home -&gt; Apps</code> and search for Firefox, is networking
enabled?</p>
<p><strong>RethinkDNS Settings</strong></p>
<p>For the best experience routing your browser traffic through your custom
endpoint (e.g., DNSCrypt) on both Wi-Fi and mobile data ensure the following are
set:</p>
<ul>
<li>Do not turn on <code>Block any app not in use</code> in the Universal firewall. After
some Log digging, I found that this causes the browser to fail more often than
not.</li>
<li><code>Configure -&gt; Network -&gt; Enable network visibility</code> set to ON. I had
experimented with turning this off and certain websites wouldn‚Äôt load when on
Wi-Fi and none would load on mobile data. Turning it back on seemed to fix
both with no leaks detected.</li>
</ul>
<p>Double check that in Rethink‚Äôs <code>Configure -&gt; DNS -&gt; Prevent DNS leaks</code> is ON, as
well as the Universal Firewalls <code>Block when DNS is bypassed</code> ON.</p>
<hr />
<p><strong>Firefox Settings</strong></p>
<blockquote>
<p>In Firefox, plug <code>about:config</code> into the URL bar and scroll down to
<code>network.trr.mode</code> and change its value to <code>3</code> to prevent leaking DNS queries
to the System resolver. Also in <code>about:config</code> scroll down to
<code>media.peerconnection.enabled</code>, double-click to set it to false to prevent
WebRTC leaks.</p>
</blockquote>
<p>IronFox no longer lets you adjust the <code>network.trr.mode</code> in <code>about:config</code>, you
adjust the <code>trr.mode</code> through the DNS over HTTPS settings. Set it to
<code>Default Protection</code> or <code>OFF</code> and check for dns leaks. Fennec also has issues
with setting <code>network.trr.mode 3</code> and falls back to insecure methods. I would
suggest using the built in DNS over HTTPS for Fennec on max protection.</p>
<ul>
<li>The trade-off is that disabling WebRTC also disables any websites or apps
using WebRTC for real-time communication (like video calls or chat functions)
from working correctly.
<a href="https://en.wikipedia.org/wiki/WebRTC">Wikipedia WebRTC</a></li>
</ul>
<p>In Firefox <code>Settings -&gt; Privacy &amp; Security</code>, set <code>DNS over HTTPS</code> to
<code>Default Protection</code> or <code>OFF</code>, this enables Firefox to use RethinkDNS‚Äôs DNSCrypt
resolver or whatever you chose.</p>
<hr />
<p><strong>Checking for DNS Leaks</strong></p>
<p>Go to:</p>
<pre><code class="language-text">https://dnsleaktest.com
</code></pre>
<p>Also crosscheck with:</p>
<pre><code class="language-text">https://ipleak.net
</code></pre>
<p><code>ipleak.net</code> may show many more servers but as long as they are all related to
your resolver (i.e., WoodyNet for Quad9) you are not leaking to your ISP or
other third-parties.</p>
<p>For DNSCrypt with Quad9 Security, <code>dnsleaktest</code> found 5 servers all with the ISP
<code>WoodyNet</code> indicating success through Quad9. Quad9 relies on Packet Clearing
House, that‚Äôs where the <code>WoodyNet</code> name comes from.</p>
<p>When on mobile data, when going to <code>https://dnsleaktest.com</code> the results may
show more servers. As long as they are all the same ISP you‚Äôre good.</p>
<p>A different solution could be to experiment with more strict RethinkDNS settings
and just use the browsers built-in DNS over HTTPS on max protection. Having more
strict defaults for Rethink with all of your apps and configuring your browser
separate may be a better option, the choice is yours.</p>
<p>When hunting down a solution you can go to <code>Configure -&gt; Logs</code>, then try to
visit the site that wouldn‚Äôt work while watching the logs. You should see
<code>Firefox</code> pop up, click it, in the top right of the pop up should be the reason
it was blocked.</p>
<ul>
<li><a href="https://privacytests.org/">PrivacyTests.org</a>, tests different browsers in
different privacy categories.</li>
</ul>
<hr />
<h3><a href="#duckduckgo">DuckDuckGo</a></h3>
<p>I also tested DuckDuckGo with its stock configuration and <code>dnsleaktest.com</code>
showed that DDGs traffic was successfully tunneled through Rethink to Quad9s‚Äô
servers.</p>
<p><code>dnsleaktest.com</code> showed all <code>WoodyNet</code> ISPs indicating success.</p>
<hr />
<h4><a href="#chromium-based-browsers-brave">Chromium Based Browsers (Brave)</a></h4>
<p>For Brave, if you want your DNS routed through Rethink you have to turn
<code>Use secure DNS</code> off.</p>
<p>I also had to set Brave to <em>Bypass Universal</em></p>
<blockquote>
<p>NOTE: Brave has been known to have some spyware in the past, though most of it
can be opted out of.</p>
</blockquote>
<hr />
<h3><a href="#more-fine-grained-control--enhanced-privacy">More Fine Grained Control &amp; Enhanced Privacy</a></h3>
<p>In this section we will switch from a default allow to a default deny; blocking
network access to every app. We will then go through and only enable networking
for the apps that we need and trust.</p>
<details>
<summary> ‚úîÔ∏è Click to Expand Android Privacy Tips for the paranoid </summary>
<p>If you don‚Äôt like the idea of someone forcing you to unlock your phone so they
can sift through your data:</p>
<ul>
<li>
<p>It‚Äôs often recommended to <strong>not</strong> use biometrics as they can be forcibly be
taken from you while a password typically can‚Äôt.</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Cellebrite">Cellebrite</a> relies on your phone
being in AFU mode which is After first unlock.</p>
</li>
</ul>
<p><strong>BFU</strong>: Before First Unlock. This refers to the state right after a device
restarts. Since you haven‚Äôt entered your password yet, the system has not
unlocked the phone‚Äôs storage, so its contents remain encrypted.</p>
<p><strong>AFU</strong>: After First Unlock. In this state, the device has been unlocked at
least once since it was powered on, even if it is currently locked. The
encryption keys are loaded into RAM, making the device‚Äôs stored data more
accessible and increasing the potential attack surface compared to the BFU
state.</p>
<ul>
<li>
<p>Set the Auto optimization (Auto Restart) to the shortest amount of time
possible. When your phone first reboots it is in BFU mode which is Before
first unlock mode. Biometrics are usually disabled in this mode and the
encryption keys are <strong>not</strong> saved in RAM making the attack surface much
smaller.(i.e., they typically have to guess the password or brute-force it)</p>
<ul>
<li>That said, if someone gets your phone while it‚Äôs in AFU mode they will only
have the amount of time until your next auto reboot to try to extract your
data.</li>
</ul>
</li>
<li>
<p>You can also try to reduce the number of unlock attempts before the device
wipes. The default is typically 20 attempts, I haven‚Äôt found a way to lower
this.</p>
</li>
<li>
<p>You can‚Äôt really trust Airplane mode on anything but GrapheneOS. If you are
able to remove your battery, do that when it matters.</p>
</li>
<li>
<p>In your <code>About phone</code> section, name your device something that doesn‚Äôt expose
anything useful about yourself.</p>
</li>
<li>
<p>Set a pin for your phones sim card to prevent sim swaps.</p>
</li>
<li>
<p>Consider something like mint mobile or visible, they often let you register
with only a spoofed email address.</p>
</li>
</ul>
<p>Bluetooth is inherently insecure and broadcasts information about your device
constantly. Walmart and other stores have started using Bluetooth to see hot
zones to strategically place adds on the most traveled areas.</p>
<ul>
<li>
<p><a href="https://www.edgescan.com/bluetooth-and-the-invisible-security-threat-youre-probably-not-listening-to/">Bluetooth the invisible threat</a></p>
</li>
<li>
<p><a href="https://www.forbes.com/sites/alexvakulov/2025/02/20/11-types-of-bluetooth-attacks-and-how-to-protect-your-devices/">Types of bluetooth attacks</a></p>
</li>
<li>
<p>Turn off Wi-Fi, Bluetooth, Location, Nearby device scanning, etc. when not in
use or needed. Your weather app doesn‚Äôt need your location 24/7, find one that
lets you manually enter your location and time zone.</p>
</li>
<li>
<p>Use a password manager rather than using the one built into the browser, I
like BitWarden for sync and KeepassDX for self storage. Since you don‚Äôt have
to remember the passwords, have it generate long complex unique passwords for
each app.</p>
<ul>
<li>You can use KeepassDX to store a complex password for Bitwarden that is kept
100% offline so your synced passwords are better protected.</li>
</ul>
</li>
</ul>
<hr />
<p><strong>Google</strong></p>
<p>In <code>Settings -&gt; Google</code> in
<code>Google services -&gt; All services -&gt; Privacy &amp; security</code> Select <code>Ads</code> and either
Reset advertising ID every so often, or Delete advertising ID but know the
consequences of the latter.</p>
<p>In the same <code>All services</code> area, click <code>Usage &amp; diagnostics</code> to disable it.</p>
<p>Turn off <code>Improve Location Accuracy</code></p>
<p>Go to your accounts <code>Manage your Google Account</code>, <code>Data &amp; privacy</code> and disable
all the Activity tracking (Pause it or turn it off).</p>
<p>If you rely on Google services, in the <code>Data &amp; privacy</code> section, it is helpful
to run a <code>Privacy Checkup</code>.</p>
<p>When you‚Äôre done, always go to <code>Settings -&gt; Accounts and backup</code> and remove the
Google account.</p>
<p>I recommended that you <strong>remove Android System SafetyCore</strong>.</p>
<ul>
<li>
<p><a href="https://www.protectstar.com/en/blog/android-system-safetycore-hidden-installation-and-what-you-should-know">What is SafetyCore and why you should delete it</a></p>
</li>
<li>
<p><a href="https://www.kaspersky.com.au/blog/what-are-android-safetycore-and-key-verifier/34736/">Google forcing Android System SafetyCore on users to scan for nudes</a></p>
</li>
</ul>
<hr />
<p><strong>F-Droid</strong></p>
<p>F-Droid is a free and open-source app store for Android that only distributes
open-source software, without ads, proprietary code, or user tracking. All apps
are vetted for privacy and transparency, making it a strong alternative to
Google Play.</p>
<p>No registration or account is required, further protecting privacy.</p>
<p>Google restricts apps that remove Google services or modify their core features
to disable their data collection strategies. This is why you won‚Äôt find many
privacy by default browsers in Google Play. Browsers like IronFox and Cromite
are solid options that disable telemetry and more that are available outside of
the Play ecosystem.</p>
<p>I personally use IronFox as my default and have been happy with it so far. It
comes with uBlock installed by default which I recommend that you learn how to
get the most out of. With Firefox fingerprint protection, a few about:config
tweaks, and uBlock you can accomplish what used to take 6 extensions to do. See:
<a href="#ublock-origin">uBlock Origin</a></p>
<p>For more compartmentalization, Brave Browser now has an F-Droid repository that
can be added.</p>
<p>Open F-Droid, in Settings click Repositories, click +, and for the Brave
official repository add the following:</p>
<blockquote>
<p>NOTE: If you don‚Äôt want to add a repo, you can use the FFUpdater app to
install privacy friendly browsers including brave.</p>
</blockquote>
<pre><code class="language-text">https://brave-browser-apk-release.s3.brave.com/fdroid/repo
</code></pre>
<p>Or you can visit
<a href="https://brave-browser-apk-release.s3.brave.com/fdroid/repo/index.html">https://brave-browser-apk-release.s3.brave.com/fdroid/repo/index.html</a> and scan
the QR code.</p>
<p>Another app that I recently discovered on F-Droid is the
<a href="https://f-droid.org/en/packages/de.marmaro.krt.ffupdater/">FFUpdater</a> app. It
enables you to install and update different privacy friendly browsers as well as
updating FairEmail, K-9 Mail/Thunderbird, and Orbot in a privacy respecting way.</p>
<ul>
<li>
<p>FairEmail is great, it has many privacy features including support for
encryption,reformatting messages to prevent phishing, and more.</p>
</li>
<li>
<p>To install apps through FFUpdater tap the phone logo with the down arrow on
the top right of the screen.</p>
</li>
</ul>
<p>Aurora Store is an open-source client for Google Play that respects user privacy
and lets you download and update proprietary apps with an anonymous account. You
can use F-Droid for open-source apps and Aurora for proprietary apps.</p>
<p>I would recommend against Obtainium, the dev is a piece of shit and you can do
anything it can do easily without it. Discoverium is a fork run by someone else,
might be an option.</p>
<p>Another option I came across that I haven‚Äôt tried yet is
<a href="https://zapstore.dev/">Zapstore</a> It‚Äôs a decentralized, permissionless app store
that lets you support devs without PII.</p>
<ul>
<li><a href="https://www.eff.org/deeplinks/2019/01/stop-tracking-my-emails">EFF stop-tracking-my-emails</a></li>
</ul>
<hr />
<p><strong>Share Files and more anonymously</strong>:</p>
<ul>
<li><a href="https://onionshare.org/">OnionShare</a></li>
</ul>
<p><strong>Sharing Images</strong>:</p>
<ul>
<li>Clean metadata before sharing pics, I personally use
<a href="https://github.com/Crazy-Marvin/MetadataRemover">Metadata Remover</a></li>
</ul>
<hr />
<p><strong>SearXNG</strong></p>
<p>While we‚Äôre on the topic of browsers, it‚Äôs worth considering a privacy-focused
metasearch engine like SearXNG. SearXNG anonymizes your search queries and
removes any identifying data before passing them along to Google or other search
engines. This way, you can receive top-quality search results while keeping your
privacy intact</p>
<p>To get started find a few <a href="https://searx.space/">local instances</a> and
<a href="https://searx.neocities.org/nojs.html">others</a> and either bookmark them for
quick access or do what I do and add them to use as your default search engine.</p>
<p>In Firefox go to <code>about:preferences#search</code>, scroll to the bottom and click
<code>Add</code>. Name it whatever you want and for the URL add one of the local instances
followed by <code>search?q=%s</code> for example, for an instance in the US with A+
ratings:</p>
<pre><code class="language-text">https://searx.ankha.ac/search?q=%s
</code></pre>
<p>Then click <code>Add Engine</code>, and back near the top of the page you can set one
instance as your default search engine and another for private windows. I have
had a good experience so far using SearXNG with the occasional problem that is
solved by using a different instance.</p>
<blockquote>
<p>‚ùóÔ∏è Note: When using a public SearXNG instance from someone you don‚Äôt know, you
are trusting the operator since they can see the IP address making the
searches and might keep logs. The site https://searx.space/ provides helpful
details to choose instances based on trust and location. If you want the
highest level of privacy and full control, running your own instance is the
best option‚Äîthough it requires more setup. Using public instances is a great
way to get started and improve privacy compared to regular search engines.</p>
</blockquote>
<p><strong>Browser compartmentalization</strong> is a technique where you use multiple browsers
to separate different types of online activities. Instead of doing all browsing
in a single browser, you dedicate specific browsers to distinct tasks, for
example, one browser for email and banking, another for social media, and a
third for casual web surfing. This separation makes it difficult for websites
and trackers to link your activities across different contexts because cookies,
trackers, and browsing data are isolated within each browser.</p>
<ul>
<li>AI and social media Apps often require extensive permissions and deep access
to your device data and can run background processes that you can‚Äôt easily
monitor. If you avoid the apps and only access AI and social media in your
browser you get the benefits of browser sandboxing, tracking prevention,
cookie controls and more. You gain more benefits by using the
compartmentalization technique explained above, possibly one for AI and one
for social media.</li>
</ul>
<hr />
<p>The following website lists the tracking protection mechanisms implemented by
the major browsers and browser engines:</p>
<ul>
<li><a href="https://www.cookiestatus.com/">Cookie Status</a></li>
</ul>
<hr />
<details>
<summary> ‚úîÔ∏è Click to Expand uBlock Guide </summary>
<h2>uBlock Origin</h2>
<p>Arkenfox and Betterfox are JavaScript configuration files used to harden/control
Firefox settings on a computer.</p>
<p><a href="https://github.com/yokoffing/BetterFox?tab=readme-ov-file">BetterFox</a> does a
great job explaining how to use uBlock with solid recommendations.</p>
<ul>
<li><a href="https://github.com/yokoffing/filterlists?tab=readme-ov-file#guidelines">BetterFox uBlock filterlists</a></li>
</ul>
<p>If you wanted to apply the
<a href="https://github.com/yokoffing/filterlists/blob/main/privacy_essentials.txt">Privacy Essentials</a>
list you would click
<a href="https://subscribe.adblockplus.org/?location=https://raw.githubusercontent.com/yokoffing/filterlists/main/privacy_essentials.txt&amp;title=Privacy%20Essentials">subscribe</a>,
which launches the uBlock asset viewer where you can see all of the domains that
will be blocked before clicking <code>Subscribe</code> again to apply them.</p>
<h3>Adding other lists</h3>
<ul>
<li>
<p><a href="https://github.com/hagezi/dns-blocklists">Hagezi dns-blocklists</a></p>
</li>
<li>
<p><a href="https://github.com/ppfeufer/adguard-filter-list">adguard-filter-list</a></p>
</li>
</ul>
<p>Click the uBlock logo, Settings, Filter lists, scroll to the bottom and choose
Import‚Ä¶, Paste the url of your chosen list, and click Apply changes.</p>
<p>For example, <a href="https://github.com/arkenfox/user.js/">Arkenfox</a> suggests adding
the Actually Legitimate URL Shortener Tool. Add
<a href="https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt">https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt</a>
to the Import‚Ä¶ section and click Apply changes. If you scroll up, you‚Äôll see
that it was added and chosen.</p>
<p>Setup your <a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode">Blocking mode</a></p>
<p>Many opt for
<a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode:-medium-mode">medium mode</a>.
To do so you need to:</p>
<p><strong>Settings pane</strong>:</p>
<ul>
<li>Open the dashboard, and choose I am an advanced user.</li>
</ul>
<p><strong>Filter lists pane</strong>:</p>
<ul>
<li>
<p>All of uBO‚Äôs filter lists: checked</p>
</li>
<li>
<p>EasyList: checked</p>
</li>
<li>
<p>Peter Lowe‚Äôs Ad server list: checked</p>
</li>
<li>
<p>EasyPrivacy: checked</p>
</li>
<li>
<p>Online Malicious URL Blocklist: checked</p>
</li>
</ul>
<p><strong>My rules pane (4th pane from the left)</strong>:</p>
<p>Underneath Temporary rules add, you literally type this in:</p>
<ul>
<li>
<p>Add <code>* * 3p-script block</code></p>
</li>
<li>
<p>Add <code>* * 3p-frame block</code></p>
</li>
<li>
<p>Click <code>Save</code></p>
</li>
<li>
<p>Click <code>&lt;- Commit</code> (Not required on phone)</p>
</li>
<li>
<p>Setting medium mode on your phone is likely overkill because it‚Äôs not super
quick to switch broken sites to easy mode as it is on a computer.</p>
</li>
</ul>
<p><strong>Fallback to
<a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode:-easy-mode">easy mode</a></strong></p>
<p>Click the uBlock logo while on the site you want to use easy mode on. You‚Äôll see
the power button to the top right, the Global rules and the Local rules which
start 3 boxes from the left. Click the box under the Local rules for 3rd-party
scripts. The box will change colors, dark gray = NOOP (No Operation). This tells
uBO to ignore the aggressive global block for this site, and let the normal
filter lists handle the blocking.</p>
<p>Click the padlock to make the rules NOOP rules permanent.</p>
<p>You can also disable JavaScript in Settings as needed replacing the need for
NoScript.</p>
</details>
<ul>
<li>
<p><a href="https://github.com/gorhill/uBlock/wiki">uBlock Wiki</a></p>
</li>
<li>
<p><a href="https://arstechnica.com/gadgets/2025/09/f-droid-calls-for-regulators-to-stop-googles-crackdown-on-sideloading/">Ars Technica F-Droid &amp; sideloading restrictions</a></p>
</li>
<li>
<p><a href="https://f-droid.org/en/2025/09/29/google-developer-registration-decree.html">F-Droid and Google‚Äôs Developer Registration Decree</a></p>
</li>
</ul>
</details>
<hr />
<h2>Default Deny</h2>
<p>If you read the following GrapheneOS discussion forum written by an RDNS dev:</p>
<ul>
<li><a href="https://discuss.grapheneos.org/d/12728-proton-apps-pinging-google-api-sending-reports-back-after-opting-out/54">GrapheneOS Discussion Forum on Rethink</a></li>
</ul>
<p>The post suggests you go to <code>Home -&gt; Apps</code> and right under <code>Showing all apps</code>
click on the grayed out üõúüì∂ to set a rule to <strong>block both Metered and Unmetered
connections to all apps by default</strong>. This will block both Wi-Fi and mobile data
connections to <strong>all apps</strong> on your device.</p>
<p>The point here is that not every App on your device needs network access all the
time or at all in some cases.</p>
<p>Search for the apps you use/trust and:</p>
<ul>
<li>
<p>start by enabling Wi-Fi üõú and mobile-data üì∂ as well as Bypass Universal so
your required apps aren‚Äôt blocked right when the screen shuts off or affected
by the firewall.</p>
</li>
<li>
<p>Next, check your logs and see why it‚Äôs being blocked. Look at the domains
involved and set trust rules for said domains. If it is unclear why networking
still isn‚Äôt working, you can:</p>
</li>
<li>
<p>If you‚Äôre using Rethink‚Äôs DNS, you can try allowing the app to
<code>Bypass DNS &amp; Firewall</code>. Try the app again, does it work? If not:</p>
</li>
<li>
<p>You can also <code>Isolate</code> an App, you then have to set up <em>trust | allow</em> rules
for domains or IPs over a period of time which can take a while.</p>
</li>
<li>
<p><code>Exclude</code> the app. This makes RethinkDNS completely unaware of the app and is
often what is required for Reddit. It is my understanding that after you
<code>Exclude</code> an App, your systems Automatic Secure DNS will pick it up.</p>
</li>
</ul>
<p>A few apps that typically need network access on Android:</p>
<ul>
<li>
<p>Google Play services (<code>com.google.android.gms</code>): push notifications, safety
checks, etc.</p>
</li>
<li>
<p>Google Play Store (<code>com.android.vending</code>) app updates and downloads</p>
</li>
<li>
<p>Android System (usually UID 1000, often <code>android</code> or <code>system</code>): Core OS
connectivity checks, NTP time sync, and network management. Blocking can cause
‚Äúno internet‚Äù errors.</p>
</li>
<li>
<p>Android System WebView (<code>com.google.android.webview</code>): Renders web contents in
apps.</p>
</li>
<li>
<p>Download Manager (<code>com.android.providers.downloads</code>): Manages file downloads
from apps/browser. Without it, downloads stall.</p>
</li>
<li>
<p>Media Storage</p>
</li>
<li>
<p>Settings</p>
</li>
</ul>
<hr />
<h3><a href="#tor">Tor</a></h3>
<p>Tor itself is a network and software that anonymizes traffic by encrypting it
and bouncing it though a series of volunteer-operated relays around the world
before reaching the destination. Orbot uses this Tor network to encrypt and
anonymize internet traffic for Android apps.</p>
<p>Orbot routes app traffic through Tor but doesn‚Äôt provide the same kind of
traffic isolation and sandboxing that Tor browser offers on desktop. Be aware of
the limitations and use Tor Browser on a hardened system or specialized software
such as Tails or Whonix when anonymity truly matters.</p>
<p>If you want to learn how Tor works, I suggest reading the following in this
order:</p>
<ol>
<li>
<p><a href="https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/">PrivacyGuides In Praise of Tor</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/advanced/tor-overview/">PrivacyGuides Tor Overview</a></p>
</li>
<li>
<p><a href="https://ssd.eff.org/module/how-to-use-tor">EFF How to: Use Tor</a></p>
</li>
</ol>
<p><strong>Tor is at risk, and needs our help</strong>. Despite its strength and history, Tor
isn‚Äôt safe from the same attacks oppressive regimes and misinformed legislators
direct at encryption and many other privacy-enhancing
technologies.‚Äì<a href="https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/#how-to-support-tor">How to Support Tor</a></p>
<details>
<summary>
‚úîÔ∏è Click to Expand Tor Section
</summary>
<blockquote>
<p>‚ùóÔ∏è WARNING: Tor gets much of its funding from the US government and is not
immune to vulnerabilities or misconfigurations.Tor Browser is <strong>not</strong> the most
secure browser, anonymity and security can often be at odds with each other.
Having the exact same browser as many other people isn‚Äôt the best security
practice, but it is great for anonymity. Tor is also based on Firefox Esr,
which only receives patches for vulnerabilities considered Critical or High
which can be taken advantage of.</p>
</blockquote>
<p>Tor Project has also done some sketchy/questionable things lately such as
removing user agent spoofing which made every user appear as if they were using
the same version of Windows. This decision reduces anonymity and is questionable
at best, seems to me there ought to be a very good reason for doing this which I
can‚Äôt find. Tor is still one of the best anonymity solutions, just stay informed
and cautious.</p>
<p>The following is a summary of some of the Tor Overview, all credit goes to them.
It is important to spread the word when you can!</p>
<p>If you are fortunate to live outside of oppressive regimes with extreme
censorship, using Tor for every day, mundane activities is likely safe and won‚Äôt
put you on any harmful ‚Äúlist.‚Äù Even if it did, you‚Äôd be in good company, these
lists mostly contain great people working tirelessly to defend human rights and
online privacy worldwide.</p>
<p>By using Tor regularly for ordinary browsing, you help strengthen the network,
making it more robust and anonymous for everyone. This collective support makes
staying private easier for activists, journalists, and anyone facing online
surveillance or censorship. The writer of the PrivacyGuides article mentions
using Tor when he needs to access Google Maps to protect his privacy</p>
<p>So, consider embracing Tor not only for sensitive browsing but also for daily
routine tasks. Every user adds valuable noise to the network, helping protect
privacy and freedom for all.</p>
</details>
<hr />
<h3><a href="#setting-up-orbot-with-a-tcp-only-proxy">Setting up Orbot with a TCP-only Proxy</a></h3>
<p><img src="../images/orbot.png" alt="Orbot Logo" /></p>
<ul>
<li>Helpful guide, <a href="https://thecyberexpress.com/what-is-orbot/">What is Orbot?</a></li>
</ul>
<p>TCP-Only Proxies forward all TCP-level connections from selected apps to Orbot.</p>
<p>TCP-Only Proxies work best for Apps that use multiple TCP protocols beyond just
basic web browsing (HTTP/HTTPS) like messaging apps (Signal), search apps (DDG),
etc. Because it proxies all TCP traffic, it can cause some apps to slow down or
break if they expect direct DNS or UDP.</p>
<p>First install Orbot, Open <code>Orbot -&gt; More -&gt; Orbot Settings</code> and turn on
<code>Power User Mode</code>. <strong>This is important</strong>, if you forget this Rethinks auto Orbot
will not let you choose between SOCKS and HTTP proxies.</p>
<p>You should also check <code>Allow Background Starts</code> ON.</p>
<p>In <code>Configure -&gt; Proxy -&gt; Setup Orbot</code>:</p>
<ul>
<li>
<p>Click <code>Add / Remove 0 apps</code>, search for an app that you want to run through
Orbot. For simple testing I chose DuckDuckGo with a TCP-only Proxy.</p>
</li>
<li>
<p>In <code>Home -&gt; Apps</code> search for <code>Orbot</code> and set <code>Orbot -&gt; Bypass Universal</code> ON</p>
</li>
<li>
<p>On the first time starting Orbot through Rethink, you‚Äôll have to click the
<code>Configure -&gt; Proxy -&gt; Setup Orbot -&gt; Orbot&gt;</code> to <code>Connect</code> as well as grant
initial permissions. After you start Orbot successfully, check out Rethinks
<code>Home</code> and below the STOP button should say <code>Protected With Tor</code>.</p>
</li>
</ul>
<p>Open DuckDuckGo and go to:</p>
<pre><code class="language-text">https://dnsleaktest.com
# CrossCheck
https://ipcheck.net
</code></pre>
<blockquote>
<p>‚ùó You may see that ipleaktest initially shows a Tor exit relay location such
as the Netherlands, once you complete a Standard Test, it still shows WoodyNet
ISPs. Since I configured Rethink to use DNSCrypt with Quad9 this is completely
expected. This confirms that my DNS traffic is not leaking to my ISP and is
properly anonymized through Tor and Quad9. As long as you don‚Äôt see your
actual ISP‚Äôs servers in the results, your setup is working as intended.</p>
</blockquote>
<p>Now you can add more apps that would benefit from anonymity such as FairEmail,
RSS feeds, and crypto wallets. I believe for Signal, it requires that you to set
up the SOCKS5 proxy to work correctly which is pretty straightforward.</p>
<p>Look into an RSS Feed, they give you complete control of the content you
consume, no algorithm involved!</p>
<p>This can also be useful on public Wi-Fi or other insecure networks.</p>
<ul>
<li>
<p>You can also open Orbot and <code>Choose How to Connect</code>, if you want to hide Tor
use.</p>
</li>
<li>
<p>If you live in an area where Tor use isn‚Äôt discriminated against, consider
Activating your Orbot <code>Kindness</code> tab so others that are in oppressive regimes
can use your device as a bridge. This is a great way to give back!</p>
</li>
</ul>
<hr />
<h2><a href="#setting-up-a-socks5-proxy">Setting up a SOCKS5 Proxy</a></h2>
<p>If you have Orbot set up through auto mode, you‚Äôll have to disable it.</p>
<p>Open <code>Orbot -&gt; More</code>: Near the bottom of the screen you‚Äôll see <code>HTTP: 8118</code>, and
<code>SOCKS: 9050</code>, these are the Port numbers. We will compare these to Rethinks
defaults. (They match).</p>
<p>Back in Rethink, <code>Configure -&gt; Proxy -&gt; Setup SOCKS5 Proxy</code>.</p>
<p>In the App dropdown choose <code>Orbot</code>.</p>
<ul>
<li>
<p>Hostname: <code>127.0.0.1</code></p>
</li>
<li>
<p>Port Number: <code>9050</code></p>
</li>
<li>
<p>Leave the rest of the defaults and Hit <code>Set</code></p>
</li>
<li>
<p>Go <code>Home</code>, below the STOP button you should see <code>Protected With SOCKS Proxy</code>.
Now all of your devices traffic that doesn‚Äôt bypass Rethink is routed through
the SOCKS5 proxy.</p>
</li>
<li>
<p>In <code>Configure -&gt; DNS</code> and turn <code>Never proxy DNS</code> ON</p>
</li>
<li>
<p>Open your browser and visit <code>https://dnsleaktest.com</code>, your public IP should
no longer be your ISPs.</p>
</li>
<li>
<p>SOCKS5 alone doesn‚Äôt encrypt the traffic; it only proxies or routes it. Orbot
uses SOCKS5 to let apps route traffic into the Tor network. Once inside the
Tor network, the traffic is encrypted in layers.</p>
</li>
<li>
<p>There is a misconception that Orbot is a ‚Äúfree VPN‚Äù. It‚Äôs actually part of an
anonymity network designed to hide your identity by sending your traffic
through multiple servers. And the SOCKS5 proxy that Orbot uses isn‚Äôt a VPN
either, it simply directs certain app traffic through a proxy server without
creating a full encrypted tunnel from your device like a VPN does.</p>
</li>
</ul>
<hr />
<h2>WireGuard/VPN</h2>
<p>Keep your goals in mind before paying for a VPN, some allow you to pay with cash
anonymously such as Mullvad VPN and a few others. Remember that you are
transferring trust, from your ISP to the VPN provider.</p>
<p><code>Configure -&gt; Proxy -&gt; Setup WireGuard -&gt; +</code>:</p>
<p>With the WireGuard protocol, the provider usually gives you either a QR Code, or
a configuration file (e.g., <code>.conf</code> file) which is a plaintext file that
contains what is needed. You download that file and Click <code>IMPORT</code> which brings
up your phones filesystem.</p>
<p>Alternatively, the <code>CREATE</code> option for advanced users who are setting up their
own WireGuard network, typically if you host your own VPN server.</p>
<p>After this is setup you should always verify that your traffic is encrypted
(hidden IP) and your DNS queries are protected (no leaks).</p>
<p>You could:</p>
<ol>
<li>
<p>First check what your IP address is before enabling WireGuard at
<code>whatismyipaddress.com</code> or <code>ipleak.net</code>, take note of your Public IP, ISP,
and City/Country this is your real info that the VPN needs to hide.</p>
</li>
<li>
<p>Connect to your Wireguard/VPN server. Choose the server location you want and
go back to check again.</p>
</li>
<li>
<p>Check for leaks, go to <code>dnsleaktest.com</code> and run a Standard test. If you
don‚Äôt see your Public IP listed anywhere, you don‚Äôt have a leak.</p>
</li>
</ol>
<p><strong>Fixing DNS Leaks</strong>:</p>
<ul>
<li>
<p>Use WireGuard in Simple mode.</p>
</li>
<li>
<p>Or, use <code>Configure -&gt; DNS -&gt; Split DNS</code> with WireGuard in
<code>Advanved + Lockdown</code> mode (if running on Android 12+)</p>
</li>
</ul>
<p>To ensure your DNS requests go through your VPN, check
<code>Configure -&gt; Logs -&gt; DNS</code>. Tap on the entries that appear there, which should
bring up a bottomsheet with more info about the request and how it was handled.
Requests handled by WireGuard are shown with sub-text ‚Äúresolved x min ago by
wg‚Ä¶‚Äù ‚Äìcelzero</p>
<hr />
<p><strong>Proton VPN</strong></p>
<p>This works for ProtonVPN Free as well.</p>
<p>Written by celzero
<a href="https://www.reddit.com/r/rethinkdns/comments/163e83l/proton_vpn/">Here</a></p>
<ol>
<li>
<p>On your Android, visit https://account.protonvpn.com/downloads</p>
</li>
<li>
<p>Scroll to WireGuard</p>
</li>
</ol>
<ul>
<li>
<p>Give it a name</p>
</li>
<li>
<p>Select Android</p>
</li>
<li>
<p>Enable VPN options as needed.</p>
</li>
<li>
<p>Press Create or tap on Download.</p>
</li>
</ul>
<ol start="3">
<li>Open Rethink, goto Configure -&gt; Proxy -&gt; Setup WireGuard</li>
</ol>
<ul>
<li>
<p>Tap on the ‚Äú+‚Äù button</p>
</li>
<li>
<p>Choose Import</p>
</li>
<li>
<p>Select the downloaded configuration file</p>
</li>
</ul>
<ol start="4">
<li>
<p>If the import is successful, you should see a new profile prefixed wg added
to the list.</p>
</li>
<li>
<p>Tap on that <code>wg</code> entry.</p>
</li>
</ol>
<ul>
<li>
<p>In the new screen that opens up, tap on Add / Remove applications.</p>
</li>
<li>
<p>Select apps that should be part of this particular WireGuard profile.</p>
</li>
<li>
<p>Go back.</p>
</li>
</ul>
<ol start="6">
<li>Enable / disable that wg profile as desirable.</li>
</ol>
<ul>
<li>On my phone, when I saved the VPN profile, it automatically added <code>.txt</code> to
the end of the file causing the import to fail. I was able to open my phones
documents and long hold the file to rename it, afterwards I was able import
it.</li>
</ul>
<hr />
<p><strong>SIMPLE</strong></p>
<p>When you enable: <code>Configure -&gt; Proxy -&gt; Setup WireGuard - SIMPLE</code></p>
<p>All connections from all apps, including DNS, will be routed to a single, active
WireGuard VPN. Other active WireGuard VPNs, if any, will be stopped.</p>
<p>If you tap SIMPLE, you can see the name of your VPN, check your Logs, and see
your Peer connection.(your device that participates in the VPN network)</p>
<hr />
<p><strong>ADVANCED</strong></p>
<p>Same as above but tap <code>ADVANCED</code> before enabling the toggle. This lets you
choose which apps will be routed through the VPN while the rest are routed as
usual.</p>
<p>This Mode also lets you enable:</p>
<ul>
<li>
<p><strong>Lockdown</strong>: Selected apps will only be routed through this WireGuard VPN,
regardless of whether the VPN is active or disabled.</p>
</li>
<li>
<p><strong>Always-on</strong>: All connections and apps not routed by other WireGuard VPNs
will be routed by this one.</p>
</li>
<li>
<p><strong>Mobile only</strong>: Use this WireGuard exclusively over mobile data.</p>
</li>
</ul>
<p>After you configure your Advanced settings as needed, enable the toggle.</p>
<p>Always make sure to watch your Logs as well as test with something like
&lt;dnsleaktest.com&gt;, you shouldn‚Äôt see your actual Public IP anywhere. It‚Äôs
advisable to check for WebRTC Leaks as well if you have that enabled.</p>
<p><strong>Troubleshooting VPN issues</strong></p>
<p>There are a few Proxy settings in <code>Configure -&gt; Network -&gt; PROXY</code>, where you
can:</p>
<ul>
<li>
<p>Enable <code>Do not randomize WireGuard listen port</code>: Keep WireGuard listen ports
fixed (no randomization) in Advanced mode.</p>
</li>
<li>
<p>Enable <code>Endpoint-Independent mapping</code>: When enabled, UDP sockets maintain a
fixed address and port for all destinations.</p>
</li>
</ul>
<p><strong>Check your Logs</strong></p>
<p>In <code>Configure -&gt; Proxy -&gt; Setup WireGuard</code>, click on your VPN which will give
you access to the <code>LOGS</code>.</p>
<p>Click the top entry, it will bring up the IP address and domain and show your
rules the app. You can click the dropdown menu‚Äôs to set new Universal Firewall
rules, as well as block/trust rules for IPs and domains.</p>
<hr />
<h3><a href="#logs">Logs</a></h3>
<p>On-device logging is on by default. You can find it in <code>Configure -&gt; Settings</code>.
From there, you can set the log level and choose a notification action.</p>
<p>If anyone else uses your phone, it‚Äôs probably a good idea to enable app lock.</p>
<p>Go to <code>Configure -&gt; Logs</code>, and try to access the app that‚Äôs not working. You
should see said app at the top of the Network Logs, click it. In the top right
of the tab, you‚Äôll see the reason why it‚Äôs not working such as: <code>App Blocked</code>,
or <code>DNS Bypass</code>.</p>
<p>This <code>DNS Bypass</code> means that the App in question is trying to bypass the Rethink
Tunnel and being actively blocked. You can search for said app and try setting
IP or Port Trust rules.</p>
<p>You can also go to <code>Home -&gt; Apps</code> and search for the App you need, click on it
and at the bottom of the screen you will see <code>IP Logs</code>, and <code>Domain Logs</code>.</p>
<p>Once you click on the log of the app in question, you‚Äôll be given 3 drop down
options. If you set an app to Bypass DNS and Firewall settings, you will see
that in the first dropdown box.</p>
<p>The next drop down is <code>Block,trust this IP for this app</code> where you can set a
rule to <code>Block</code> or <code>Trust</code>.</p>
<hr />
<h3><a href="#resources">Resources</a></h3>
<details>
<summary>
‚úîÔ∏è Click to Expand Resources
</summary>
<p>Things change frequently in the privacy/security relm, many sites provide an RSS
feed that automatically updates when they post new content. I‚Äôve listed a few
feeds that are good to follow IMO.</p>
<p><strong>RSS</strong> (Really Simple Syndication) is a technology that delivers automatic
updates from your favorite websites, blogs, or podcasts in a standardized
format. It saves you time by eliminating the need to manually check for new
content. Best of all, your feed includes only what you choose‚Äîno algorithms
deciding what you see.</p>
<p>I personally use <a href="https://feeder.co/">Feeder</a> as my RSS reader, it‚Äôs open-source
and has been great IMO.</p>
<ul>
<li><a href="https://www.privacytools.io/privacy-rss-feed-readers">PrivacyTools privacy-rss-feed-readers</a></li>
</ul>
<p><strong>RSS Feeds</strong>:</p>
<p>With Feeder, you click the 3 dots in the top right and click + Add feed, you can
then type the regular address of a site &amp; if it has RSS feeds, Feeder will list
them. Most sites that have an RSS feed will have an orange RSS button that you
can click on to get the address.</p>
<ul>
<li>
<p>PrivacyTools: <a href="https://www.privacytools.io/guides/rss.xml">https://www.privacytools.io/guides/rss.xml</a></p>
</li>
<li>
<p>Darknet Diaries: <a href="https://podcast.darknetdiaries.com/">https://podcast.darknetdiaries.com/</a></p>
</li>
<li>
<p>Hacker News: <a href="https://news.ycombinator.com/rss">https://news.ycombinator.com/rss</a></p>
</li>
<li>
<p>PrivacyGuides: <a href="https://privacyguides.org/rss/">https://privacyguides.org/rss/</a></p>
</li>
<li>
<p>Tor Project blog: <a href="https://blog.torproject.org/feed.xml">https://blog.torproject.org/feed.xml</a></p>
</li>
<li>
<p>Mozilla Security Blog: <a href="https://blog.mozilla.org/security/feed/">https://blog.mozilla.org/security/feed/</a></p>
</li>
<li>
<p>MDN Blog: <a href="https://developer.mozilla.org/en-US/blog/rss.xml">https://developer.mozilla.org/en-US/blog/rss.xml</a></p>
</li>
<li>
<p>F-Droid Forum - Latest posts: <a href="https://forum.f-droid.org/posts.rss">https://forum.f-droid.org/posts.rss</a></p>
</li>
<li>
<p>Opensource.com: <a href="https://opensource.com/feed">https://opensource.com/feed</a></p>
</li>
<li>
<p>DuckDuckGo Blog: <a href="https://spreadprivacy.com/rss/">https://spreadprivacy.com/rss/</a></p>
</li>
<li>
<p>Electronic Frontier Foundation Deeplinks Blog:
<a href="https://www.eff.org/rss/updates.xml">https://www.eff.org/rss/updates.xml</a></p>
</li>
<li>
<p>KrebsonSecurity: <a href="https://krebsonsecurity.com/feed/">https://krebsonsecurity.com/feed/</a></p>
</li>
<li>
<p>Arkenfox recent commits:
<a href="https://github.com/arkenfox/user.js/commits/master.atom">https://github.com/arkenfox/user.js/commits/master.atom</a></p>
</li>
<li>
<p>Arkenfox release notes: <a href="https://github.com/arkenfox/user.js/releases.atom">https://github.com/arkenfox/user.js/releases.atom</a></p>
</li>
<li>
<p>Brave Blog: <a href="https://brave.com/blog/index.xml">https://brave.com/blog/index.xml</a></p>
</li>
<li>
<p>Ars Technica: <a href="https://feeds.arstechnica.com/arstechnica/index/">https://feeds.arstechnica.com/arstechnica/index/</a></p>
</li>
<li>
<p>PrivacySavvy: <a href="https://privacysavvy.com/feed/">https://privacysavvy.com/feed/</a></p>
<ul>
<li>PrivacySavvy Security Archive: <a href="https://privacysavvy.com/security/feed/">https://privacysavvy.com/security/feed/</a></li>
</ul>
</li>
</ul>
<hr />
<ul>
<li>
<p><a href="https://research.cloudflare.com/projects/network-privacy/odns/">Oblivious DNS over HTTPS</a></p>
</li>
<li>
<p><a href="https://www.ietf.org/archive/id/draft-denis-dprive-dnscrypt-06.html">DNSCrypt Protocol</a></p>
</li>
<li>
<p><a href="https://www.privacytools.io/">PrivacyTools.io</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/articles/2025/04/30/in-praise-of-tor/">PrivacyGuides In Praise of Tor</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/advanced/tor-overview/">PrivacyGuides Tor Overview</a></p>
</li>
<li>
<p><a href="https://orbot.app/en/">Orbot app</a></p>
</li>
<li>
<p>Orbot is a free app from the Guardian Project that empowers other apps on your
device to use the internet more securely. Orbot uses Tor to encrypt your
internet traffic and hide it by bouncing through a seris of computers around
the world.
‚Äì<a href="https://support.torproject.org/glossary/orbot/">TorProject Orbot</a></p>
</li>
<li>
<p><a href="https://guardianproject.info/apps/org.torproject.android/">Guardian Project Orbot</a></p>
</li>
<li>
<p>WireGuard is an extremely simple yet fast and modern VPN that utilizes
state-of-the-art cryptography. ‚Äì<a href="https://www.wireguard.com/">Wireguard.com</a></p>
</li>
<li>
<p><a href="https://ssd.eff.org/">EFF Surveillance Self Defense</a></p>
</li>
<li>
<p><a href="https://coveryourtracks.eff.org/">EFF Cover Your Tracks</a></p>
</li>
<li>
<p><a href="https://amiunique.org/">AmIUnique?</a></p>
</li>
<li>
<p><a href="https://noscript.net/">What is NoScript?</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/dns/">PrivacyGuides DNS Recommendations</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-a-dns-server/">What is a DNS Server?</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-anycast-dns/">What is Anycast</a></p>
</li>
<li>
<p><a href="https://dn.org/anycast-dns-vs-unicast-dns-a-comparative-guide/">anycast-dns-vs-unicast-dns</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/">What is UDP?</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Transport_Layer_Security">MDN TLS</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/ssl/transport-layer-security-tls/">What is TLS</a></p>
</li>
<li>
<p><a href="https://network-guides.com/tcp-ip-basics/">Networking-Guides TCP/IP Basics</a></p>
</li>
<li>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-recursive-dns/">Cloudflare What is recursive DNS?</a></p>
</li>
<li>
<p><a href="https://github.com/evilsocket/opensnitch">OpenSnitch</a></p>
</li>
<li>
<p><a href="https://github.com/pi-hole/pi-hole">pi-hole</a></p>
</li>
<li>
<p><a href="https://spyware.neocities.org/">Sypware Watchdog</a></p>
</li>
</ul>
</details>
]]></description><author>saylesss88</author><guid>https://saylesss88.github.io/privacy-book/android/RethinkDNS_Guide.html</guid><pubDate>Sun, 7 Dec 2025 00:00:00 +0000</pubDate></item><item><title>Encrypted DNS on Arch</title><link>https://saylesss88.github.io/privacy-book/arch/enc_dns.html</link><description><![CDATA[<h1>Encrypted DNS ArchLinux with dnscrypt-proxy &amp; dnsmasq</h1>
<details>
<summary> ‚úîÔ∏è Click to Expand Table of Contents</summary>
<!-- toc -->
</details>
<blockquote>
<p>‚ùó NOTE: There are many other ways for someone monitoring your traffic to see
what domain you looked up via DNS that it‚Äôs effectiveness is questionable
without also using Tor or a VPN. Encrypted DNS will not help you hide any of
your browsing activity.</p>
</blockquote>
<pre><code class="language-bash">sudo pacman -S dnscrypt-proxy
</code></pre>
<blockquote>
<p>NOTE: udp is required for dnscrypt protocol, keep this in mind when
configuring your servers if your output chain is a default drop.</p>
</blockquote>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/Dnscrypt-proxy">Arch Wiki dnscrypt-proxy</a></p>
</li>
<li>
<p><a href="https://github.com/DNSCrypt/dnscrypt-proxy/wiki/Configuration">dnscrypt-proxy Wiki</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/Domain_name_resolution#Privacy_and_security">DNS Privacy and Security</a></p>
</li>
</ul>
<p>Edit <code>/etc/dnscrypt-proxy/dnscrypt-proxy.toml</code> to add your chosen resolvers etc.</p>
<p>For example, to setup ODoH you could do the following:</p>
<details>
<summary>
<p>‚úîÔ∏è Click to Expand example <code>dnscrypt-proxy.toml</code> that is set up with dnsmasq as
the local resolver.</p>
</summary>
<blockquote>
<p>‚ùóÔ∏è This isn‚Äôt the whole file, only the parts that were changed.</p>
</blockquote>
<pre><code class="language-toml"># DNSCRYPT servers to be forwarded to anon-relays
# server_names = ['quad9-dnscrypt-ip6-nofilter-pri', 'quad9-dnscrypt-ip4-nofilter-pri', 'quad9-dnscrypt-ip6-nofilter-ecs-pri' ]
# ODoH servers to be forwarded to odoh-relays
server_names = [ 'odoh-cloudflare', 'odoh-snowstorm' ]

listen_addresses = ['127.0.0.1:53', '[::1]:53']

max_clients = 250

# Use servers reachable over IPv4
ipv4_servers = true

# Use servers reachable over IPv6 -- Do not enable if you don't have IPv6 connectivity
ipv6_servers = true

# Use servers implementing the DNSCrypt protocol
dnscrypt_servers = true

# Use servers implementing the DNS-over-HTTPS protocol
doh_servers = false

# Use servers implementing the Oblivious DoH protocol
odoh_servers = true

## Require servers defined by remote sources to satisfy specific properties

# Server must support DNS security extensions (DNSSEC)
require_dnssec = true

# Server must not log user queries (declarative)
require_nolog = true

# Server must not enforce its own blocklist (for parental control, ads blocking...)
require_nofilter = true

bootstrap_resolvers = ['9.9.9.11:53', '1.1.1.1:53']

fallback_resolvers = ['1.0.0.1:53', '9.9.9.9:53']

ignore_system_dns = true


[sources]

### An example of a remote source from https://github.com/DNSCrypt/dnscrypt-resolvers

# These are just lists of resolvers to choose from

[sources.public-resolvers]
urls = [
  'https://raw.githubusercontent.com/DNSCrypt/dnscrypt-resolvers/master/v3/public-resolvers.md',
  'https://download.dnscrypt.info/resolvers-list/v3/public-resolvers.md',
]
cache_file = '/var/cache/dnscrypt-proxy/public-resolvers.md'
minisign_key = 'RWQf6LRCGA9i53mlYecO4IzT51TGPpvWucNSCh1CBM0QTaLn73Y7GFO3'
refresh_delay = 73
prefix = ''

### Anonymized DNS relays

[sources.relays]
urls = [
  'https://raw.githubusercontent.com/DNSCrypt/dnscrypt-resolvers/master/v3/relays.md',
  'https://download.dnscrypt.info/resolvers-list/v3/relays.md',
]
cache_file = '/var/cache/dnscrypt-proxy/relays.md'
minisign_key = 'RWQf6LRCGA9i53mlYecO4IzT51TGPpvWucNSCh1CBM0QTaLn73Y7GFO3'
refresh_delay = 73
prefix = ''

### ODoH (Oblivious DoH) servers and relays

[sources.odoh-servers]
  urls = ['https://raw.githubusercontent.com/DNSCrypt/dnscrypt-resolvers/master/v3/odoh-servers.md', 'https://download.dnscrypt.info/resolvers-list/v3/odoh-servers.md']
  cache_file = '/var/cache/dnscrypt-proxy/odoh-servers.md'
  minisign_key = 'RWQf6LRCGA9i53mlYecO4IzT51TGPpvWucNSCh1CBM0QTaLn73Y7GFO3'
  refresh_delay = 73
  prefix = ''
[sources.odoh-relays]
  urls = ['https://raw.githubusercontent.com/DNSCrypt/dnscrypt-resolvers/master/v3/odoh-relays.md', 'https://download.dnscrypt.info/resolvers-list/v3/odoh-relays.md']
  cache_file = '/var/cache/dnscrypt-proxy/odoh-relays.md'
  minisign_key = 'RWQf6LRCGA9i53mlYecO4IzT51TGPpvWucNSCh1CBM0QTaLn73Y7GFO3'
  refresh_delay = 73
  prefix = ''

### Quad9

[sources.quad9-resolvers]
  urls = ['https://quad9.net/dnscrypt/quad9-resolvers.md', 'https://raw.githubusercontent.com/Quad9DNS/dnscrypt-settings/main/dnscrypt/quad9-resolvers.md']
  minisign_key = 'RWTp2E4t64BrL651lEiDLNon+DqzPG4jhZ97pfdNkcq1VDdocLKvl5FW'
  cache_file = '/var/cache/dnscrypt-proxy/quad9-resolvers.md'
  prefix = 'quad9-'

[anonymized_dns]

# ODoH Server/ODoH Relay settings
routes = [
    { server_name='odoh-snowstorm', via=['odohrelay-crypto-sx'] },
    { server_name='odoh-cloudflare', via=['odohrelay-crypto-sx'] }
]

# DNSCRYPT Server/Anon-Relay Settings
# routes = [
#   { server_name='quad9-dnscrypt-ip6-nofilter-pri', via=['anon-cs-berlin', 'anon-cs-dus6'] },
#   { server_name='quad9-dnscrypt-ip4-nofilter-pri', via=['sdns://gREzNy4xMjAuMjE3Ljc1OjQ0Mw'] },
#   { server_name='quad9-dnscrypt-ip6-nofilter-ecs-pri', via=['anon-cs-de', 'anon-cs-norway6'] }
# ]


## Skip resolvers incompatible with anonymization instead of using them directly
skip_incompatible = true
</code></pre>
<p>The only
<a href="https://github.com/DNSCrypt/dnscrypt-resolvers/blob/master/v3/odoh-relays.md">ODoH relay</a>
listed is <code>odohrelay-crypto-sx</code> so both ODoH servers are routed through the same
relay.</p>
<p>The commented out <code>server_names</code> and <code>routes</code> are for Anonymous relays, which
are different from oblivious relays and servers. Check the
<a href="https://github.com/DNSCrypt/dnscrypt-resolvers/blob/master/v3/relays.md">relays.md</a>
for different anon relays.</p>
<p>Resources:</p>
<details>
<summary> ‚úîÔ∏è Click to Expand Resources </summary>
<ul>
<li>
<p><a href="https://raw.githubusercontent.com/DNSCrypt/dnscrypt-resolvers/master/v3/public-resolvers.md">public-resolvers v3</a></p>
</li>
<li>
<p><a href="https://dnscrypt.info/public-servers/">dnscrypt public-servers</a></p>
</li>
<li>
<p><a href="https://github.com/DNSCrypt/dnscrypt-proxy/wiki/Oblivious-DoH">Oblivious DoH</a></p>
</li>
<li>
<p><a href="https://github.com/DNSCrypt/dnscrypt-resolvers/blob/master/v3/odoh-servers.md">List of public ODoH servers</a></p>
</li>
<li>
<p><a href="https://github.com/DNSCrypt/dnscrypt-resolvers/blob/master/v3/odoh-relays.md">List of public ODoH relays</a></p>
</li>
<li>
<p><a href="https://raw.githubusercontent.com/Quad9DNS/dnscrypt-settings/main/dnscrypt/quad9-resolvers.md">List of quad9-resolvers</a></p>
</li>
<li>
<p><a href="https://www.dnscry.pt/">dnscry.pt</a></p>
</li>
</ul>
</details>
</details>
<p>Modify <code>/etc/resolv.conf</code>:</p>
<pre><code class="language-conf">nameserver ::1
nameserver 127.0.0.1
options edns0
</code></pre>
<p>Stop it from being overwritten:</p>
<pre><code class="language-bash">sudo chattr +i /etc/resolv.conf
</code></pre>
<p>Disable any services bound to port 53</p>
<pre><code class="language-bash">ss -lp 'sport = :domain'
</code></pre>
<pre><code class="language-bash">sudo systemctl stop systemd-resolved
sudo systemctl disable systemd-resolved
</code></pre>
<p>Enable <code>dnscrypt-proxy</code>:</p>
<pre><code class="language-bash">sudo systemctl enable dnscrypt-proxy
</code></pre>
<p><code>libvirtd</code> is another service that utilizes <code>dnsmasq</code> which uses port 53 and
conflicts with this setup. Since dnscrypt-proxy uses port 53 by default, it
makes using it with <code>libvirtd</code> difficult.</p>
<hr />
<h2>dnsmasq as a local DNS server</h2>
<p>Edit the <code>listen_addresses</code> in <code>/etc/dnscrypt-proxy/dnscrypt-proxy.toml</code>:</p>
<pre><code class="language-toml">listen_addresses = ['127.0.0.1:5353', '[::1]:5353']
</code></pre>
<p>Edit <code>/etc/dnsmasq.conf</code>:</p>
<pre><code class="language-conf">listen-address=127.0.0.1,::1
server=127.0.0.1#5353
server=::1#5353
</code></pre>
<pre><code class="language-bash">sudo systemctl enable dnsmasq
</code></pre>
<pre><code class="language-bash">sudo systemctl restart dnsmasq
sudo systemctl restart dnscrypt-proxy
</code></pre>
<p><strong>How it Works</strong></p>
<p>We‚Äôve created a two-step process for your DNS queries. Instead of your computer
directly asking a DNS server for a website‚Äôs IP address, it now sends the
request to dnsmasq first.</p>
<ol>
<li>
<p>We configured dnsmasq to listen on 127.0.0.1 (our local machine). This means
that all DNS queries from our system are sent to dnsmasq.</p>
</li>
<li>
<p>We told dnsmasq to use dnscrypt-proxy as its upstream DNS server with
<code>server=127.0.0.1#5353</code>. So, dnsmasq gets the DNS request and immediately
forwards it to dnscrypt-proxy, which is listening on port 5353.</p>
</li>
<li>
<p>dnscrypt-proxy then takes the forwarded request, encrypts it, and sends it to
a secure DNS resolver on the internet. It receives the IP address back,
decrypts it, and sends it back to dnsmasq.</p>
</li>
<li>
<p>Finally, dnsmasq receives the IP address from dnscrypt-proxy and sends it
back to the program that made the original request (e.g., the browser).</p>
</li>
</ol>
<h2>Add Blocklists</h2>
<ul>
<li><a href="https://github.com/DNSCrypt/dnscrypt-proxy/wiki/Filters">dnscrypt-proxy Filters</a></li>
</ul>
<p>Configure filter list sources in
<code>/usr/share/dnscrypt-proxy/utils/generate-domains-blocklist/domains-blocklist.conf</code>:</p>
<blockquote>
<p>‚ùóÔ∏è NOTE: Do a bit of research, all of these aren‚Äôt required and will slow down
your queries. You can also setup an allowlist for exceptions.</p>
</blockquote>
<pre><code class="language-conf"># NextDNS CNAME cloaking list
https://raw.githubusercontent.com/nextdns/cname-cloaking-blocklist/master/domains

# AdGuard Simplified Domain Names filter
https://adguardteam.github.io/AdGuardSDNSFilter/Filters/filter.txt

# OISD Big list
https://big.oisd.nl/domainswild

# HaGeZi Multi PRO
https://raw.githubusercontent.com/hagezi/dns-blocklists/main/wildcard/pro-onlydomains.txt

# HaGeZi Threat Intelligence Feeds
https://raw.githubusercontent.com/hagezi/dns-blocklists/main/wildcard/tif-onlydomains.txt
</code></pre>
<pre><code class="language-bash">sudo mkdir -p /etc/dnscrypt-proxy-blocklist
sudo cp -r /usr/share/dnscrypt-proxy/utils/generate-domains-blocklist/* /etc/dnscrypt-proxy-blocklist/
</code></pre>
<p>Save
<a href="https://raw.githubusercontent.com/DNSCrypt/dnscrypt-proxy/master/utils/generate-domains-blocklist/generate-domains-blocklist.py">generate-domains-blocklist.py</a>
to <code>/usr/share/dnscrypt-proxy/utils/generate-domains-blocklist</code></p>
<pre><code class="language-bash">cd /etc/dnscrypt-proxy-blocklist
sudo python3 generate-domains-blocklist.py -o blocklist.txt
</code></pre>
<p>Create a service to download &amp; combine filter lists:
<code>/etc/systemd/system/dnscrypt-filterlist-update.service</code>:</p>
<pre><code class="language-.service">[Unit]
Description=DNSCrypt Filterlist Update

[Service]
Type=oneshot
ExecStart=/etc/dnscrypt-proxy-blocklist/generate-domains-blocklist -a /etc/dnscrypt-proxy-blocklist/domains-allowlist.txt -o /etc/dnscrypt-proxy-blocklist/blocklist.txt
ExecStartPost=/usr/bin/sleep 2
ExecStartPost=/usr/bin/systemctl restart dnscrypt-proxy.service
</code></pre>
<p>Create a timer to run at boot &amp; every 5 hours.
<code>/etc/systemd/system/dnscrypt-filterlist-update.timer</code>:</p>
<pre><code class="language-.timer">[Unit]
Description=Run filterlist update 15min after boot and every 5h

[Timer]
OnBootSec=15min
OnUnitActiveSec=5h

[Install]
WantedBy=timers.target
</code></pre>
<pre><code class="language-bash">sudo systemctl daemon-reload
sudo systemctl enable dnscrypt-filterlist-update.timer
</code></pre>
<p>Configure dnscrypt-proxy to use the blocklist:</p>
<p><code>/etc/dnscrypt-proxy/dnscrypt-proxy.toml</code>:</p>
<pre><code class="language-toml">blocked_names_file = "/usr/share/dnscrypt-proxy/utils/generate-domains-blocklist/blocklist.txt"
log_file = '/var/log/dnscrypt-proxy/blocked-names.log'
</code></pre>
<p>For an allow list, you create a list of names you want to allow to bypass your
blocklist:</p>
<pre><code class="language-toml">allowed_names_file = "/usr/share/dnscrypt-proxy/utils/generate-domains-blocklist/allowed-names.txt"
log_file = "/var/log/dnscrypt-proxy/allowed-names.log"
</code></pre>
<p>Restart the service:</p>
<pre><code class="language-bash">sudo systemctl restart dnscrypt-proxy
</code></pre>
<p>Reboot.</p>
<p>Verify blocklist works against an address listed in <code>blocklist.txt</code>:</p>
<pre><code class="language-bash">dig dm.csl.academy @127.0.0.1 -p 53
</code></pre>
<p>Output:</p>
<pre><code class="language-bash">;; ANSWER SECTION:
dm.csl.academy.         10      IN      HINFO   "This query has been locally blocked" "by dnscrypt-proxy"
</code></pre>
<h2>Testing</h2>
<p>I tested in Firefox by ensuring that in <code>Settings -&gt; Privacy &amp; Security</code> the DNS
over HTTPS was set to <code>Status: Off</code>, Enable DNS over HTTPS using: <code>Off</code> Use your
default DNS resolver.</p>
<p>Then go to <code>https://dnsleaktest.com</code> and perform an Extended Test. If you used
the above configuration with Quad9‚Äôs resolvers, you should see all WoodyNet ISPs
listed in Germany. If not, something is wrong and you have a DNS leak.</p>
<p>I have noticed dnsleaktest having issues lately, <code>https://ipleak.net</code> works for
this as well.</p>
<h2>Enable MAC Randomization</h2>
<pre><code class="language-bash">sudo mkdir -p /etc/NetworkManager/conf.d
sudo hx /etc/NetworkManager/conf.d/20-mac-randomization.conf
</code></pre>
<p>Add the following for randomization (use <code>stable</code> for consistent per-network
MACs; change to <code>random</code> if preferred)</p>
<pre><code class="language-conf">[device]
wifi.scan-rand-mac-address=yes

[connection]
wifi.cloned-mac-address=random
ethernet.cloned-mac-address=random
</code></pre>
<ul>
<li>
<p><code>wifi.scan-rand-mac-address=yes</code>: Enables randomization during Wi-Fi scans
(default, but explicit for clarity).</p>
</li>
<li>
<p><code>wifi.cloned-mac-address=stable</code> / <code>ethernet.cloned-mac-address=stable</code>:
Applies to Wi-Fi and Ethernet connections.</p>
</li>
</ul>
<p><strong>Verify MAC Randomization</strong></p>
<p>Check your interface (e.g., <code>wlp3s0</code> for Wi-Fi, find with <code>ip link</code>)</p>
<pre><code class="language-bash">ip link show wlp3s0 | grep link/ether
</code></pre>
<pre><code class="language-bash">nmcli connection down "YourSSID"
nmcli connection up "YourSSID"
</code></pre>
<p>Check MAC again:</p>
<pre><code class="language-bash">cat /sys/class/net/wlp3s0/address
</code></pre>
<pre><code class="language-bash">sudo systemctl status dnscrypt-proxy dnsmasq
</code></pre>
<pre><code class="language-bash">nslookup example.com
</code></pre>
<hr />
<p><strong>Enable dnsmasq caching</strong></p>
<p><code>/etc/NetworkManager/dnsmasq.d/cache.conf</code>:</p>
<pre><code class="language-conf">cache-size=1000
</code></pre>
<hr />
<p>This may help with IPv6 connectivity, add the following to
<code>/etc/NetworkManager/dnsmasq.d/ipv6-listen.conf</code>:</p>
<pre><code class="language-bash">listen-address=::1
</code></pre>
<hr />
<p><strong>Enable DNSSEC validation</strong>:</p>
<p><code>/etc/NetworkManager/dnsmasq.d/dnssec.conf</code>:</p>
<pre><code class="language-conf">conf-file=/usr/share/dnsmasq/trust-anchors.conf
dnssec
</code></pre>
<h2>Enable Privacy Extensions</h2>
<p>Add this to <code>/etc/sysctl.d/40-ipv6.conf</code>:</p>
<pre><code class="language-conf"># Enable IPv6 Privacy Extensions
net.ipv6.conf.all.use_tempaddr = 2
net.ipv6.conf.default.use_tempaddr = 2
net.ipv6.conf.nic.use_tempaddr = 2
</code></pre>
<pre><code class="language-bash"># find nic
ip link
net.ipv6.conf.wlp3s0.use_tempaddr = 2
</code></pre>
<pre><code class="language-bash">sudo sysctl --system
</code></pre>
<p><code>/etc/NetworkManager/conf.d/ip6-privacy.conf</code>:</p>
<pre><code class="language-conf">[connection]
ipv6.ip6-privacy=2
</code></pre>
]]></description><author>saylesss88</author><guid>https://saylesss88.github.io/privacy-book/arch/enc_dns.html</guid><pubDate>Fri, 5 Dec 2025 00:00:00 +0000</pubDate></item><item><title>index</title><link>https://saylesss88.github.io/privacy-book/index.html</link><description><![CDATA[]]></description><guid>https://saylesss88.github.io/privacy-book/index.html</guid><pubDate>Wed, 3 Dec 2025 00:05:27 +0000</pubDate></item><item><title>Hardening Networking</title><link>https://saylesss88.github.io/privacy-book/arch/hardening_networking.html</link><description><![CDATA[<h1>Hardening Networking</h1>
<p>NetworkManagers global config is <code>/etc/NetworkManager/NetworkManager.conf</code>.
Additional config files can be placed in <code>/etc/NetworkManager/conf.d</code>.</p>
<p>After editing a config file, apply the changes with:</p>
<pre><code class="language-bash">sudo nmcli general reload
</code></pre>
<pre><code class="language-bash">sudo usermod -aG network $USER
</code></pre>
<h2>Investigate sockets</h2>
<p>Display all TCP Sockets with service names:</p>
<pre><code class="language-bash">ss -at
</code></pre>
<p>Display all TCP Sockets with port numbers:</p>
<pre><code class="language-bash">ss -atn
</code></pre>
<p>Display all UDP Sockets:</p>
<pre><code class="language-bash">ss -au
</code></pre>
<h2>Configure NetworkManager to use Quad9s DoT</h2>
<p>Create <code>/etc/NetworkManager/system-connections/Wi-Fi.nmconnection</code>:</p>
<pre><code class="language-.nmconnection">[connection]
dns-over-tls=2

[ipv4]
dns=9.9.9.9#dns.quad9.net;149.112.112.112#dns.quad9.net;
ignore-auto-dns=true

[ipv6]
dns=2620:fe::fe#dns.quad9.net;2620:fe::9#dns.quad9.net;
ignore-auto-dns=true
</code></pre>
<pre><code class="language-bash">sudo systemctl restart NetworkManager
</code></pre>
<p><strong>Wi-Fi MAC randomization</strong></p>
<p>Add the following to <code>/etc/NetworkManager/conf.d/wifi_rand_mac.conf</code>:</p>
<pre><code class="language-conf">[device-mac-randomization]
# "yes" is already the default for scanning
wifi.scan-rand-mac-address=yes

[connection-mac-randomization]
# Randomize MAC for every ethernet connection
ethernet.cloned-mac-address=random
# Generate a random MAC every time you connect to a wifi network
wifi.cloned-mac-address=random
</code></pre>
<p><strong>Unique DUID per connection</strong></p>
<p>Create <code>/etc/NetworkManager/conf.d/duid.conf</code>:</p>
<pre><code class="language-conf">[connection]
ipv6.dhcp-duid=stable-uuid
</code></pre>
<h2>MAC Address spoofing</h2>
<p>This section demonstrates how to spoof your Media Access Control (MAC) address.</p>
<p><strong>Manual MAC randomization with macchanger</strong></p>
<p>Find your device interface and check your current MAC address:</p>
<pre><code class="language-bash"># find interface
ip add
sudo iplink show wlp3s0
</code></pre>
<p>The address following <code>"link/ether"</code> is your MAC, bring it down so we can change
it:</p>
<pre><code class="language-bash">sudo ip link set dev wlp3s0 down
# or
# sudo ifconfig wlp3s0 down
</code></pre>
<p>Install the <code>macchanger</code> package and run:</p>
<pre><code class="language-bash">sudo macchanger -a wlp3s0
</code></pre>
<ul>
<li>
<p><code>-a</code>, <code>--another</code>: Set random vendor MAC of the same kind.</p>
</li>
<li>
<p><code>-r</code>, <code>--random</code>: Set fully random MAC.</p>
</li>
</ul>
<p><strong>Automatically with systemd &amp; macchanger</strong></p>
<p>systemd unit setting a random address while preserving the original NIC vendor
bytes.</p>
<p>Create <code>/etc/systemd/system/macspoof@.service</code>:</p>
<pre><code class="language-macspoof@.service">[Unit]
Description=macchanger on %I
Wants=network-pre.target
Before=network-pre.target
BindsTo=sys-subsystem-net-devices-%i.device
After=sys-subsystem-net-devices-%i.device

[Service]
ExecStart=/usr/bin/macchanger -e %I
Type=oneshot

[Install]
WantedBy=multi-user.target
</code></pre>
<ul>
<li>
<p>You can use <code>-r</code> to randomize everything but it‚Äôs important that the vendor
bytes actually match something and aren‚Äôt just random numbers so it‚Äôs less
recommended.</p>
</li>
<li>
<p>The <code>@.service</code> pattern allows per-interface instantiation like
<code>macspoof@wlp3s0.service</code>.</p>
</li>
<li>
<p>The <code>%I</code> variable automatically resolves to your interface name.</p>
</li>
<li>
<p>You only need to append your interface name when enabling the service.</p>
</li>
</ul>
<pre><code class="language-bash">sudo systemctl enable macspoof@wlp3s0.service
</code></pre>
<h2>Resources</h2>
<ul>
<li>
<p><a href="https://www.kicksecure.com/wiki/MAC_Address">KickSecure MAC_address</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/MAC_address_spoofing">Arch Wiki MAC address spoofing</a></p>
</li>
<li>
<p><a href="https://tldp.org/LDP/nag2/index.html">Linux Network Admin Guide</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/NetworkManager">Arch Wiki NetworkManager</a></p>
</li>
</ul>
]]></description><author>saylesss88</author><guid>https://saylesss88.github.io/privacy-book/arch/hardening_networking.html</guid><pubDate>Fri, 28 Nov 2025 00:00:00 +0000</pubDate></item><item><title>Encrypted Arch Install</title><link>https://saylesss88.github.io/privacy-book/arch/enc_install.html</link><description><![CDATA[<h1>Encrypted Arch Install for UEFI Systems with UKI and Secure Boot</h1>
<details>
<summary> ‚úîÔ∏è Click to Expand Table of Contents</summary>
<!-- toc -->
</details>
<p>The ultimate installation resource is always goint to be the:</p>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/Installation_guide">Arch Wiki Installation Guide</a></p>
</li>
<li>
<p><a href="https://archlinux.org/download/#checksums">Verify PGP Signatures</a>, the ISO
directory is just the same directory where your Arch Linux ISO file is stored.</p>
</li>
</ul>
<blockquote>
<p>Always review the Wiki and never just plug random things suggested by me or
anyone else without first doing your own research.</p>
</blockquote>
<p>Edited: 09-25-25 Removed encrypted swap section. Big usability downside IMO.</p>
<details>
<summary> ‚úîÔ∏è Verifying Arch Linux ISO on Other Distributions </summary>
<blockquote>
<p>‚ùó NOTE: If you only want to verify the ISO once, you can temporarily import
the public key, verify the signature, and then you don‚Äôt need to keep the key
permanently in your keyring or sign it locally. This example is from the last
release, but the process is the same.</p>
</blockquote>
<p>With <code>sequoia-sq</code>, you can get the Arch release signing key with:</p>
<pre><code class="language-bash">sq network wkd search pierre@archlinux.org --output release-key.pgp
</code></pre>
<p>Export the chosen key to a <code>.pgp</code> file:</p>
<pre><code class="language-bash">sq cert export --keyring=release-key.pgp --cert=3E80CA1A8B89F69CBA57D98A76A5EF9054449A5C &gt; pierre-archlinux.pgp
</code></pre>
<p>Import into your keychain:</p>
<pre><code class="language-bash">gpg --import pierre-archlinux.pgp
gpg: key 0x76A5EF9054449A5C: 9 signatures not checked due to missing keys
gpg: key 0x76A5EF9054449A5C: public key "Pierre Schmitz &lt;pierre@archlinux.org&gt;" imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: depth: 0  valid:   3  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 3u
gpg: next trustdb check due at 2026-08-23
</code></pre>
<ul>
<li>Now, you should see <code>&lt;pierre@archlinux.org&gt;</code> and his keys when you run
<code>gpg --list-keys</code></li>
</ul>
<p>Finally, verify the signature:</p>
<pre><code class="language-bash">sq verify --signer-file release-key.pgp --signature-file archlinux-2025.08.01-x86_64.iso.sig archlinux-2025.08.01-x86_64.iso
Authenticated signature made by 3E80CA1A8B89F69CBA57D98A76A5EF9054449A5C (Pierre Schmitz &lt;pierre@archlinux.org&gt;)

1¬†authenticated signature.
</code></pre>
<blockquote>
<p>‚ùó To ensure the key is authentic and not spoofed, verify that the key
fingerprint matches the official Arch Linux signing key fingerprint, which can
is linked below and on the Arch website.</p>
</blockquote>
<p>This shows that the signature was made by the key with the ID
<code>3E80CA1A8B89F69CBA57D98A76A5EF9054449A5C (Pierre Schmitz)</code></p>
<p>You can check the keys fingerprint with:</p>
<pre><code class="language-bash">gpg --fingerprint 3E80CA1A8B89F69CBA57D98A76A5EF9054449A5C
</code></pre>
<ul>
<li>Verify it against the
<a href="https://archlinux.org/master-keys/">Arch Linux master-keys</a></li>
</ul>
<p>Verify it against the Arch Linux master-keys</p>
<p>With the <code>sq verify</code> command GPG authenticated that the signature is valid and
that the key used to sign is trusted in our keyring.</p>
<p><code>1 authenticated signature</code> confirms the files integrity and authenticity.</p>
<p>We have successfully verified that the file was signed by Pierr‚Äôs official Arch
Linux key and has not been tampered with.</p>
<p>The following is only if you currently already have keys on your gpg keyring.</p>
<details>
<summary> ‚òëÔ∏è Click to expand Key Signing and Publishing Example </summary>
<p>List your keys to get the arch keyID:</p>
<pre><code class="language-bash">gpg --list-keys
# ... snip ...
pub   ed25519/0x76A5EF9054449A5C 2022-10-31 [SC] [expires: 2037-10-27]
      Key fingerprint = 3E80 CA1A 8B89 F69C BA57  D98A 76A5 EF90 5444 9A5C
uid                   [  full  ] Pierre Schmitz &lt;pierre@archlinux.org&gt;
uid                   [  full  ] Pierre Schmitz &lt;pierre@archlinux.de&gt;
sub   ed25519/0xD6D13C45BFCFBAFD 2022-10-31 [A] [expires: 2037-10-27]
sub   cv25519/0x7F56ADE50CA3D899 2022-10-31 [E] [expires: 2037-10-27]
</code></pre>
<p>Sign the key:</p>
<pre><code class="language-bash">gpg --sign-key 0x76A5EF9054449A5C
</code></pre>
<p>Now you can export and publish the new public key and send it to a keyserver:</p>
<pre><code class="language-bash">gpg --export --armor 0x76A5EF9054449A5C &gt; archlinux-signed.asc
gpg --send-keys 0x76A5EF9054449A5C
</code></pre>
<p>The more people that verify, sign, and re-export and publish their keys the
better for the web of trust that gpg uses making the network more secure for
everyone.</p>
</details>
</details>
<hr />
<ol>
<li><strong>Connect to Wi-Fi</strong>:</li>
</ol>
<pre><code class="language-bash">iwctl
[iwd]# device list
[iwd]# station wlan0 scan
[iwd]# station wlan0 connect NETGEAR80
# Enter your Password
# Check Connection
[iwd]# station wlan0 show
[iwd]# exit
</code></pre>
<pre><code class="language-bash">ping -c 3 archlinux.org
</code></pre>
<hr />
<ol start="2">
<li><strong>Update package databases and mirrorlist</strong>:</li>
</ol>
<pre><code class="language-bash">pacman -Syyu
</code></pre>
<p>Save a backup of your current mirrorlist so we can safely update it:</p>
<pre><code class="language-bash">cp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.bak
</code></pre>
<pre><code class="language-bash">pacman -S reflector
reflector --list-countries
# Example if you live in the US
reflector -c US --protocol https --age 6 --fastest 5 --sort rate --save /etc/pacman.d/mirrorlist
</code></pre>
<p>This actually improves security by only providing <code>HTTPS</code> mirrors, by default
both HTTP and HTTPS are used.</p>
<p>NOTE: This can take a bit and you can expect some failures..</p>
<hr />
<ol start="3">
<li><strong>Set keyboard layout, font, and system clock</strong>:</li>
</ol>
<p>Default keymap is US, if you need something different:</p>
<pre><code class="language-bash">localectl list-keymaps
loadkeys &lt;chosen-map&gt;
# Increase font size
setfont ter-132b
</code></pre>
<pre><code class="language-bash">sudo pacman -S chrony
</code></pre>
<p><code>/etc/chrony.conf</code>:</p>
<pre><code class="language-conf"># Copyright ¬© 2014-2025 GrapheneOS

# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:

# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.

# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
# THE SOFTWARE.

server time.cloudflare.com iburst nts
server ntppool1.time.nl iburst nts
server nts.netnod.se iburst nts
server ptbtime1.ptb.de iburst nts
server time.dfm.dk iburst nts
server time.cifelli.xyz iburst nts

minsources 3
authselectmode require

# EF
dscp 46

driftfile /var/lib/chrony/drift
dumpdir /var/lib/chrony
ntsdumpdir /var/lib/chrony

leapseclist /usr/share/zoneinfo/leap-seconds.list
makestep 1.0 3

rtconutc
rtcsync

cmdport 0

noclientlog
</code></pre>
<p>The above setup uses Network Time Security (NTS) and is a more modern safer way
to synchronize time using chrony.</p>
<pre><code class="language-bash">sudo systemctl disable --now systemd-timesyncd
sudo systemctl enable --now chronyd
</code></pre>
<pre><code class="language-bash">timedatectl set-ntp true
timedatectl list-timezones
# Example
sudo timedatectl set-timezone America/New_York
</code></pre>
<hr />
<ol start="4">
<li><strong>Partition your Disk</strong>:</li>
</ol>
<p>The only required partitions are one for the root directory <code>/</code> (typically <code>1G</code>)
and one for booting in UEFI mode, an EFI system partition (typically the rest of
the space left).</p>
<p>In this section, I‚Äôll assume that you‚Äôre starting with a clean slate. If you‚Äôre
not, you can use your existing partitions if they meet the above requirements or
delete them.</p>
<p>To delete existing partitions with <code>cfdisk</code>, you launch it on the target
filesystem, select the partition you want to delete and Select -&gt; <code>[ Delete ]</code>
until all you see is <code>Free space</code> and a clean slate and <code>[ Write ]</code> &amp; <code>[ Quit ]</code>
to save your changes.</p>
<p>Identify your target disk (e.g., <code>/dev/nvme0n1</code>):</p>
<pre><code class="language-bash">fdisk -l
</code></pre>
<pre><code class="language-bash">cfdisk /dev/nvme0n1
</code></pre>
<ul>
<li>
<p>Select -&gt; <code>[ Free Space ]</code></p>
<ul>
<li>
<p>Select -&gt; <code>[ New ]</code></p>
</li>
<li>
<p>Partition size: <code>1G</code></p>
</li>
<li>
<p>Type -&gt; <code>EFI System</code></p>
</li>
</ul>
</li>
<li>
<p>Select -&gt; <code>[ Free Space ]</code></p>
<ul>
<li>
<p>Partition size: The rest of the space</p>
</li>
<li>
<p>Type -&gt; <code>Linux filesystem</code></p>
</li>
<li>
<p>Select -&gt; <code>[ Write ]</code></p>
</li>
<li>
<p>Select -&gt; <code>[ Quit ]</code></p>
</li>
</ul>
</li>
</ul>
<hr />
<ol start="5">
<li><strong>Format the EFI partition as FAT32</strong>:</li>
</ol>
<pre><code class="language-bash">mkfs.fat -F32 /dev/nvme0n1p1
</code></pre>
<p>Leave the root partition unformatted for the next step.</p>
<hr />
<ol start="6">
<li><strong>Encrypt the Root partition and Open it</strong>:</li>
</ol>
<pre><code class="language-bash">cryptsetup luksFormat /dev/nvme0n1p2
cryptsetup open /dev/nvme0n1p2 cryptroot
</code></pre>
<p>Create a filesystem:</p>
<pre><code class="language-bash">mkfs.btrfs /dev/mapper/cryptroot
</code></pre>
<p>If you mount the filesystem with compression before running <code>genfstab</code>, it will
automatically add the chosen compression to the <code>fstab</code>.</p>
<pre><code class="language-bash">mount /dev/nvme0n1p1 /mnt/boot  # Mount EFI partition at /mnt/boot
mount -o compress=zstd /dev/mapper/cryptroot /mnt
</code></pre>
<hr />
<h2>Install the Base System on <code>/mnt</code> with <code>pacstrap</code></h2>
<p>If you prefer Nvim or a hardened kernel, change it here.</p>
<pre><code class="language-bash">pacstrap -K /mnt base linux-zen linux-zen-headers linux-firmware networkmanager helix lightdm lightdm-gtk-greeter btrfs-progs cryptsetup sudo base-devel efibootmgr systemd-ukify
</code></pre>
<hr />
<ol start="7">
<li><strong>Generate the Filesystem Table</strong>:</li>
</ol>
<p>The EFI and root partitions need to be mounted before you generate the
filesystem table in the next step.</p>
<pre><code class="language-bash">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab
#
hx /mnt/etc/fstab
cat /mnt/etc/fstab
</code></pre>
<p>Fix security hole and harden <code>/boot</code> permissions by adding
<code>fmask=0137, dmask=0027</code>:</p>
<pre><code class="language-bash">hx /mnt/etc/fstab
</code></pre>
<p>Example</p>
<pre><code class="language-fstab"># Static information about the filesystems.
# See fstab(5) for details.

# &lt;file system&gt; &lt;dir&gt; &lt;type&gt; &lt;options&gt; &lt;dump&gt; &lt;pass&gt;
# /dev/mapper/cryptroot
UUID=6d68a2bf-34ea-4adc-86d5-cb1d56de44a4	/         	btrfs     	rw,relatime,compress=zstd:3,ssd,space_cache=v2,subvol=/	0 0

# /dev/nvme0n1p1
UUID=B88B-844F      	/boot     	vfat      	rw,relatime,fmask=0137,dmask=0027,codepage=437,iocharset=ascii,shortname=mixed,utf8,errors=remount-ro	0 2
</code></pre>
<pre><code class="language-bash">chmod 700 /boot
chmod 600 /boot/loader/random-seed
</code></pre>
<p><strong>Important</strong>: The <code>fstab</code> should list both partitions, if it doesn‚Äôt you‚Äôll
need to ensure both partitions are mounted and regenerate your fstab again with
<code>genfstab</code>. Also ensure that the root partition was mounted with compression.</p>
<hr />
<ol start="8">
<li><strong>Change Root (<code>chroot</code>) into the New Installation</strong></li>
</ol>
<pre><code class="language-bash">arch-chroot /mnt
</code></pre>
<p>Create a user:</p>
<pre><code class="language-bash">useradd -m -G wheel -s /bin/bash yourusername
passwd yourusername
</code></pre>
<p>Create an admin password:</p>
<pre><code class="language-bash">passwd
</code></pre>
<p>Enable sudo for wheel group:</p>
<p>In <code>/etc/sudoers</code> uncomment the line:</p>
<pre><code class="language-bash">%wheel ALL=(ALL:All) ALL
</code></pre>
<hr />
<ol start="9">
<li>Edit <code>/etc/mkinitcpio.conf</code> in the new system to add an <code>sd-encrypt</code> hook
before the <code>filesystems</code> attribute.</li>
</ol>
<ul>
<li>
<p>Locate the <code>HOOKS</code> line</p>
</li>
<li>
<p>Insert <code>encrypt</code> <strong>before</strong> filesystems</p>
</li>
</ul>
<pre><code class="language-bash">vim /etc/mkinitcpio.conf
</code></pre>
<p>To use <code>sd-encrypt</code>, it is necessary to replace <code>udev</code> with <code>systemd</code> and if you
require a different keyboard layout from US <code>sd-vconsole</code> is needed.</p>
<pre><code class="language-bash"># mkinitcpio.conf
# *IF* you use an nvme drive
MODULES=(nvme)
FILES=(/etc/crypttab.initramfs /etc/vconsole.conf)
# ... snip ...
HOOKS=(base systemd autodetect microcode modconf kms keyboard keymap consolefont sd-vconsole block sd-encrypt filesystems fsck systemd-ukify)
# ... snip ...
</code></pre>
<p>Create <code>/etc/crypttab.initramfs</code>:</p>
<pre><code class="language-initramfs">cryptroot UUID=your-uuid none luks,discard
</code></pre>
<hr />
<p>Create <code>/etc/vconsole.conf</code>:</p>
<p>For example <code>KEYMAP=fr</code> is french</p>
<pre><code class="language-conf">KEYMAP=us
FONT=lat9w-16
</code></pre>
<hr />
<p>Edit <code>/etc/mkinitcpio.d/linux-zen.preset</code>, this enables <code>mkinitcpio -P</code> to
generate a UKI in <code>/boot/EFI/Linux/</code>:</p>
<pre><code class="language-preset"># mkinitcpio preset file for the 'linux-zen' package

ALL_config="/etc/mkinitcpio.conf"
ALL_kver="/boot/vmlinuz-linux-zen"

PRESETS=('default' 'fallback')
# PRESETS=('default')

# default_config="/etc/mkinitcpio.conf"
# default_image="/boot/initramfs-linux-zen.img"
default_uki="/boot/EFI/Linux/arch-linux-zen.efi"
default_options="--splash /usr/share/systemd/bootctl/splash-arch.bmp"

#fallback_config="/etc/mkinitcpio.conf"
#fallback_image="/boot/initramfs-linux-zen-fallback.img"
fallback_uki="/boot/EFI/Linux/arch-linux-zen-fallback.efi"
fallback_options="-S autodetect"
</code></pre>
<p>Generate the initial RAM Filesystem (initramfs) image.</p>
<pre><code class="language-bash">mkinitcpio -P
</code></pre>
<blockquote>
<p>‚ùóÔ∏è TIP: If <code>mkinitcpio -P</code> fails, exit <code>arch-chroot</code> and ensure both the boot
&amp; root partitions are mounted. <code>arch-chroot</code> back into <code>/mnt</code> and try again.
Ensure that <code>/boot/EFI/Linux/arch-linux-zen.efi</code> and
<code>/boot/EFI/Linux/arch-linux-zen-fallback.efi</code> exist for your kernel of choice.</p>
</blockquote>
<hr />
<ol start="10">
<li><strong>Install systemd-boot and setup Unified Kernel Image</strong>, (while still in
chroot environment):</li>
</ol>
<p>Ensure your UEFI variables are accessible:</p>
<pre><code class="language-bash">efivar --list
</code></pre>
<p>This command won‚Äôt work if both partitions aren‚Äôt mounted, ensure they are both
mounted and if it still doesn‚Äôt work you can use <code>--esp-path=/boot</code> or
<code>--esp-path=/mnt/boot</code>.</p>
<pre><code class="language-bash">bootctl install
</code></pre>
<p>Edit <code>/etc/kernel/cmdline</code> and add the output of <code>blkid</code> on your root partition.
For example:</p>
<pre><code class="language-bash">blkid /dev/nvme0n1p2 &gt; /tmp/uuid.txt
</code></pre>
<p>When you open <code>/etc/kernel/cmdline</code> in vim or helix, run <code>:r /tmp/uuid.txt</code> to
read the UUID of your root partition into the file. You only need the numbers
like so:</p>
<pre><code class="language-cmdline">rd.luks.name=7b78e942-f4f7-4dde-a015-3a816305483f=cryptroot root=/dev/mapper/cryptroot rw
</code></pre>
<p>In the above example, <code>7b78e942-f4f7-4dde-a015-3a816305483f</code> is the UUID
extracted from the <code>blkid</code> command.</p>
<p>Create a <code>/boot/loader/entries/arch.conf</code> with the following:</p>
<pre><code class="language-conf">title Arch Linux
linux /vmlinuz-linux-zen
initrd /initramfs-linux-zen.img
options rd.luks.name=7b78e942-f4f7-4dde-a015-3a816305483f=cryptroot root=/dev/mapper/cryptroot rw quiet
</code></pre>
<blockquote>
<p>‚ùóÔ∏è NOTE: The <code>arch.conf</code> here is redundant because <code>systemd-boot</code> is
configured to autodetect the UKI. It doesn‚Äôt hurt to add it though and can
prevent issues in the future. Ensure <code>rd.luks.name=</code> contains the UUID from
the encrypted root partition. (e.g., <code>blkid /dev/nvme0n1p2</code>).</p>
</blockquote>
<p>And finally, a <code>/boot/loader/loader.conf</code>:</p>
<pre><code class="language-conf">default arch.conf
# default @saved  # return to last choice
timeout 4
console-mode auto
auto-entries 1
</code></pre>
<pre><code class="language-bash">bootctl status
</code></pre>
<p>Set a password to protect <code>systemd-boot</code> with <code>systemd-boot-password</code>:</p>
<pre><code class="language-bash">paru -S systemd-boot-password
</code></pre>
<pre><code class="language-bash">sudo sbpctl install /boot
</code></pre>
<p>You will now be prompted for your password before you can edit kernel
parameters.</p>
<hr />
<p><strong>systemd-ukify and the Unified Kernel Image</strong>:</p>
<p>We already added <code>systemd-ukify</code> in the pacstrap command, let‚Äôs add a few more
tools for this process:</p>
<pre><code class="language-bash">sudo pacman -S sbsigntools efitools
</code></pre>
<p>Copy the existing template to <code>/etc/kernel/uki.conf</code>:</p>
<pre><code class="language-bash">cp /usr/lib/kernel/uki.conf /etc/kernel/uki.conf
</code></pre>
<p>Edit <code>/etc/kernel/uki.conf</code>:</p>
<pre><code class="language-conf">[UKI]
#Initrd=
#Microcode=
#Splash=
#PCRPKey=
#PCRBanks=
#SecureBootSigningTool=
SecureBootPrivateKey=/etc/kernel/secure-boot-private-key.pem
SecureBootCertificate=/etc/kernel/secure-boot-certificate.pem
#SecureBootCertificateDir=
#SecureBootCertificateName=
#SecureBootCertificateValidity=
#SigningEngine=
SignKernel=yes
</code></pre>
<p>Generate your signing keys:</p>
<pre><code class="language-bash">ukify genkey --config /etc/kernel/uki.conf
</code></pre>
<p>The above command creates <code>/etc/kernel/secure-boot-certificate.pem</code> and
<code>/etc/kernel/secure-boot-private-key.pem</code>.</p>
<p>Building the UKIs:</p>
<pre><code class="language-bash">mkdir -p /boot/EFI/Linux
mkinitcpio -P
# Output
Wrote signed /boot/EFI/Linux/arch-linux-zen.efi
==&gt; Unified kernel image generation successful
</code></pre>
<p>Sign the boot loader with the new keys:</p>
<pre><code class="language-bash">/usr/lib/systemd/systemd-sbsign sign \
--private-key /etc/kernel/secure-boot-private-key.pem \
--certificate /etc/kernel/secure-boot-certificate.pem \
--output /usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed \
/usr/lib/systemd/boot/efi/systemd-bootx64.efi
</code></pre>
<p>Output:</p>
<pre><code class="language-text">Wrote signed PE binary to /usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed
</code></pre>
<pre><code class="language-bash">sudo bootctl install --secure-boot-auto-enroll yes \
--certificate /etc/kernel/secure-boot-certificate.pem \
--private-key /etc/kernel/secure-boot-private-key.pem
</code></pre>
<p>Output:</p>
<pre><code class="language-text">Copied "/usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed" to "/boot/EFI/systemd/systemd-bootx64.efi".
    3 Copied "/usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed" to "/boot/EFI/BOOT/BOOTX64.EFI".
    4 ‚ö†Ô∏è  Mount point '/boot' which backs the random seed file is world accessible, which is a security hole!  ‚ö†Ô∏è
    5 ‚ö†Ô∏è Random seed file '/boot/loader/random-seed' is world accessible, which is a security hole! ‚ö†Ô∏è
    6 Random seed file /boot/loader/random-seed successfully refreshed (32 bytes).
    7 Secure boot auto-enrollment file /boot/loader/keys/auto/PK.auth successfully written.
    8 Secure boot auto-enrollment file /boot/loader/keys/auto/KEK.auth successfully written.
    9 Secure boot auto-enrollment file /boot/loader/keys/auto/db.auth successfully written.
   10 Created EFI boot entry "Linux Boot Manager".
</code></pre>
<p>Fix the security hole:</p>
<pre><code class="language-bash">chmod 700 /boot
</code></pre>
<p>Add the following to your <code>/boot/loader/loader.conf</code>:</p>
<pre><code class="language-conf">secure-boot-enroll force
</code></pre>
<p>Reboot into setup-mode and it will start an automatic countdown where it enrolls
your keys when the time runs out.</p>
<p>After successful key enrollment, reboot into UEFI again, enable Secure Boot and
reboot.</p>
<p>When the desktop launches, check the output of <code>bootctl status</code> to ensure
<code>Secure Boot: enabled (user)</code></p>
<p>If your system doesn‚Äôt accept them, you may have to do some conversions. You can
also add the keys manually which is what I did.</p>
<details>
<summary> ‚úîÔ∏è Click to Expand conversion Examples </summary>
<pre><code class="language-bash"># Create workspace for certs and outputs
mkdir -p ~/secureboot/output

# Define certificate location
CERT_PEM="/etc/kernel/secure-boot-certificate.pem"

# Convert PEM cert to DER format for UEFI enrollment
sudo openssl x509 -in $CERT_PEM -out ~/secureboot/output/db.cer -outform DER

# Convert PEM cert to EFI Signature List
cert-to-efi-sig-list $CERT_PEM ~/secureboot/output/db.esl

# Sign the Signature List (run from wherever your private key is; do not copy it)
sudo sign-efi-sig-list -k /etc/kernel/secure-boot-private-key.pem -c $CERT_PEM db \
    ~/secureboot/output/db.esl ~/secureboot/output/db.auth
</code></pre>
<p>Manual Key Enrollment:</p>
<ul>
<li>
<p><code>db.cer</code> -&gt; enroll in db (Trusted Signatures), Choose the desired drive, find
the file and add it. Save as an <code>Authorized Signature</code> instead of <code>Public Key</code></p>
</li>
<li>
<p><code>PK.cer</code> -&gt; enroll in <code>Platform Key</code>(PK)</p>
</li>
<li>
<p>Keep your <code>secure-boot-private-key.pem</code> <strong>private</strong>, with the above commands
we only use it when signing, and otherwise keep it protected.</p>
</li>
</ul>
</details>
<hr />
<ol start="11">
<li><strong>Enable LightDM and NetworkManager</strong></li>
</ol>
<pre><code class="language-bash">systemctl enable lightdm
systemctl enable NetworkManager
</code></pre>
<blockquote>
<p>‚ùóÔ∏è NOTE: If you‚Äôre ever unable to run the above commands in the chroot
environment, exit chroot and run:</p>
<pre><code class="language-bash">systemctl --root=/mnt enable lightdm
systemctl --root=/mnt enable NetworkManager
</code></pre>
</blockquote>
<p>Configure LightDM greeter, edit <code>/etc/lightdm/lightdm.conf</code> to add:</p>
<pre><code class="language-conf"># lightdm.conf
[Seat:*]
greeter-session=lightdm-gtk-greeter
</code></pre>
<p>Exit <code>arch-chroot</code> with <code>exit</code></p>
<p>Unmount your partitions and reboot:</p>
<pre><code class="language-bash">umount /mnt/boot
umount /mnt
cryptsetup close cryptroot
</code></pre>
<hr />
<ol start="12">
<li><strong>Reboot</strong></li>
</ol>
<pre><code class="language-bash">bootctl status
System:
      Firmware: UEFI 2.70 (American Megatrends)
 Firmware Arch: x64
   Secure Boot: enabled (user)
  TPM2 Support: yes
  Measured UKI: yes
  Boot into FW: supported
</code></pre>
<hr />
<h3>Creating a readonly snapshot of your root subvolume:</h3>
<ul>
<li><a href="https://wiki.archlinux.org/title/System_backup">Arch Wiki System Backup</a></li>
</ul>
<details>
<summary> ‚úîÔ∏è Click to Expand snapshot & Backup Example </summary>
<ol>
<li>Create readonly snapshot of root subvol:</li>
</ol>
<pre><code class="language-bash">sudo btrfs subvolume snapshot -r / /root-snapshot-$(date +%Y%m%d%H%M%S)
</code></pre>
<ol start="2">
<li>Mount your external backup disk:</li>
</ol>
<pre><code class="language-bash">sudo mkdir -p /mnt/backup
sudo mount /dev/sdc1 /mnt/backup
</code></pre>
<ol start="3">
<li>Use rsync to copy the snapshot to the external drive:</li>
</ol>
<p>List the available snapshots and get the exact name:</p>
<pre><code class="language-bash">sudo btrfs subvolume list /
</code></pre>
<pre><code class="language-bash">sudo rsync -aAXv --delete --progress /root-snapshot-20251002135000/ /mnt/backup/root-backup/
</code></pre>
<ol start="4">
<li>Unmount the external drive:</li>
</ol>
<pre><code class="language-bash">sudo umount /mnt/backup
</code></pre>
<ol start="5">
<li>Optionally, delete older snapshots to save space:</li>
</ol>
<pre><code class="language-bash">sudo btrfs subvolume delete /root-snapshot-OLD_TIMESTAMP
</code></pre>
<h3>Restoring from a Backup</h3>
<p>For this, you mount the partitions but don‚Äôt need to <code>arch-chroot</code> in.</p>
<ol>
<li>
<p>Boot from a live USB</p>
</li>
<li>
<p>Mount your encrypted root partition (unlock if encrypted) and the external
backup drive.</p>
</li>
<li>
<p>Move or delete the corrupted data on the root partition.</p>
</li>
<li>
<p>Use rsync to copy the backed-up snapshot from the external disk back to the
root partition, preserving permissions and attributes.</p>
</li>
</ol>
<pre><code class="language-bash">sudo rsync -aAXv --delete /mnt/backup/root-backup/ /
</code></pre>
<p>Or, the Wiki‚Äôs suggestion, (Much more efficient, Direct backup of a running
system without the need for btrfs snapshots):</p>
<pre><code class="language-bash">sudo rsync -aAXHv --exclude='/dev/*' --exclude='/proc/*' --exclude='/sys/*' --exclude='/tmp/*' --exclude='/run/*' --exclude='/mnt/*' --exclude='/media/*' --exclude='/lost+found/' / /path/to/backup
</code></pre>
<ul>
<li>
<p><code>/mnt/backup/root-backup/</code> is the path where the backup snapshot is mounted on
the external disk.</p>
</li>
<li>
<p><code>/</code> is the root partition mount point where you want to restore the files.</p>
</li>
<li>
<p>The options:</p>
<ul>
<li>
<p><code>-a</code> archive mode to preserve symbolic links, permissions, timestamps, etc.</p>
</li>
<li>
<p><code>-A</code> preserve ACLs (access control lists).</p>
</li>
<li>
<p><code>-X</code> preserve extended attributes.</p>
</li>
<li>
<p><code>-v</code> verbose output.</p>
</li>
<li>
<p><code>--delete</code> deletes files on the destination that don‚Äôt exist in the source,
keeping an exact mirror.</p>
</li>
</ul>
</li>
</ul>
<p>If you want to restore a specific snapshot directory (e.g.,
<code>/root-snapshot-20251002135000</code>), replace the source path accordingly, like:</p>
<pre><code class="language-bash">sudo rsync -aAXv --delete /mnt/backup/root-snapshot-20251002135000/ /
</code></pre>
<ul>
<li><a href="https://wiki.archlinux.org/title/Rsync#As_a_backup_utility">Arch Wiki rsync</a></li>
</ul>
<ol start="5">
<li>
<p>Reinstall the bootloader if necessary.</p>
</li>
<li>
<p>Unmount everything and reboot.</p>
</li>
</ol>
<h3>Automated backup</h3>
<p>Create <code>/etc/cron.daily/backup</code>:</p>
<pre><code class="language-backup">#!/bin/sh
rsync -a --delete --quiet /path/to/backup /location/of/backup
</code></pre>
<p>Change <code>/path/to/backup</code> to what needs to be backed-up such as <code>/home</code> or <code>/</code></p>
</details>
<hr />
<h3>arch-chroot</h3>
<details>
<summary>  ‚úîÔ∏è Click to Expand `arch-chroot` Example </summary>
<p>Say you forgot something, like forgetting to add a user and password. You reboot
and go to TTY into your system and are hit with a AHHH I can‚Äôt log in WTF!</p>
<p>It‚Äôs as easy as repeating some of the steps above. Reboot into the Live
environment, remount your partitions and <code>arch-chroot</code> back in:</p>
<p>Open the encrypted root partition:</p>
<pre><code class="language-bash">cryptsetup open /dev/nvme0n1p2 cryptroot
</code></pre>
<p>Mount the decrypted root:</p>
<pre><code class="language-bash">mount /dev/mapper/cryptroot /mnt
</code></pre>
<p>Mount the EFI partition:</p>
<pre><code class="language-bash">mount /dev/nvme0n1p1 /mnt/boot
</code></pre>
<p>Chroot into your installed system:</p>
<pre><code class="language-bash">arch-chroot /mnt
</code></pre>
<pre><code class="language-bash">useradd -m -G wheel -s /bin/bash yourusername passwd yourusername
</code></pre>
<ul>
<li>The <code>-s /bin/bash</code> sets your default shell, you can use zsh if you have it
installed.</li>
</ul>
<p>Uncomment the line <code>%wheel ALL=(ALL:All) ALL</code> in <code>/etc/sudoers</code></p>
<p>Exit chroot:</p>
<pre><code class="language-bash">exit
</code></pre>
<p>Unmount and close LUKS:</p>
<pre><code class="language-bash">umount /mnt/boot
umount /mnt
cryptsetup close cryptroot
reboot
</code></pre>
</details>
<h3>Resources</h3>
<details>
<summary> ‚úîÔ∏è Click to Expand Resources </summary>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/Installation_guide">Arch Wiki Installation Guide</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot">Arch Wiki UKI/SecureBoot</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/Unified_kernel_image">Wiki UKI</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/Systemd-boot">Wiki systemd-boot</a></p>
</li>
</ul>
</details>
]]></description><author>saylesss88</author><guid>https://saylesss88.github.io/privacy-book/arch/enc_install.html</guid><pubDate>Fri, 28 Nov 2025 00:00:00 +0000</pubDate></item><item><title>Hardening Firefox</title><link>https://saylesss88.github.io/privacy-book/arch/hardening_firefox.html</link><description><![CDATA[<h1>Hardening Firefox on Arch</h1>
<details>
<summary> ‚úîÔ∏è Click to Expand Table of Contents</summary>
<!-- toc -->
</details>
<h2>üîë Key Terms</h2>
<ul>
<li>
<p><strong>Browser hardening</strong> focuses on reducing attack surface and blocking tracking
by disabling or restricting features like JavaScript, cookies, telemetry, and
third-party scripts.</p>
</li>
<li>
<p><strong>Fingerprint protection</strong>, on the other hand, aims to make your browser
indistinguishable from others. Instead of just blocking data collection, it
ensures that your browser‚Äôs configuration; screen size, fonts, user agent,
etc. matches a large group of users, so you blend in.</p>
</li>
<li>
<p><strong>Browser compartmentalization</strong> is a technique where different browsers are
dedicated to distinct online activities to isolate cookies, trackers, and
browsing data. For example, Mullvad Browser can be used solely for activities
where fingerprinting resistance is critical, such as anonymous browsing or
visiting privacy-sensitive sites. Meanwhile, a hardened LibreWolf or Firefox
can be used for general browsing, email, or banking where you want solid
security and feature flexibility but aren‚Äôt as concerned about fingerprint
uniqueness.</p>
</li>
<li>
<p><strong>Web APIs</strong>: are sets of rules and protocols that allow browsers or servers
to communicate and share data or functions over the internet. It lets
developers access features or data of a web service or application without
exposing the underlying system details, enabling different software to
interact smoothly and securely.</p>
</li>
<li>
<p><strong>Anonymity</strong>: Maximizing anonymity often means restricting or masking
features (setting a generic fingerprint, disabling browser APIs, blocking
trackers) so the browser blends in with many others. This reduces uniqueness
but can break website functionality, cause CAPTCHAs, and limit usability.</p>
</li>
<li>
<p><strong>Usability</strong>: Keeping your browser features enabled improves compatibility
and user experience but increase uniqueness and thus make you easier to track.</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Entropy_(computing)">Entropy</a>: in this
context, is a measure of how much unique information a specific browser
feature contributes to your fingerprint. It‚Äôs often quantified in <strong>bits of
entropy</strong>, where higher bits mean more uniqueness (i.e., easier to identify
you).</p>
<ul>
<li>A ‚Äúbit‚Äù is a basic unit of information for computers. Entropy measuring
sites results are measured in ‚Äúbits of identifying information‚Äù.</li>
</ul>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Glossary/Origin">Origin</a>: Web
content‚Äôs <em>origin</em> is defined by the <em>scheme</em> (protocol), <em>hostname</em> (domain),
and port of the URL used to access it. Two objects have the same origin only
when the scheme, hostname, and port all match.</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same-origin policy</a>:
is a critical security mechanism that restricts how a document or script
loaded by one origin can interact with a resource from another origin. It
helps isolate potentially malicious documents, reducing possible attack
vectors.</p>
</li>
<li>
<p><a href="https://blog.mozilla.org/security/2021/05/18/introducing-site-isolation-in-firefox/">Firefox Site-Isolation</a>.
Firefox does provide site-isolation as well.</p>
</li>
<li>
<p><a href="https://www.mozilla.org/en-US/security/advisories/mfsa2018-01/">Protection from side-channel attacks</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Insecure_passwords">MDN Insecure passwords</a></p>
<ul>
<li><a href="https://blog.mozilla.org/tanvi/2016/01/28/no-more-passwords-over-http-please/">Risks of reused passwords</a></li>
</ul>
</li>
</ul>
<blockquote>
<p>Tor Browser is <strong>not</strong> the most secure browser, anonymity, and security can
often be at odds with each other. Having the exact same browser as many other
people isn‚Äôt the best security practice, but it is great for anonymity. Tor is
also based on Firefox Esr, which only receives patches for vulnerabilities
considered Critical or High which can be taken advantage of.</p>
</blockquote>
<h3>Fingerprinting Explained</h3>
<p>Modern Web APIs enable highly customized user experiences but also expose
detailed device information that attackers can exploit to create browser
fingerprints, unique identifiers used for covert tracking, even when cookies are
blocked.</p>
<p><strong>Entropy</strong>, a measure of randomness or uniqueness in data, is a critical metric
for assessing the risk of browser fingerprinting.</p>
<p>Browser fingerprinting is a tracking technique, often done by third-party
companies that specialize in it. They provide code (usually JavaScript) that a
website owner can embed on their site. When you visit the site, the script runs
in the background, silently collecting data about your device and browser.</p>
<p>There are two main approaches to obfuscating your fingerprint:</p>
<ul>
<li>
<p><strong>Standardization</strong>: Make browsers standardized and therefore have the same
fingerprint to blend into a crowd. This is what Tor and Mullvad Browser do.
Best for anonymity; increases the crowd you blend into, but may decrease
usability (site breakage, CAPTCHAs); adversaries may still find subtle
differences.</p>
</li>
<li>
<p><strong>Randomization</strong>: Randomize fingerprint metrics so it‚Äôs not directly linkable
to you. Brave has this feature, if you run coveryourtracks with Brave you will
get a result of ‚Äúyour browser has a randomized fingerprint‚Äù. This is good for
privacy but may be detectable by advanced scripts.</p>
</li>
</ul>
<p>Test your browsers fingerprint:</p>
<ul>
<li>
<p><a href="https://coveryourtracks.eff.org/">CoverYourTracks</a></p>
</li>
<li>
<p><a href="https://amiunique.org/">AmIUnique</a></p>
</li>
</ul>
<p>Test how well your browser implements security standards and features:</p>
<ul>
<li><a href="https://browseraudit.com">BrowserAudit</a></li>
</ul>
<p>Test the sites you visit for trackers:</p>
<ul>
<li><a href="https://themarkup.org/ask-the-markup/2020/09/22/i-scanned-the-websites-i-visit-with-blacklight-and-its-horrifying-now-what">Blacklight</a></li>
</ul>
<p>Don‚Äôt put too much weight into the results as people often check their
fingerprint, change one metric and check it again over and over skewing the
results. It is helpful for knowing the fingerprint values that trackers track.</p>
<ul>
<li>
<p><a href="https://forum.torproject.org/t/browser-fingerprinting/1228/25">Browser Fingerprinting Tor Forum</a></p>
</li>
<li>
<p><a href="https://madaidans-insecurities.github.io/browser-tracking.html">Madaidans Hot Take on Browser Tracking</a></p>
</li>
</ul>
<p>You can use something like <a href="https://noscript.net/">NoScript</a> to block
JavaScript, preventing the scripts from running that do most of the
fingerprinting. Extensions can make you more unique but it‚Äôs a give and take.</p>
<p>The following website lists the tracking protection mechanisms implemented by
the major browsers and browser engines:</p>
<ul>
<li><a href="https://www.cookiestatus.com/">Cookie Status</a></li>
</ul>
<hr />
<h2>Metasearch Engines</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Metasearch_engine">Wikipedia Metasearch engine</a></li>
</ul>
<h3>SearXNG</h3>
<p><strong>SearXNG</strong> an open-source, privacy-respecting metasearch engine that aggregates
results from various search services, such as Google, DuckDuckGo, etc without
tracking you or profiling your searches. You can add SearXNG to firefox by going
to <code>about:preferences#search</code> and at the bottom click <code>Add</code>, URL will be
<code>https://searx.be/search?q=%s</code>.</p>
<blockquote>
<p>‚ùóÔ∏è NOTE: The above searx is the default and doesn‚Äôt give many relevant
results. To get relevant results find a
<a href="https://searx.space/">public instance</a> with a good rating from your area and
add the <code>search?q=%s</code> to the end of it. For example, I‚Äôm using
<code>https://priv.au/search?q=%s</code>. This gives much better results than DDG in my
opinion.</p>
</blockquote>
<p>SearXNG is a bit different, you can choose which search engine you want for your
current search with <code>!ddg search term</code> to use duckduckgo for example.</p>
<ul>
<li><a href="https://github.com/searxng/searxng?tab=readme-ov-file">searxng repo</a>
<ul>
<li>
<p><a href="https://docs.searxng.org/admin/installation.html">Install guide</a></p>
</li>
<li>
<p><a href="https://docs.searxng.org/admin/settings/index.html">Configuration guide</a></p>
</li>
</ul>
</li>
</ul>
<hr />
<p><strong>Startpage</strong> is another metasearch engine that I‚Äôve heard good things about.</p>
<ul>
<li>
<p><a href="https://www.startpage.com/privacy-please/">Startpage Privacy Please!</a></p>
</li>
<li>
<p><a href="https://www.startpage.com/privacy-please/startpage-articles/easy-privacy-control-across-the-internet-introducing-startpage-privacy-protection">Startpage Privacy Protection</a></p>
</li>
</ul>
<hr />
<h2>Defenses</h2>
<h4>Encrypted DNS</h4>
<p>DNS (Domain Name System) resolution is the process of translating a website‚Äôs
domain name into its corresponding IP address. By default, this traffic isn‚Äôt
encrypted, which means anyone on the network, from your ISP to potential
hackers, can see the websites you‚Äôre trying to visit. <strong>Encrypted DNS</strong> uses
protocols to scramble this information, protecting your queries and responses
from being intercepted and viewed by others.</p>
<blockquote>
<p>‚ùó NOTE: There are many other ways for someone monitoring your traffic to see
what domain you looked up via DNS that it‚Äôs effectiveness is questionable
without also using Tor or a VPN. Encrypted DNS will not help you hide any of
your browsing activity.</p>
</blockquote>
<p>There are 3 main types of DNS protection:</p>
<ul>
<li>
<p><strong>DNS over HTTPS (DoH)</strong>: Uses the HTTPS protocol to encrypt data between the
client and the resolver.</p>
</li>
<li>
<p><strong>DNS over TLS (DoT)</strong>: Similar to (DoH), differs in the methods used for
encryption and delivery using a separate port from HTTPS.</p>
</li>
<li>
<p><strong>DNSCrypt</strong>: Uses end-to-end encryption with the added benefit of being able
to prevent DNS spoofing attacks.</p>
</li>
</ul>
<p>Useful resources:</p>
<details>
<summary> ‚úîÔ∏è Click to Expand DNS Resources </summary>
<ul>
<li>
<p><a href="https://www.cloudflare.com/learning/dns/what-is-dns/">Domain Name System (DNS)</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/DNS_over_HTTPS">Wikipedia DNS over HTTPS (DoH)</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/DNS_over_TLS">Wikipedia DNS over TLS (DoT)</a></p>
</li>
<li>
<p><a href="https://blog.cloudflare.com/dns-encryption-explained/">Cloudflare Dns Encryption Explained</a></p>
</li>
<li>
<p><a href="https://nordvpn.com/blog/encrypted-dns-traffic/">NordVPN Encrypted Dns Traffic</a></p>
</li>
</ul>
<p><strong>Hot Take</strong>:</p>
<ul>
<li><a href="https://madaidans-insecurities.github.io/encrypted-dns.html">Encrypted DNS is ineffective without a VPN or Tor by madaidan</a></li>
</ul>
</details>
<p>I recommend either setting up dnscrypt-proxy:</p>
<ul>
<li><a href="https://mako088.github.io/arch/enc_dns.html">dnscrypt-proxy on Arch</a></li>
</ul>
<p>Or set Firefox‚Äôs DNS over HTTPS to Max protection with a custom resolver:</p>
<p>In <code>about:preferences#privacy</code> scroll down to <code>DNS over HTTPS</code>, Select
<code>Max Protection</code> -&gt; <code>Custom</code> -&gt; <code>https://dns.quad9.net/dns-query</code></p>
<hr />
<h4>Enhanced Tracking Protection (ETP)</h4>
<p>Browsers that have a form of tracking protection typically use lists of known
trackers and match each outgoing request against these lists.</p>
<p>Enhanced Tracking Protection is how you deal with cookies and more on Firefox.</p>
<ul>
<li>
<p><a href="https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop">Enhanced Tracking Protection (ETP)</a>
blocks known ‚Äúthird-party requests‚Äù to companies that participate in
fingerprinting, according to the
<a href="https://disconnect.me/trackerprotection">Disconnect List</a></p>
<ul>
<li>
<p>In <code>about:preferences#privacy</code>, setting Enhanced Tracking Protection to
either Strict or Custom enables FPP as well, explained further down.</p>
</li>
<li>
<p><a href="https://blog.mozilla.org/mozilla/firefox-rolls-out-total-cookie-protection-by-default-to-all-users-worldwide/">Total Cookie Protection</a>
is enabled by default in Standard mode.</p>
</li>
<li>
<p>When you set ETP to Strict, it includes
<a href="https://blog.mozilla.org/security/2021/08/10/firefox-91-introduces-enhanced-cookie-clearing/">Enhanced Cookie Clearing</a>,
which improves on the removal of third-party cookies, as well as Bounce
Tracking Protection that prevents redirect trackers.</p>
</li>
</ul>
</li>
<li>
<p><a href="https://wiki.mozilla.org/Security/FirstPartyIsolation">First-Party Isolation</a>
From the Tor Uplift Project.</p>
</li>
</ul>
<h3>Resist Fingerprinting</h3>
<ul>
<li>
<p><a href="https://wiki.mozilla.org/Security/Fingerprinting">Fingerprinting</a></p>
</li>
<li>
<p>RFP (Resist Fingerprinting) set in <code>about:config</code> with
<code>privacy.resistFingerprinting</code>. Resist Fingerprinting alters the following:</p>
<ul>
<li>
<p>The timezone is reported as UTC or Icelandic</p>
</li>
<li>
<p>Locale is reported as en-US</p>
</li>
<li>
<p>Several properties of the navigator object are fixed, including the hardware
concurrency value, application version and build ID. The User Agent version
is reported to be the major version (for example, 119.0 instead of 119.1)</p>
<ul>
<li>And much more‚Ä¶</li>
</ul>
</li>
<li>
<p>You can set <code>privacy.resistFingerprinting.pbMode</code> (private-browsing) without
<code>privacy.resistFingerprinting</code> and still get certain Resist Fingerprinting
behaviors on normal windows, because it‚Äôs impossible to separate these
behaviors per-window.</p>
</li>
</ul>
</li>
<li>
<p>FPP (Fingerprinting Protection) is enabled in normal browsing when Enhanced
Tracking Protection is set to Strict. Both Known Fingerprinters and Suspected
Fingerprinters Protection are enabled in Private Browsing and when ETP is set
to strict. On the Custom level of ETP you can toggle on/off different
features.</p>
</li>
</ul>
<hr />
<h2>Disable JavaScript</h2>
<p>Most trackers run on JavaScript, thus blocking JavaScript prevents them from
gathering much of the info needed to form a browser fingerprint.</p>
<ul>
<li>
<p><a href="https://noscript.net/">NoScript</a> lets you selectively block scripts on
websites. Its core function is to block all scripts by default on websites,
allowing you to manually enable scripts on trusted sites.</p>
<p><a href="https://blog.jeaye.com/2017/11/30/noscript/">NoScript PrivacyGuides</a> should</p>
</li>
<li>
<p><a href="https://ublockorigin.com/">uBlock Origin</a> also lets you block JavaScript,
just be aware that many sites may break so you‚Äôll have to whitelist
selectively.</p>
</li>
</ul>
<h2>Disable WebRTC</h2>
<p>The main reason people disable WebRTC is to prevent an IP address leak. WebRTC
is designed for real-time communication like video calls and file sharing. If
you don‚Äôt use those features, it makes sense to disable it.</p>
<p>Disabling WebRTC eliminates specific data points that trackers use, reducing
entropy &amp; the uniqueness of your fingerprint.</p>
<p>In <code>about:preferences#privacy</code> -&gt; <code>Privacy &amp; Security</code> -&gt; <code>Permissions</code>. Click
<code>Settings</code>.</p>
<ul>
<li>
<p><input disabled="" type="checkbox" checked=""/>
Block new requests asking to access your microphone</p>
</li>
<li>
<p><input disabled="" type="checkbox" checked=""/>
Block new requests asking to access your camera</p>
</li>
<li>
<p>You may also want to block Location, but that isn‚Äôt involving WebRTC.</p>
</li>
</ul>
<p>You can also use the master switch by going to <code>about:config</code> and setting
<code>media.peerconnection.enabled</code> to <code>false</code></p>
<p><code>user.js</code> settings related to WebRTC:</p>
<pre><code class="language-js">/* 2002: force WebRTC inside the proxy [FF70+] ***/
user_pref("media.peerconnection.ice.proxy_only_if_behind_proxy", true);
 * When using a system-wide proxy, it uses the proxy interface
 * [1] https://developer.mozilla.org/docs/Web/API/RTCIceCandidate
 * [2] https://wiki.mozilla.org/Media/WebRTC/Privacy ***/
user_pref("media.peerconnection.ice.default_address_only", true);
user_pref("media.peerconnection.enabled", false);
user_pref("media.peerconnection.ice.obfuscate_host_address", true);
/* 2004: force exclusion of private IPs from ICE candidates [FF51+]
 * [SETUP-HARDEN] This will protect your private IP even in TRUSTED scenarios after you
 * grant device access, but often results in breakage on video-conferencing platforms ***/
user_pref("media.peerconnection.ice.no_host", true);
</code></pre>
<hr />
<h2>Disable Canvas Fingerprinting</h2>
<p>Canvas Fingerprinting uses the HTML5 <code>&lt;canvas&gt;</code> element to generate a
fingerprint. It gets your device to render an image or text on a canvas and then
reads the pixel data. Since devices render things differently, those differences
are identifiable.</p>
<p>When the pref <code>privacy.resistFingerprinting</code> is set to <code>true</code>, restricts APIs
commonly used for fingerprinting, including the HTML5 Canvas API. When enabled,
it returns a randomized or generic canvas output to prevent unique
identification.</p>
<hr />
<h2>Disable WebGL</h2>
<p>Similar to canvas fingerprinting, this technique uses the WebGL API to render 2D
and 3D graphics. The way your system renders these graphics provides information
about your GPU and graphics drivers, which contributes to your unique
fingerprint.</p>
<blockquote>
<p>‚ùóÔ∏è NOTE: It‚Äôs unnecessary to disable webgl if you‚Äôre already using RFP and
will likely make you stand out more because most people don‚Äôt disable it.</p>
</blockquote>
<p>It can be disabled in <code>about:config</code> by setting <code>webgl.disabled</code> to <code>true</code>.</p>
<hr />
<h2>Install Firefox/LibreWolf &amp; ArkenFox</h2>
<blockquote>
<p>‚ö†Ô∏è Firefox offers excellent privacy and customization but falls behind
Chromium-based browsers in isolation and patch timing. Compartmentalization
can help balance strong privacy with optimal security by using Brave or
Chromium for high-risk browsing alongside Firefox for general and
privacy-focused tasks.</p>
</blockquote>
<p>Download Firefox from the
<a href="https://ftp.mozilla.org/pub/firefox/releases/">Mozilla FTP site</a> if you are
worried about the download token, the FTP site lets you download the version you
want without a token.</p>
<p>For example, for the latest firefox as of 09-30-25 for the US:</p>
<p><code>https://download.mozilla.org/?product=firefox-latest&amp;os=linux64&amp;lang=en-US</code></p>
<p><strong>LibreWolf</strong> is an open-source fork of Firefox with a strong focus on privacy,
security, and user freedom. LibreWolf enables always HTTPS, includes
uBlockOrigin, and more providing strong defaults.</p>
<details>
<summary> ‚úîÔ∏è Click to Expand Arkenfox How To </summary>
<p>The process is the same for both Firefox &amp; LibreWolf. I like LibreWolf for it‚Äôs
strong defaults but may lag behind Firefox getting security patches.</p>
<pre><code class="language-bash">paru -S librewolf-bin
</code></pre>
<p>Read the <a href="https://github.com/arkenfox/user.js/wiki">ArkenFox Wiki</a></p>
<h2>Apply</h2>
<p>Open <code>about:support</code> and look for <code>Profile Directory</code> under <code>Application Basics</code>
Select <code>Open Directory</code>, it will bring you to somewhere like
<code>~/.librewolf/pefoo8xx.default-default/</code> and that is where you place the
<code>user.js</code>.</p>
<p>Place the following files in your <code>Profile Directory</code>:</p>
<ol>
<li>
<p><a href="https://github.com/arkenfox/user.js/blob/master/user.js">Arkenfox user.js</a>
Read through the <code>user.js</code>, not all settings are applied by default such as
RFP Fingerprinting protection.</p>
</li>
<li>
<p><a href="https://github.com/arkenfox/user.js/blob/master/updater.sh">updater.sh</a></p>
</li>
<li>
<p><a href="https://github.com/arkenfox/user.js/blob/master/prefsCleaner.sh">prefsCleaner.sh</a></p>
</li>
<li>
<p>Also create your own <code>user-overrides.js</code> with any changes you want to make to
the default <code>user.js</code>. These changes are amended to the <code>user.js</code> and applied
last enabling them to override the default settings. It‚Äôs best to make
changes here so that updating the Arkenfox <code>user.js</code> doesn‚Äôt make you lose
all of your customizations.</p>
</li>
</ol>
<p>Example <code>user-overrides.js</code> spoofing the user agent:</p>
<blockquote>
<p>‚ùóÔ∏è This is just an example, always check for common useragent strings
yourself. Read the Arkenfox Wiki!</p>
</blockquote>
<pre><code class="language-js">&lt;!-- user_pref( --&gt;
  &lt;!-- "general.useragent.override", --&gt;
  &lt;!-- "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36", --&gt;
&lt;!-- ); --&gt;
// Disable Activity Stream on new windows and tab pages
user_pref("browser.newtab.preload", false);
// Enhanced Tracking Protection (ETP)
user_pref("privacy.bounceTrackingProtection.mode", 1); // [FF131+] [ETP FF133+]
user_pref("privacy.trackingprotection.enabled", true);
// Resist Fingerprinting (RFP)
user_pref("privacy.resistFingerprinting", true); // [FF41+]
user_pref("privacy.resistFingerprinting.pbmode", true); // [FF114+]
// WebRTC
user_pref("media.peerconnection.enabled", false);
user_pref("media.peerconnection.ice.default_address_only", true);
// WebGL
user_pref("webgl.disabled", true);
// Geolocation
user_pref("geo.enabled", false);
user_pref("full-screen-api.enabled", false);
user_pref(
  "geo.provider.network.url",
  "https://location.services.mozilla.com/v1/geolocate?key=%MOZILLA_API_KEY%",
);
// Disable studies
user_pref("app.sheild.optoutstudies.enabled", false);
// Master Switches, Be Careful
user_pref("browser.safebrowsing.malware.enabled", false);
user_pref("browser.safebrowsing.phishing.enabled", false);
user_pref("browser.safebrowsing.provider.google4.gethashURL", "");
user_pref("browser.safebrowsing.provider.google4.updateURL", "");
user_pref("browser.safebrowsing.provider.google.gethashURL", "");
user_pref("browser.safebrowsing.provider.google.updateURL", "");
user_pref("browser.safebrowsing.provider.google4.dataSharingURL", "");
user_pref("signon.rememberSignons", false);
user_pref("browser.xul.error_pages.expert_bad_cert", true);
//* [NOTE] Will cause breakage: older modems/routers and some sites e.g banks, vimeo, icloud, instagram ***/
user_pref("network.http.referer.XOriginPolicy", 2);
user_pref("network.http.sendRefererHeader", 1);
// 0 is most strict:
user_pref("network.http.referer.trimmingPolicy", 0);
user_pref("network.http.referer.XOriginTrimmingPolicy", 2);
</code></pre>
<p>To apply your prefs you have to run the <code>updater.sh</code> script.</p>
<pre><code class="language-bash">~/.mozilla/firefox/v5kwl3c0.default-release&gt; ./updater.sh

                ############################################################################
                ####                                                                    ####
                ####                          arkenfox user.js                          ####
                ####       Hardening the Privacy and Security Settings of Firefox       ####
                ####           Maintained by @Thorin-Oakenpants and @earthlng           ####
                ####            Updater for macOS and Linux by @overdodactyl            ####
                ####                                                                    ####
                ############################################################################


Documentation for this script is available here: https://github.com/arkenfox/user.js/wiki/5.1-Updater-[Options]#-maclinux

Please observe the following information:
    Firefox profile:  /home/jr/.mozilla/firefox/v5kwl3c0.default-release
    Available online: * version: 140
    Currently using:  * version: 140


This script will update to the latest user.js file and append any custom configurations from user-overrides.js. Continue Y/N?
y

Status: user.js has been backed up and replaced with the latest version!
Status: Override file appended: user-overrides.js
</code></pre>
<h2>Check</h2>
<p>Launch LibreWolf or Firefox and press <code>Ctrl-Shift-J</code> to launch Browser Console
Mode, and look for any errors.</p>
<p>Go to <code>about:config</code> -&gt; [x] <code>Show only modified preferences</code>. You should see
<code>SUCCESS: No no he's not dead, he's, he's restin'!</code></p>
</details>
<h3>User Agent Spoofing</h3>
<blockquote>
<p>‚ùóÔ∏è NOTE: Spoofing your useragent alone likely isn‚Äôt worth the protections you
lose from disabling <code>resistFingerprinting</code>. <code>resistFingerprinting</code> spoofs many
different fingerprinting aspects. If you don‚Äôt get it right, you will get
captcha requests constantly.</p>
</blockquote>
<p>Research what the most common user agent is. You‚Äôll need to disable
<code>privacy.resistFingerprinting</code> for this to work.</p>
<p>Place the user agent string in <code>general.useragent.override</code> something like:
<code>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36</code>
<a href="https://www.whatsmyuseragent.com">https://www.whatsmyuseragent.com</a></p>
<p><a href="https://www.useragentstring.com">https://www.useragentstring.com</a></p>
<hr />
<h2>uBlock Origin</h2>
<p>BetterFox does a great job explaining how to use uBlock with solid
recommendations.</p>
<ul>
<li><a href="https://github.com/yokoffing/filterlists?tab=readme-ov-file#guidelines">BetterFox uBlock filterlists</a></li>
</ul>
<p>If you wanted to apply the
<a href="https://github.com/yokoffing/filterlists/blob/main/privacy_essentials.txt">Privacy Essentials</a>
list you would click
<a href="https://subscribe.adblockplus.org/?location=https://raw.githubusercontent.com/yokoffing/filterlists/main/privacy_essentials.txt&amp;title=Privacy%20Essentials">subscribe</a>,
which launches the uBlock asset viewer where you can see all of the domains that
will be blocked before clicking <code>Subscribe</code> again to apply them.</p>
<h3>Adding other lists</h3>
<ul>
<li>
<p><a href="https://github.com/hagezi/dns-blocklists">Hagezi dns-blocklists</a></p>
</li>
<li>
<p><a href="https://github.com/ppfeufer/adguard-filter-list">adguard-filter-list</a></p>
</li>
</ul>
<p>Click the uBlock logo, Settings, Filter lists, scroll to the bottom and choose
Import‚Ä¶, Paste the url of your chosen list, and click Apply changes.</p>
<p>For example, Arkenfox suggests adding the Actually Legitimate URL Shortener
Tool. Add
<a href="https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt">https://raw.githubusercontent.com/DandelionSprout/adfilt/master/LegitimateURLShortener.txt</a>
to the Import‚Ä¶ section and click Apply changes. If you scroll up, you‚Äôll see
that it was added and chosen.</p>
<p>Setup your <a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode">Blocking mode</a></p>
<p>Many opt for
<a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode:-medium-mode">medium mode</a>.
To do so you need to:</p>
<p><strong>Settings pane</strong>:</p>
<ul>
<li>Open the dashboard, and choose I am an advanced user.</li>
</ul>
<p><strong>Filter lists pane</strong>:</p>
<ul>
<li>
<p>All of uBO‚Äôs filter lists: checked</p>
</li>
<li>
<p>EasyList: checked</p>
</li>
<li>
<p>Peter Lowe‚Äôs Ad server list: checked</p>
</li>
<li>
<p>EasyPrivacy: checked</p>
</li>
<li>
<p>Online Malicious URL Blocklist: checked</p>
</li>
</ul>
<p><strong>My rules pane (4th pane from the left)</strong>:</p>
<p>Underneath Temporary rules add, you literally type this in:</p>
<ul>
<li>
<p>Add <code>* * 3p-script block</code></p>
</li>
<li>
<p>Add <code>* * 3p-frame block</code></p>
</li>
<li>
<p>Click <code>Save</code></p>
</li>
<li>
<p>Click <code>&lt;- Commit</code> (Not required on phone)</p>
</li>
</ul>
<p><strong>Fallback to
<a href="https://github.com/gorhill/uBlock/wiki/Blocking-mode:-easy-mode">easy mode</a></strong></p>
<p>Click the uBlock logo while on the site you want to use easy mode on. You‚Äôll see
the power button to the top right, the Global rules and the Local rules which
start 3 boxes from the left. Click the box under the Local rules for 3rd-party
scripts. The box will change colors, dark gray = NOOP (No Operation). This tells
uBO to ignore the aggressive global block for this site, and let the normal
filter lists handle the blocking.</p>
<p>You can also disable JavaScript in My rules as needed.</p>
<hr />
<h2>Set up a SOCKS5 Proxy with Arti</h2>
<blockquote>
<p>‚ùóÔ∏è NOTE: This is one example of using a SOCKS5 proxy to circumvent censorship
or add additional privacy without the Tor Browser. You can also route other
apps through the proxy, such as email clients, messaging apps, torrent
clients, and more.</p>
</blockquote>
<ol>
<li>Clone the arti repo:</li>
</ol>
<pre><code class="language-bash"># clone the repo
git clone https://gitlab.torproject.org/tpo/core/arti.git

# navigate to the directory
cd arti
</code></pre>
<hr />
<ol start="2">
<li>To build the Arti binary, compile the code and generate the executable run:</li>
</ol>
<p>These are the safer build options so you can leave the arti repo in your home
directory without it leaking your username:</p>
<pre><code class="language-bash">RUSTFLAGS="--remap-path-prefix $HOME/.cargo=.cargo --remap-path-prefix $(pwd)=." \
   cargo build --release -p arti
</code></pre>
<hr />
<ol start="3">
<li>To allow Arti SOCKS proxy traffic you need to add a rule permitting incoming
connections to port 9150.</li>
</ol>
<p>For nftables, you would open <code>/etc/nftables.conf</code> and add:</p>
<pre><code class="language-conf">chain input {
  # ...snip...

  # Allow Arti SOCKS proxy (port 9150)
    tcp dport 9150 ct state new accept

  # ...snip...
}
</code></pre>
<p>Enable it with <code>sudo nft -f /etc/nftables.conf</code></p>
<hr />
<ol start="4">
<li>To run Arti as a SOCKS proxy on port <code>9150</code>, execute:</li>
</ol>
<pre><code class="language-bash">./target/release/arti proxy
</code></pre>
<hr />
<ol start="5">
<li>Configure LibreWolf/Firefox to use the Arti proxy:</li>
</ol>
<p>Open LibreWolf or Firefox</p>
<p>Go to the menu and open <code>Preferences/Settings</code>.</p>
<p>Scroll to the bottom <code>Network Settings</code> section.</p>
<p>Click on ‚Äú<code>Settings...</code>‚Äù under Network Settings.</p>
<p>In the connection settings dialog:</p>
<p>Select ‚Äú<code>Manual proxy configuration</code>‚Äù.</p>
<p>For ‚ÄúSOCKS Host‚Äù, enter <code>127.0.0.1</code>.</p>
<p>For the port next to SOCKS Host, enter <code>9150</code>.</p>
<p>Select the SOCKS version 5 option (<code>SOCKS v5</code>).</p>
<p>Optionally check the box ‚Äú<code>Proxy DNS when using SOCKS v5</code>‚Äù to route DNS queries
through the proxy for enhanced privacy.</p>
<p>Click ‚Äú<code>OK</code>‚Äù to apply the settings.</p>
<hr />
<ol start="6">
<li>Verify Your Proxy Setup Open a new tab and visit <code>https://dnsleaktest.com</code>
and run an <code>Extended Test</code>.</li>
</ol>
<p>Your IP address should now appear as a Tor exit node IP, indicating your traffic
is routed through the Arti proxy.</p>
<ul>
<li>
<p>Make sure Arti is running in its terminal or background before you start
browsing.</p>
</li>
<li>
<p>If you close the terminal or stop Arti, your browser will lose the proxy
connection.</p>
</li>
</ul>
<p>This setup only proxies the configured browser traffic; other apps are not
affected unless configured similarly.</p>
<p>This setup turns LibreWolf or Firefox into a Tor-enabled browser without
installing the Tor Browser Bundle, using the Arti SOCKS proxy instead. It can be
useful if you want to use a more customizable or alternative browser while still
accessing the Tor network securely.</p>
<blockquote>
<p>‚ö†Ô∏è While using LibreWolf with the Arti SOCKS5 proxy provides network-level
anonymity by routing traffic through the Tor network, it does not include the
extensive browser-level privacy and security enhancements found in the
official Tor Browser. For casual or moderate privacy needs the SOCKS proxy can
be useful but for stronger anonymity guarantees and protection, the Tor
Browser is recommended.</p>
</blockquote>
<h2>Setup an Arti service to run in the background</h2>
<blockquote>
<p>Be careful here, its not as easy to tell if Arti failed for some reason.</p>
</blockquote>
<p>Create a service file at <code>/etc/systemd/system/arti.service</code>:</p>
<p>Replace <code>your-username</code> with your username</p>
<pre><code class="language-.service">[Unit]
Description=Arti Tor Proxy Service
After=network.target

[Service]
ExecStart=/home/your-username/arti/target/release/arti proxy
Restart=on-failure
User=jr
Group=jr
WorkingDirectory=/home/your-username/arti
Environment=RUSTFLAGS="--remap-path-prefix $HOME/.cargo=.cargo --remap-path-prefix $(pwd)=."

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Enable &amp; Start the service:</p>
<pre><code class="language-bash">sudo systemctl enable arti
sudo systemctl start arti --now
</code></pre>
<p>Ensure its running:</p>
<pre><code class="language-bash">sudo systemctl status arti
</code></pre>
<hr />
<details>
<summary> ‚úîÔ∏è Click to Expand Resources </summary>
<ul>
<li>
<p><a href="https://docs.searxng.org/">Welcome to SearXNG</a></p>
</li>
<li>
<p><a href="https://brainfucksec.github.io/firefox-hardening-guide">Firefox Hardening Guide</a></p>
</li>
<li>
<p><a href="https://www.ghacks.net/2015/08/18/a-comprehensive-list-of-firefox-privacy-and-security-settings/">Firefox ghacks</a></p>
</li>
<li>
<p><a href="https://github.com/arkenfox/user.js">ArkenFox user.js</a> Just right IMO.</p>
</li>
<li>
<p><a href="https://github.com/yokoffing/Betterfox">BetterFox user.js</a> Easiest to use
with less breakage.</p>
</li>
<li>
<p><a href="https://codeberg.org/Narsil/user.js/src/branch/main/desktop">Narsil user.js</a>
Most hardened.</p>
</li>
<li>
<p><a href="https://www.privacytools.io/private-browser">PrivacyTools.io</a></p>
</li>
<li>
<p><a href="https://privacytests.org/">PrivacyTests.org</a></p>
</li>
<li>
<p><a href="https://github.com/simeononsecurity/FireFox-Privacy-Script">simeononsecurity Firefox-Privacy-Script</a></p>
</li>
<li>
<p><a href="https://anhkhoakz.neocities.org/blog/browsers-for-daily-using/#firefox-but-hardened">Browsers for Daily Using</a></p>
</li>
<li>
<p><a href="https://brainfucksec.github.io/firefox-hardening-guide">brianfucksec firefox-hardening-Guide 2023</a></p>
</li>
<li>
<p><a href="https://simeononsecurity.com/guides/enhance-firefox-security-configuring-guide/">STIG Firefox Hardening</a></p>
</li>
</ul>
<blockquote>
<p>If you should trust the U.S. Governments recommendations is another story but
it can be good to compare and contrast with other trusted resources. You‚Äôll
have to think whether the CISA recommending that everyone uses Signal is solid
advice or guiding you towards a honeypot, I can‚Äôt say for sure.</p>
</blockquote>
<ul>
<li>
<p><a href="https://stigviewer.com/stigs/mozilla_firefox">Mozilla Firefox Security Technical Implementation Guide</a>
The STIG for Mozilla Firefox (Security Technical Implementation Guide) is a
set of security configuration standards developed by the U.S. Department of
Defense. They are created by the Defense Information Systems Agency (DISA) to
secure and harden DoD information systems and software.</p>
</li>
<li>
<p><a href="https://thenewoil.org/en/guides/prologue/why/">Privacy, The New Oil (Why Privacy &amp; Security Matter)</a></p>
</li>
<li>
<p><a href="https://www.privacyguides.org/en/">PrivacyGuides</a></p>
</li>
<li>
<p><a href="https://relay.firefox.com/accounts/profile/">Firefox Relay</a> can be used to
create email aliases that forward to your real email address. The paid plan
also lets you create phone number aliases that forward to your phone number.</p>
</li>
<li>
<p><a href="https://zebracrossing.narwhalacademy.org/">Zebra Crossing digital safety checklist</a></p>
</li>
<li>
<p><a href="https://datadetoxkit.org/en/privacy/essentials#step-1">DataDetoxKit</a></p>
</li>
<li>
<p><a href="https://datadetoxkit.org/en/privacy/degooglise/">DataDetox Degooglise</a></p>
</li>
<li>
<p><a href="https://tb-manual.torproject.org/">Tor Browser User Manual</a></p>
</li>
<li>
<p><a href="https://gitlab.torproject.org/tpo/team/-/wikis/home">Tor Wiki</a></p>
</li>
<li>
<p><a href="https://blog.torproject.org/">Tor Blog</a></p>
</li>
<li>
<p><a href="https://gitlab.torproject.org/tpo/core/arti/#why-rewrite-tor-in-rust">Arti why-rewrite-tor-in-rust</a></p>
</li>
<li>
<p><a href="https://wiki.mozilla.org/Security/Tor_Uplift/Tracking">The Tor Uplift Project</a></p>
</li>
<li>
<p><a href="https://www.browsercat.com/post/browser-fingerprint-spoofing-explained">BrowserCat Fingerprint Spoofing</a></p>
</li>
<li>
<p><a href="https://cyberinsider.com/firefox-privacy/">cyberinsider Firefox privacy 2025</a></p>
</li>
<li>
<p><a href="https://cyberinsider.com/browser-fingerprinting/">cyberinsider Browser Fingerprinting</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Privacy">Mozilla Web Docs Privacy on the web</a></p>
</li>
<li>
<p><a href="https://adguard-dns.io/en/blog/techtok-9-browser-extensions-and-firewall.html">Adguard Blog Browser Extensions and Firewalls explained</a></p>
</li>
<li>
<p><a href="https://searchfox.org/firefox-main/source/toolkit/components/resistfingerprinting/RFPTargetsDefault.inc">searchfox RFPTargetsDefault</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Entropy_(computing)">Wikipedia Entropy (computing)</a></p>
</li>
<li>
<p><a href="https://brave.com/blog/">Brave Blog</a></p>
</li>
</ul>
<p><strong>Cheatsheets</strong></p>
<ul>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html">HTTP Security Response Headers Cheat Sheet</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Zero_Trust_Architecture_Cheat_Sheet.html">Zero Trust Architecture Cheat Sheet</a></p>
</li>
<li>
<p><a href="https://we.riseup.net/riseup+tech/entropy">riseup entropy</a></p>
</li>
<li>
<p><a href="https://www.kicksecure.com/wiki/Dev/Entropy">kicksecure entropy</a></p>
</li>
<li>
<p><a href="https://riseup.net/en/security">riseup Digital Security</a></p>
</li>
</ul>
</details>
]]></description><author>saylesss88</author><guid>https://saylesss88.github.io/privacy-book/arch/hardening_firefox.html</guid><pubDate>Fri, 28 Nov 2025 00:00:00 +0000</pubDate></item><item><title>Hardening Arch</title><link>https://saylesss88.github.io/privacy-book/arch/hardening_arch.html</link><description><![CDATA[<h1>Hardening Arch Linux</h1>
<details>
<summary> ‚úîÔ∏è Click to Expand Table of Contents</summary>
<!-- toc -->
</details>
<blockquote>
<p>‚ö†Ô∏è Warning: I am not a security expert. This guide presents various options
for hardening Arch Linux, but it is your responsibility to evaluate whether
each adjustment suits your specific needs and environment. Security hardening
and process isolation can introduce stability challenges, compatibility
issues, or unexpected behavior. Additionally, these protections often come
with performance tradeoffs. Always conduct thorough research, there are no
plug and play one size fits all security solutions.</p>
</blockquote>
<blockquote>
<p>Much of this guide draws inspiration or recommendations from the well-known
<a href="https://madaidans-insecurities.github.io/guides/linux-hardening.html">Linux Hardening Guide</a>
by Madaidan‚Äôs Insecurities and the Arch Wiki. Arch is great but when anonymity
truly matters, use Whonix or Tails. The Whonix Docs have a specific section or
Arch with KVM that is an excellent resource.</p>
</blockquote>
<ul>
<li><a href="https://www.whonix.org/wiki/KVM#Arch_Linux">Whonix KVM#Arch_Linux</a>, if you
plan on using this think twice before enabling <code>dnscrypt-proxy</code> and you might
want to consider ufw firewall rather than the nftables I share in this guide
because of Port conflicts.</li>
</ul>
<p>Keep in mind that Arch‚Äôs security posture is ultimately constrained by the
broader limitations of Linux security mechanisms, upstream tooling, and ongoing
development priorities.</p>
<p>I will assume that you‚Äôre using a UKI with Secure Boot enabled with systemd-boot
for this section. If you don‚Äôt and want to, you can follow the
<a href="https://mako088.github.io/arch/enc_install.html">Guide</a> that I wrote or more
obviously, the Wiki.</p>
<h2>The Basics</h2>
<p>Check the <a href="https://security.archlinux.org/">Arch Linux Security Tracker</a> for
information about known vulnerabilities affecting Arch packages. It lists CVEs
(Common Vulnerabilities and Exposures) affecting packages, the severity, the
fixed versions, and advisory details.</p>
<p>Backup your system regularly, many guides consider the data already lost if it
isn‚Äôt backed up because without a backup, any data loss event (hardware failure,
ransomware attack, accidental deletion, natural disaster) becomes irreversible.
Backups act as a critical safety net that enables recovery. Without them, once
data is corrupted, deleted, or encrypted, there is no reliable way to restore
it, effectively making it lost permanently.</p>
<p>The 3-2-1 Backup Rule:</p>
<ul>
<li>
<p>3 copies of data. (Ensuring redundancy)</p>
</li>
<li>
<p>2 storage types. (Reduces risk)</p>
</li>
<li>
<p>1 offsite backup. (Protects against cyber threats and natural disasters)</p>
</li>
<li>
<p>There is a backup guide for btrfs in
<a href="https://mako088.github.io/arch/enc_install.html">enc_install</a></p>
</li>
</ul>
<p>Use Full Disk Encryption to protect your data at rest.</p>
<p>Encryption is the process of using an algorithm to scramble plaintext data into
ciphertext, making it unreadable except to a person who has the key to decrypt
it.</p>
<p><strong>Data at rest</strong> is data in storage, such as a computer‚Äôs or a servers hard
disk.</p>
<p><strong>Data at rest encryption</strong> (typically hard disk encryption), secures the
documents, directories, and files behind an encryption key. Encrypting your data
at rest prevents data leakage, physical theft, unauthorized access, and more as
long as the key management scheme isn‚Äôt compromised.</p>
<p>Enable a UEFI password or Administrator password where it requires
authentication in order to access the UEFI/BIOS.</p>
<p>Use a different password/passphrase for encryption and userspace.(i.e., user
passwd)</p>
<p>Use Secure Boot, with a Unified Kernel Image (UKI). TPM can, in some ways
increase security; I may add a section in the future.</p>
<p>When Secure Boot is used with a Unified Kernel Image, it provides enhanced
protection compared to traditional boot methods because when Secure Boot
verifies the UKI‚Äôs signature, it ensures the integrity and authenticity of:</p>
<ul>
<li>
<p>The kernel itself,</p>
</li>
<li>
<p>The <code>initramfs</code>,</p>
</li>
<li>
<p>The kernel command line parameters,</p>
</li>
<li>
<p>And indirectly, the bootloader that loads the UKI (since the bootloader
verifies the UKI signature before execution).</p>
</li>
<li>
<p>Secure boot doesn‚Äôt protect against runtime kernel exploits.</p>
</li>
</ul>
<p>This means that any tampering with these components, such as injecting malware
into the <code>initramfs</code>, altering boot parameters, or swapping the kernel would
break the signature verification and prevent the system from booting.</p>
<p><code>systemd-boot</code> has a smaller attack surface and is often recommended over GRUB
for hardened systems.</p>
<ul>
<li><a href="https://mako088.github.io/arch/enc_install.html">Encrypted Install Guide w/ systemd-boot and UKI Secure Boot</a></li>
</ul>
<p>Useful Resources:</p>
<details>
<summary> ‚úîÔ∏è Click to Expand Secure Boot Resources </summary>
<ul>
<li>
<p><a href="https://0pointer.net/blog/authenticated-boot-and-disk-encryption-on-linux.html">The Strange State of Authenticated Boot and Encryption</a></p>
</li>
<li>
<p>When using a UKI with Secure Boot, the initrd is authenticated because it‚Äôs a
sealed component of the single signed image.</p>
</li>
</ul>
</details>
<hr />
<h3>Best Practices and Standards</h3>
<p>It‚Äôs crucial to <strong>document every system change</strong> meticulously. Since Arch Linux
typically relies on manual configuration and does not use full declarative
version control by default, maintaining clear records, such as detailed
changelogs, notes, or Git repositories for your config files is essential.</p>
<p>A few options to version control some of your dotfiles:</p>
<p>Tools like <a href="https://www.gnu.org/s/stow/manual/stow.html">GNU Stow</a> and
<a href="https://chezmoi.io/install/">chezmoi</a> help bring structure and version control
to manual configurations in Arch Linux.</p>
<ul>
<li>
<p>GNU Stow uses a symlink farm approach to manage dotfiles and configuration
directories cleanly, making it easy to track and revert changes by organizing
files under a single version-controlled directory.</p>
</li>
<li>
<p><a href="https://www.chezmoi.io/">chezmoi</a> is a powerful dotfile manager focused on
reproducible, encrypted, and template-driven config management. It simplifies
applying changes across multiple machines and maintaining a documented history
of modifications.</p>
</li>
</ul>
<p>Using these tools enhances your ability to maintain clear, version-controlled
records of system changes. Consider making your dotfiles repo private if you‚Äôre
unsure what you need to protect.</p>
<p>By breaking changes into smaller, manageable tasks and documenting them with
descriptive messages, you create a clear history of modifications. This makes it
far simpler to troubleshoot issues, revert problematic changes, and maintain
security best practices over time.</p>
<p><strong>User and Permission Management</strong></p>
<ul>
<li>
<p><strong>Implement distinct user accounts</strong> to minimize the risk associated with
compromised accounts.</p>
</li>
<li>
<p><strong>Execute Specific Commands</strong>: Always execute the specific command that
requires elevation, rather than using sudo to open an entire root shell:</p>
<ul>
<li>
<p><strong>Good</strong>: <code>sudo pacman -Syu</code></p>
</li>
<li>
<p><strong>Bad</strong>: Running <code>sudo su -</code> and then running <code>pacman -Syu</code></p>
</li>
</ul>
</li>
<li>
<p>Consider using a more secure or minimal form of privilege escalation like
<code>doas</code>, <code>sudo-rs</code>, or <code>run0</code> instead of standard <code>sudo</code>.</p>
</li>
</ul>
<hr />
<h3>User and group management &amp; Strong Passwords</h3>
<ul>
<li>
<p>Users and groups are used as a form of
<a href="https://en.wikipedia.org/wiki/access_control#Computer_security">access control</a>.
They control access to the system‚Äôs files, directories, and peripherals. This
is a security feature that limits access in certain specific ways.</p>
<ul>
<li>When granting access to a resource, create a specific group and add only the
necessary users to it, rather than granting broad access to all root or
wheel users. Demonstrated in: <strong><a href="#doas-over-sudo">Doas over sudo</a></strong>.</li>
</ul>
</li>
<li>
<p>Apply the principle of least privilege by assigning users only the permissions
they actually need.</p>
</li>
<li>
<p>Avoid running services or applications as root; use dedicated service accounts
where possible.</p>
</li>
</ul>
<p><strong>Passwords/Password Quality</strong></p>
<pre><code class="language-bash">sudo pacman -S libpwquality
</code></pre>
<p>Edit <code>/etc/pam.d/passwd</code> file to read as:</p>
<pre><code class="language-passwd">#%PAM-1.0
password required pam_pwquality.so retry=2 minlen=10 difok=6 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 [badwords=myservice mydomain] enforce_for_root
password required pam_unix.so use_authtok sha512 shadow
</code></pre>
<p>The <code>/etc/pam.d/passwd</code> file with <code>pam_pwquality.so</code> specifies the enforcement
directives and some immediate password rules, which apply dynamically during
password changes.</p>
<ul>
<li>
<p><a href="https://man.archlinux.org/man/pam_pwquality.8">pam_pwuality(8)</a></p>
</li>
<li>
<p><a href="https://man.archlinux.org/man/pam_unix.8">pam_unix(8)</a></p>
</li>
<li>
<p>Use strong passwords and a password manager. The Arch Wiki
<a href="https://wiki.archlinux.org/title/Security">Security</a> section goes in depth
about this.</p>
</li>
<li>
<p>Regularly review group memberships and file permissions, especially on
sensitive system files.</p>
</li>
</ul>
<p>Edit <code>/etc/security/pwquality.conf</code> to read as:</p>
<pre><code class="language-pwquality.conf">minlen = 15
# digit
dcredit = -1
# uppercase
ucredit = -1
# lowercase
lcredit = -1
# Special character
ocredit = -1
# dictionary checks
dictcheck = 1
# username checks
usercheck = 1
usersubstr = 5
enforcing = 1
# check roots pwquality
enforce_for_root
</code></pre>
<p>The <code>/etc/security/pwquality.conf</code> file holds system-wide default parameters
that cannot all be easy expressed on the PAM line. This is a bit more
comprehensive than <code>/etc/pam.d/passwd</code>.</p>
<p>Setting <code>enforcing = 0</code> disables enforcement.</p>
<ul>
<li>
<p>Using negative values like <code>dcredit = -1</code>, <code>ucredit = -1</code>, <code>lcredit = -1</code>, and
<code>ocredit = -1</code> requires at least one digit, uppercase, lowercase, and other
(special) character respectively.</p>
</li>
<li>
<p><code>dictcheck = 1</code> and <code>usercheck = 1</code> enable dictionary checks and user name
checks to prevent weak or related passwords.</p>
</li>
</ul>
<hr />
<p><strong>Package Management and System Minimalism</strong></p>
<ul>
<li>
<p>Favor packages from the official Arch repositories managed with pacman, as
they are cryptographically signed and vetted by trusted Arch developers.</p>
</li>
<li>
<p>Use AUR packages cautiously; they lack official cryptographic signatures and
require manual review and vetting before installation.</p>
</li>
<li>
<p>Install only the software and services you truly need to reduce the attack
surface and minimize vulnerabilities.</p>
</li>
<li>
<p>Remove unused packages and disable unnecessary services to free up resources
and limit potential entry points.</p>
</li>
<li>
<p>Consider using <code>arch-audit</code> to find packages with vulnerabilities and patch
said vulnerabilities.</p>
</li>
</ul>
<hr />
<p><strong>Network and Privacy Best Practices</strong></p>
<p>On a hardened Linux system, the browser is most often the weakest link exposed
to the internet, and so security, privacy, and anti-tracking features of
browsers are now as important, or even more important than platform-level
protections.</p>
<ul>
<li>
<p><a href="https://mako088.github.io/arch/hardening_firefox.html">Hardening Firefox/Librewolf Guide</a></p>
</li>
<li>
<p>Prefer software and hardware with privacy-respecting defaults and a strong
security posture.</p>
</li>
<li>
<p>Use encrypted DNS and VPNs where possible: encrypted DNS protects your
queries, while VPNs hide your IP address. Note that VPNs do not provide
anonymity on their own and fingerprinting techniques can still reveal
information.</p>
<ul>
<li><a href="https://mako088.github.io/arch/enc_dns.html">dnscrypt-proxy w/ dnsmasq guide</a></li>
</ul>
</li>
<li>
<p>Implement a firewall to control inbound and outbound network traffic based on
predefined security rules. Firewalls serve as a critical layer of defense to
reduce attack surfaces and monitor suspicious activity.</p>
</li>
<li>
<p>Secure SSH access by disabling root login, changing default ports, and
enforcing public-key authentication to prevent brute-force and unauthorized
access attempts.</p>
</li>
</ul>
<hr />
<p><strong>Cryptography and Future-Proofing</strong></p>
<ul>
<li>
<p>The
<a href="https://www.nsa.gov/Press-Room/Press-Releases-Statements/Press-Release-View/Article/3498776/post-quantum-cryptography-cisa-nist-and-nsa-recommend-how-to-prepare-now/">NSA, CISA, and NIST warn</a>
that nation-state actors are likely stockpiling encrypted data now, preparing
for a future when quantum computers could break today‚Äôs most widely used
encryption algorithms. Sensitive data with long-term secrecy needs is
especially at risk.</p>
</li>
<li>
<p>This is a wake-up call to use the strongest encryption available today and to
plan early for post-quantum security.</p>
</li>
<li>
<p><a href="https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards">NIST First 3 Post-Quantum Encryption Standards</a>
Organizations and individuals should prepare to migrate cryptographic systems
to these new standards as soon as practical.</p>
</li>
<li>
<p>They chose
<a href="https://www.nist.gov/news-events/news/2022/07/nist-announces-first-four-quantum-resistant-cryptographic-algorithms">Four Quantum-Resistant Cryptographic Algorithms</a>
warning that public-key cryptography is especially vulnerable and widely used
to protect digital information.</p>
</li>
<li>
<p>Follow developments from entities like
<a href="https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards">NIST‚Äôs post-quantum encryption standards</a>
and implement recommendations as soon as practical.</p>
</li>
<li>
<p>Stay informed of quantum-resistant algorithm updates, especially for
public-key cryptography, as recommended by NIST and security agencies.</p>
</li>
</ul>
<hr />
<h2>Hardening/Sandboxing systemd</h2>
<ul>
<li><a href="https://wiki.archlinux.org/title/Systemd/Sandboxing">Arch Wiki systemd/sandboxing</a></li>
</ul>
<p><code>systemd</code> is the core ‚Äúinit system‚Äù and service manager that controls how
services, daemons, and basic system processes are started, stopped and
supervised on modern Linux distributions, including Arch. It provides a suite of
basic building blocks for a Linux system as well as a system and service manager
that runs as <code>PID 1</code> and starts the rest of the system.</p>
<p>Because it launches and supervises almost all system services, hardening systemd
means raising the baseline security of your entire system.</p>
<pre><code class="language-bash">sudo systemd-analyze security
# ...snip
systemd-hostnamed.service                 1.7 OK        üôÇ
systemd-importd.service                   5.0 MEDIUM    üòê
systemd-journald.service                  4.9 OK        üôÇ
systemd-logind.service                    2.8 OK        üôÇ
systemd-machined.service                  6.2 MEDIUM    üòê
</code></pre>
<p>Check a specific unit:</p>
<pre><code class="language-bash">sudo systemd-analyze security NetworkManager
</code></pre>
<pre><code class="language-bash">sudo systemctl edit NetworkManager.service
‚Üí Overall exposure level for NetworkManager.service: 9.6 UNSAFE    üò®
</code></pre>
<p>The following file will open in your $EDITOR, these settings take it from UNSAFE
to OK:</p>
<pre><code class="language-conf">[Service]
NoNewPrivileges = true
ProtectHome = true
ProtectKernelModules = true
ProtectKernelLogs = true
ProtectControlGroups = true
ProtectClock = true
ProtectHostname = true
ProtectProc = "invisible"
ProtectKernelTunables=yes
PrivateTmp = true
RestrictRealtime = true
SystemCallFilter=~@mount ~@module ~@swap ~@obsolete ~@cpu-emulation ptrace
CapabilityBoundingSet=~CAP_KILL ~CAP_SYS_CHROOT ~CAP_AUDIT_* ~CAP_SETUID ~CAP_SETGID ~CAP_SETPCAP ~CAP_SYS_ADMIN ~CAP_NET_BIND_SERVICE ~CAP_NET_BROADCAST ~CAP_NET_RAW ~CAP_DAC_OVERRIDE ~CAP
_FOWNER ~CAP_IPC_OWNER

# Allow only the essential families (AF_PACKET and exotic ones are blocked by omission)
#RestrictAddressFamilies=AF_UNIX AF_NETLINK AF_INET AF_INET6
RestrictNamespaces = true
RestrictSUIDSGID = true
MemoryDenyWriteExecute = true
SystemCallArchitectures = "native"
LockPersonality= true
UMask=0077
User=root
PrivateDevices=yes

### Edits below this comment will be discarded
</code></pre>
<pre><code class="language-bash">sudo systemctl daemon-reload
sudo systemctl restart NetworkManager
</code></pre>
<p>Sometimes you may need to reboot for the changes to take effect.</p>
<pre><code class="language-bash">sudo systemd-analyze security NetworkManager
‚Üí Overall exposure level for NetworkManager.service: 4.5 OK üôÇ
</code></pre>
<blockquote>
<p>‚ùóÔ∏è This is just one example of the many services that you can harden if you so
choose.</p>
</blockquote>
<p>Further reading on systemd:</p>
<details>
<summary> ‚úîÔ∏è Click to Expand Systemd Resources </summary>
<ul>
<li>
<p><a href="https://systemd.io/">systemd.io</a></p>
</li>
<li>
<p><a href="https://0pointer.de/blog/projects/systemd.html">Rethinking PID 1</a></p>
</li>
<li>
<p><a href="https://0pointer.de/blog/projects/the-biggest-myths.html">Biggest Myths about Systemd</a></p>
</li>
</ul>
</details>
<hr />
<h2>Lynis and other tools</h2>
<p>Lynis is a security auditing tool for systems based on UNIX like Linux, macOS,
BSD, and others.‚Äì<a href="https://github.com/CISOfy/lynis">lynis repo</a></p>
<pre><code class="language-bash">sudo pacman -S lynis
</code></pre>
<p>List commands:</p>
<pre><code class="language-bash">sudo lynis show commands
Commands:
lynis audit
lynis configure
lynis generate
lynis show
lynis update
lynis upload-only
</code></pre>
<p>Audit the system:</p>
<pre><code class="language-bash">sudo lynis audit system
 Lynis security scan details:

  Hardening index : 83 [################    ]
  Tests performed : 255
  Plugins enabled : 0
</code></pre>
<ul>
<li>
<p>The ‚ÄúLynis hardening index‚Äù is an overall impression on how well a system is
hardened. However, this is just an indicator on measures taken - not a
percentage of how safe a system might be. A score over 75 typically indicates
a system with more than average safety measures implemented.</p>
</li>
<li>
<p>Lynis will give you more recommendations for securing your system as well.</p>
</li>
</ul>
<hr />
<p><strong>rkhunter</strong> (Rootkit Hunter):</p>
<ul>
<li><a href="https://wiki.archlinux.org/title/Rkhunter">Arch Wiki RKhunter</a></li>
</ul>
<pre><code class="language-bash">sudo pacman -S rkhunter
</code></pre>
<p>Update the file properties database:</p>
<pre><code class="language-bash">sudo rkhunter --propupd
</code></pre>
<p>Keep rkhunters data files up-to-date with:</p>
<pre><code class="language-bash">sudo rkhunter --update
</code></pre>
<p>Run a system check:</p>
<pre><code class="language-bash">sudo rkhunter --check --sk
</code></pre>
<p>Validate the config files:</p>
<pre><code class="language-bash">sudo rkhunter --config-check
</code></pre>
<p>Get rid of false positives by adding the following to <code>/etc/rkhunter.conf</code>:</p>
<pre><code class="language-conf">SCRIPTWHITELIST=/usr/bin/egrep
SCRIPTWHITELIST=/usr/bin/fgrep
SCRIPTWHITELIST=/usr/bin/ldd
SCRIPTWHITELIST=/usr/bin/vendor_perl/GET
</code></pre>
<p>Run a config check:</p>
<pre><code class="language-bash">sudo rkhunter --config-check
</code></pre>
<hr />
<p><strong>ClamAV</strong></p>
<ul>
<li>
<p>Malware stands for malicious software. A computer virus is an undesirable
program running on the user‚Äôs computer often without their consent or even
without their knowledge.</p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/ClamAV">Arch Wiki ClamAV</a></p>
</li>
</ul>
<pre><code class="language-bash">sudo pacman -S clamav
</code></pre>
<p>Update the virus databases manually:</p>
<pre><code class="language-bash">sudo freshclam
</code></pre>
<p>Scan your system:</p>
<pre><code class="language-bash">sudo clamscan -r ~
----------- SCAN SUMMARY -----------
Known viruses: 8708646
Engine version: 1.4.3
Scanned directories: 6505
Scanned files: 79796
Infected files: 0
Data scanned: 4387.29 MB
Data read: 5191.41 MB (ratio 0.85:1)
Time: 1748.802 sec (29 m 8 s)
Start Date: 2025:10:03 14:32:58
End Date:   2025:10:03 15:02:07
</code></pre>
<blockquote>
<p>‚ùóÔ∏è NOTE: This can take a while, I recommend using <code>caffeine-ng</code> or <code>caffeine</code>
for this to prevent your system going to sleep while the scan completes.</p>
</blockquote>
<pre><code class="language-bash">paru -S caffeine-ng
</code></pre>
<p>This creates a coffee cup icon in your bar config on next reboot. If you‚Äôre in
the middle of something and don‚Äôt want to reboot run:</p>
<pre><code class="language-bash">caffeine &amp;
</code></pre>
<p>Click the icon and <code>Enable Caffeine</code> to prevent sleep.</p>
<hr />
<h2>Hardening the Kernel</h2>
<p>Given the kernel‚Äôs central role, it‚Äôs a frequent target for malicious actors,
making robust hardening essential.</p>
<p>You can use the <code>linux-hardened</code> kernel to have a kernel that prioritizes
security over anything else:</p>
<pre><code class="language-bash">sudo pacman -S linux-hardened linux-hardened-headers
</code></pre>
<p>Generate the <code>initramfs</code> for the hardened kernel:</p>
<pre><code class="language-bash">sudo mkinitcpio -p linux-hardened
</code></pre>
<p>Configure systemd-boot to boot the hardened kernel, the entries are configured
under <code>/boot/loader/entries/</code>. Create or edit an entry file, for example
<code>/boot/loader/entries/arch-linux-hardened.conf</code>:</p>
<pre><code class="language-text">title   Arch Linux Hardened
linux   /vmlinuz-linux-hardened
initrd  /initramfs-linux-hardened.img
options rd.luks.name=YOUR_UUID=cryptroot root=/dev/mapper/cryptroot rw quiet
</code></pre>
<p>Replace <code>YOUR_UUID</code> with the UUID of the encrypted root partition (from <code>blkid</code>)</p>
<p>To set this as the default boot entry and enable booting the last selected
kernel automatically, edit <code>/boot/loader/loader.conf</code>:</p>
<pre><code class="language-text">default arch-linux-hardened.conf
timeout 4
console-mode auto
</code></pre>
<p>Edit <code>/etc/mkinitcpio.d/linux-hardened.preset</code>:</p>
<pre><code class="language-preset"># mkinitcpio preset file for the 'linux-hardened' package

ALL_config="/etc/mkinitcpio.conf"
ALL_kver="/boot/vmlinuz-linux-hardened"

PRESETS=('default' 'fallback')

#default_config="/etc/mkinitcpio.conf"
# default_image="/boot/initramfs-linux-hardened.img"
default_uki="/boot/EFI/Linux/arch-linux-hardened.efi"
default_options="--splash /usr/share/systemd/bootctl/splash-arch.bmp"

#fallback_config="/etc/mkinitcpio.conf"
# fallback_image="/boot/initramfs-linux-hardened-fallback.img"
fallback_uki="/boot/EFI/Linux/arch-linux-hardened-fallback.efi"
fallback_options="-S autodetect"
</code></pre>
<p>Reboot and <code>linux-hardened</code> should be chosen by default. You can also choose
additional kernels if needed.</p>
<hr />
<h2>Hardening your current Kernel</h2>
<p>Sometimes <code>linux-hardened</code> just won‚Äôt work on your system without some serious
digging. You can harden your current kernel, or even better would be to harden
the Long-Term Support (LTS) kernel.</p>
<p>The Linux kernel is typically released under two forms: stable and long-term
support (LTS). Choosing either has consequences, do your research.
<a href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#stable-vs-lts">Stable vs. LTS kernels</a></p>
<ul>
<li><a href="https://www.kernel.org/category/releases.html">The Linux Kernel Archives Active kernel releases</a></li>
</ul>
<p>See which kernel you‚Äôre currently using with:</p>
<pre><code class="language-bash"># show the kernel release
uname -r
# show kernel version, hostname, and architecture
uname -a
</code></pre>
<p>Show the configuration of your current kernel:</p>
<pre><code class="language-bash">zcat /proc/config.gz
</code></pre>
<p><code>sysctl</code> is a tool that allows you to view or modify kernel settings and
enable/disable different features.</p>
<p>Check what each setting does <a href="https://sysctl-explorer.net/">sysctl-explorer</a></p>
<p>Refer to
<a href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#sysctl-kernel">madadaidans-insecurities#sysctl-kernel</a>
for the following settings and their explainations.</p>
<p>Create a file <code>/etc/sysctl.d/99-custom.conf</code>, since files are read in
lexicographical order this file will be read last, allowing it to override any
settings from earlier files.</p>
<p>To check if a parameter is already set:</p>
<pre><code class="language-bash">sysctl fs.protected_symlinks
sysctl -a | grep fs.protected
</code></pre>
<p>To list all parameters:</p>
<pre><code class="language-bash">sysctl -a &gt; params.txt
</code></pre>
<ul>
<li>
<p><code>1</code> typically means enable</p>
</li>
<li>
<p><code>0</code> typically means disable</p>
</li>
</ul>
<p>Example, both of these were the default in the zen-kernel:</p>
<pre><code class="language-bash"># 99-custom.conf
# prevent hardlink misuse
fs.protected_hardlinks = 1
# prevent symlink misuse
fs.protected_symlinks = 1
</code></pre>
<p>Apply the changes immediately:</p>
<pre><code class="language-bash">sudo sysctl --system
</code></pre>
<p>Check Active Linux Security Modules:</p>
<pre><code class="language-bash">cat /sys/kernel/security/lsm
# Output:
File: /sys/kernel/security/lsm
capability,landlock,yama,bpf,apparmor
</code></pre>
<p>Check Kernel Configuration Options:</p>
<pre><code class="language-bash">zcat /proc/config.gz | grep CONFIG_SECURITY_SELINUX
zcat /proc/config.gz | grep CONFIG_HARDENED_USERCOPY
zcat /proc/config.gz | grep CONFIG_STACKPROTECTOR
</code></pre>
<pre><code class="language-bash">sudo pacman -S kernel-hardening-checker
</code></pre>
<p>While in the same directory as the <code>params.txt</code> that we created earlier, run:</p>
<pre><code class="language-bash">kernel-hardening-checker -l /proc/cmdline -c /proc/config.gz -s ./params.txt
</code></pre>
<p>Only the warnings listed with <code>| sysctl |</code> can be edited with the above method.</p>
<p>Example <code>99-custom.conf</code> with some settings to prevent breakage:</p>
<details>
<summary> ‚úîÔ∏è Click to Expand `99-custom.conf` example </summary>
<blockquote>
<p>‚ö†Ô∏è WARNING: Always do your own research, you can find explanations to the
following settings in:
<a href="https://madaidans-insecurities.github.io/guides/linux-hardening.html#sysctl-kernel">madaidans insecurities Linux Hardening guide</a>.</p>
</blockquote>
<p>You can apply these on top of the hardened kernel as well:</p>
<pre><code class="language-conf"># Kernel Security Hardening
# ----------------------------------------------------------------------
# allow set-user-ID processes to dump core
fs.suid_dumpable = 2

# prevent pointer leaks
kernel.kptr_restrict = 2

# restrict kernel log to CAP_SYSLOG capability
kernel.dmesg_restrict = 1

# Note: certian container runtimes or browser sandboxes might rely on the following
# restrict eBPF to the CAP_BPF capability
kernel.unprivileged_bpf_disabled = 1

# should be enabled along with bpf above
# net.core.bpf_jit_harden = 2

# restrict loading TTY line disciplines to the CAP_SYS_MODULE
dev.tty.ldisk_autoload = 0

# prevent exploit of use-after-free flaws
vm.unprivileged_userfaultfd = 0

# kexec is used to boot another kernel during runtime and can be abused
kernel.kexec_load_disabled = 1

# Kernel self-protection
# SysRq exposes a lot of potentially dangerous debugging functionality to unprivileged users
# 4 makes it so a user can only use the secure attention key. A value of 0 would disable completely
kernel.sysrq = 4

# disable unprivileged user namespaces, Note: Docker and other apps may need this
# kernel.unprivileged_userns_clone = 0 # commented out because it makes apps I need fail

# restrict all usage of performance events to the CAP_PERFMON capability
kernel.perf_event_paranoid = 3

# Network Security Hardening
# ----------------------------------------------------------------------

# protect against SYN flood attacks (denial of service attack)
net.ipv4.tcp_syncookies = 1

# protection against TIME-WAIT assassination
net.ipv4.tcp_rfc1337 = 1

# enable source validation of packets received (prevents IP spoofing)
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.all.rp_filter = 1

# Disable ICMP redirects for IPv4
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.default.secure_redirects = 0

# Disable ICMP redirects for IPv6 (Protect against IP spoofing)
net.ipv6.conf.all.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0

# prevent man-in-the-middle attacks (by ignoring ICMP echo requests)
net.ipv4.icmp_echo_ignore_all = 1

# ignore bogus ICMP errors, helps avoid Smurf attacks
net.ipv4.icmp_ignore_bogus_error_responses = 1

# Disable IP forwarding
net.ipv4.conf.all.forwarding = 0

# Disable acceptance of source-routed packets for IPv4
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.conf.all.accept_source_route = 0

# Disable acceptance of source-routed packets for IPv6
net.ipv6.conf.all.accept_source_route = 0
net.ipv6.conf.default.accept_source_route = 0

# Disable IPv6 forwarding
net.ipv6.conf.all.forwarding = 0

# Disable Router Advertisements acceptance
net.ipv6.conf.all.accept_ra = 0
net.ipv6.conf.default.accept_ra = 0

# TCP Hardening
# ----------------------------------------------------------------------

# Disable TCP SACK (Selective Acknowledgement)
net.ipv4.tcp_sack = 0
net.ipv4.tcp_dsack = 0
net.ipv4.tcp_fack = 0

# Userspace/Memory Security
# ----------------------------------------------------------------------

# restrict usage of ptrace
kernel.yama.ptrace_scope = 2

# ASLR memory protection (64-bit systems)
vm.mmap_rnd_bits = 32
vm.mmap_rnd_compat_bits = 16

# only permit symlinks to be followed when outside of a world-writable sticky directory
fs.protected_symlinks = 1
fs.protected_hardlinks = 1

# Prevent creating files in potentially attacker-controlled environments
fs.protected_fifos = 2
fs.protected_regular = 2

# Randomize memory
kernel.randomize_va_space = 2

# Exec Shield (Stack protection)
# NOTE: This is generally deprecated/obsolete on modern kernels that use other hardening measures
# kernel.exec-shield = 1

# TCP Optimization
# ----------------------------------------------------------------------

# TCP Fast Open: 3 = enable for both incoming and outgoing connections
net.ipv4.tcp_fastopen = 3

# Bufferbloat mitigations + slight improvement in throughput &amp; latency
net.ipv4.tcp_congestion_control = bbr
net.core.default_qdisc = cake
</code></pre>
<h2>Disable Core Dumps</h2>
<p>A core dump consists of the recorded state of the working memory of a computer
program at a specific time, generally when a program crashes or terminates
abnormally. They can be useful for debugging but can also contain sensitive
information, to disable core dumps:</p>
<p>Create <code>/etc/sysctl.d/50-coredump.conf</code>:</p>
<pre><code class="language-conf"># disable coredumps
kernel.core_pattern = |/bin/false
# disable core dumps from setuid binaries
fs.suid_dumpable = 0
</code></pre>
<p>Apply with:</p>
<pre><code class="language-bash">sudo sysctl --system
# or
sudo sysctl -p /etc/sysctl.d/50-coredump.conf
</code></pre>
<p>Arch uses <code>systemd-coredump</code> by default, which still intercepts dumps. To fully
disable that component, create <code>/etc/systemd/coredump.conf/custom.conf</code>:</p>
<pre><code class="language-conf">[Coredump]
Storage=none
ProcessSizeMax=0
</code></pre>
<p>Then reload systemd:</p>
<pre><code class="language-bash">sudo systemctl daemon-reload
sudo systemctl mask systemd-coredump.socket
</code></pre>
</details>
<h2>Kernel and Namespace Hardening and Blacklisting</h2>
<ul>
<li>
<p><strong>Protect the kernel image</strong>:</p>
<ul>
<li>
<p>Enable Secure Boot to ensure only trusted boot components are loaded.</p>
</li>
<li>
<p>Enforce kernel module signature verification by adding
<code>module.sig_enforce=1</code> to your kernel parameters (e.g., create
<code>/etc/cmdline.d/security.conf</code> with this line). This restricts loading
unsigned kernel modules.</p>
</li>
<li>
<p>NOTE: This setting is strict and may break compatibility with some drivers
or modules. Thorough testing and research are recommended before enforcing
it.</p>
</li>
</ul>
</li>
<li>
<p><strong>Protect the <code>/boot</code> partition</strong>:</p>
<ul>
<li>
<p>The above setting is fairly strict and will break some things. Do research
before going so strict.</p>
</li>
<li>
<p>Make <code>/boot</code> read-only if you have a high threat model. It can cause issues
though, setting more strict permissions helps.</p>
</li>
</ul>
</li>
<li>
<p>Lock kernel modules (optional):</p>
<ul>
<li>Set <code>module.sig_enforce=1</code> in kernel parameters.(i.e.,
<code>/etc/cmdline.d/security.conf</code>)</li>
</ul>
</li>
</ul>
<p>Blacklist unneeded modules in <code>/etc/modprobe.d/blacklist.conf</code>:</p>
<pre><code class="language-conf">blacklist dccp          # Datagram Congestion Control Protocol
blacklist sctp          # Stream Control Transmission Protocol
blacklist rds           # Reliable Datagram Sockets
blacklist tipc          # Transparent Inter-Process Communication
blacklist n_hdlc        # High-level Data Link Control
blacklist ax25          # Amateur X.25
blacklist netrom        # NetRom
blacklist x25           # X.25
blacklist rose
blacklist decnet
blacklist econet
blacklist af_802154     # IEE 802.15.4
blacklist ipx           # Internetwork Packet Exchange
blacklist appletalk
blacklist psnap         # SubnetworkAccess Protocol
blacklist p8023         # Novell raw IEE 802.3
blacklist p8022         # IEE 802.3
blacklist can           # Controller Area Network
blacklist atm
# Various rare filesystems
blacklist cramfs
blacklist freevxfs
blacklist jffs2
blacklist hfs
blacklist hfsplus
blacklist udf
# Less rare but often recommended
# Optionally blacklist squashfs, cifs, nfs etc. by uncommenting:
# blacklist squashfs
# blacklist cifs
# blacklist nfs
# blacklist nfsv3
# blacklist nfsv4
# blacklist ksmbd
# blacklist gfs2
# blacklist vivid
</code></pre>
<p>There are more suggestions in the madaidans insecurities guide.</p>
<p>Apply the changes:</p>
<pre><code class="language-bash">sudo mkinitcpio -P
</code></pre>
<p>Check which modules were included in the initramfs (Long Output):</p>
<pre><code class="language-bash">mkinitcpio -v &gt; /tmp/mk.txt
</code></pre>
<p>Then search through the file and ensure they weren‚Äôt loaded.</p>
<blockquote>
<p>‚ùóÔ∏è Note: This may break some networking and virtualization tools.</p>
</blockquote>
<ul>
<li>
<p>Force-enable PTI (Page Table Isolation):</p>
<ul>
<li>Add <code>pti=on</code> to the kernel command line.</li>
</ul>
</li>
<li>
<p>User namespaces:</p>
<ul>
<li>
<p>Do <strong>not</strong> set <code>kernel.unprivileged_userns_clone=0</code> if desktop
sandboxing/containers are used.</p>
</li>
<li>
<p>Set <code>kernel.unprivileged_userns_clone=0</code> in <code>/etc/sysctl.d/</code> to disable if
containers are not required.</p>
</li>
</ul>
</li>
<li>
<p>SMT/Hyperthreading policy:</p>
<ul>
<li>
<p>For extra isolation, add <code>nosmt</code> to kernel parameters.</p>
</li>
<li>
<p>Disabling SMT reduces performance.</p>
</li>
</ul>
</li>
</ul>
<hr />
<h2>Firewall</h2>
<p><strong>nftables</strong> is designed to replace <strong>iptables</strong> by providing a modern,
simplified, and unified packet filtering and classification framework in the
Linux kernel. It reuses the underlying Netfilter infrastructure but introduces a
new kernel API and completely different user-space tool (<code>nft</code>).</p>
<ul>
<li><a href="https://wiki.archlinux.org/title/Nftables">Arch Wiki nftables</a></li>
</ul>
<p><strong>Installation</strong>:</p>
<pre><code class="language-bash">sudo pacman -S nftables
</code></pre>
<p>There is an example firewall ruleset located at <code>/etc/nftables.conf</code> and more
examples located in <code>/usr/share/nftables/</code> and
<code>/usr/share/doc/nftables/examples/</code></p>
<p>Flush existing iptables Rules &amp; Disable iptables if necessary.</p>
<p><strong>Create nftables ruleset</strong>:</p>
<pre><code class="language-bash">#-----------------------------------------------------------------------------
# Flush existing rules: ensure a clean slate before loading new rules
#-----------------------------------------------------------------------------
flush ruleset
table inet filter {
    # -------------------------------------------------------------------------
    # INPUT CHAIN (Incoming Traffic destined for this host)
    # Default is to DROP all incoming traffic
    # -------------------------------------------------------------------------
    chain input {
        type filter hook input priority filter; policy drop;

        # Drop invalid packets (e.g., malformed or out-of-state)
        ct state invalid drop

        # Allow loopback traffic (localhost to localhost)
        iif "lo" accept

        # Allow established and related connections (replies to outgoing, FTP helper)
        ct state established,related accept

        # Allow specific ICMP types for IPv4
        ip protocol icmp icmp type { echo-request, echo-reply, destination-unreachable, time-exceeded } accept

        # Allow critical ICMPv6 types for IPv6 (essential for network function)
        ip6 nexthdr icmpv6 icmpv6 type { echo-request, echo-reply, destination-unreachable, packet-too-big, time-exceeded, parameter-problem, nd-router-advert, nd-router-solicit, nd-neighbor-solicit, nd-neighbor-advert } accept

        # Allow SSH (port 2222) with rate-limiting to prevent brute-force attacks
        tcp dport 2222 ct state new limit rate 15/minute accept

        # Allow HTTP and HTTPS (ports 80 and 443)
        tcp dport { 80, 443 } ct state new accept

        # Log packets that reach the end of the chain before they are dropped by the policy (optional)
        log prefix "nft-input-drop: "
    }

    # -------------------------------------------------------------------------
    # FORWARD CHAIN (Routed Traffic passing through this host)
    # Default is to DROP all routed traffic (host-based firewall)
    # -------------------------------------------------------------------------
    chain forward {
        type filter hook forward priority filter; policy drop;

        # Drop invalid packets
        ct state invalid drop

        # Allow established and related connections
        ct state established,related accept

        # Add specific FORWARD rules here if the machine is acting as a router/gateway
    }

    # -------------------------------------------------------------------------
    # OUTPUT CHAIN (Outgoing Traffic originating from this host)
    # Default is to DROP all outgoing traffic for maximum security
    # -------------------------------------------------------------------------
    chain output {
    type filter hook output priority filter; policy drop;

    # Allow essential local communication
    oif "lo" accept

    # Allow replies for established and related connections (critical)
    ct state established,related accept

    # Allow DNS queries (UDP and TCP)
    udp dport 53 accept
    tcp dport 53 accept

    # Allow general outbound web access (e.g., for updates, API calls)
    tcp dport { 80, 443 } accept

    # Allow Git (and general SSH client) outgoing connections
    tcp dport 22 ct state new accept

    # Allow NTP (Network Time Protocol) for time synchronization
    udp dport 123 accept

    # Use meta l4proto to correctly match MLDv2 Type 143 packets
    meta l4proto ipv6-icmp icmpv6 type {
        echo-request,
        destination-unreachable,
        time-exceeded,
        parameter-problem,
        nd-neighbor-solicit,
        nd-neighbor-advert,
        mld2-listener-report
    } accept

    # Log packets that reach the end of the chain before they are dropped by the policy (optional)
    log prefix "nft-output-drop: "
    }
}
</code></pre>
<blockquote>
<p>‚ùóÔ∏è Most desktop firewalls default to <strong>allow all outgoing traffic</strong>
(<code>policy accept</code> on the output chain). This is done for convenience, as it
prevents applications from breaking. However, for a system practicing zero
trust, the best practice is to enforce a <strong>default deny</strong>(<code>policy drop</code>) on
the output chain and <strong>only explicitly allow</strong> the services the system needs.</p>
</blockquote>
<pre><code class="language-bash">sudo systemctl enable nftables.service
sudo systemctl start nftables.service
</code></pre>
<p>Load and test the rules if in a different location than the default:</p>
<pre><code class="language-bash">sudo nft -f /path/to/your/nftables.conf
</code></pre>
<p>or in default location:</p>
<pre><code class="language-bash">sudo nft -f /etc/nftables.conf
</code></pre>
<blockquote>
<p>‚ùóÔ∏è If you don‚Äôt use SSH or host a web server or any service, don‚Äôt allow SSH
and HTTP/HTTPS.</p>
</blockquote>
<pre><code class="language-bash">sudo nft list ruleset
</code></pre>
<hr />
<h2>SSH &amp; GPG Key Generation and Safety</h2>
<h3>ssh-keygen</h3>
<p>The <code>ed25519</code> algorithm is significantly faster and more secure when compared to
<code>RSA</code>. You can also specify the key derivation function (KDF) rounds to
strengthen protection even more.</p>
<p>For example, to generate a strong key for MdBook:</p>
<pre><code class="language-bash">ssh-keygen -t ed25519 -a 32
</code></pre>
<p>Or more specifically:</p>
<pre><code class="language-bash">ssh-keygen -t ed25519 -a 32 -f ~/.ssh/id_ed25519_github_$(date +%Y-%m-%d) -C "SSH Key for GitHub"
</code></pre>
<ul>
<li>
<p><code>-t</code> is for type</p>
</li>
<li>
<p><code>-a 32</code> sets the number of KDF rounds. The standard is usually good enough,
adding extra rounds can make it harder to brute-force.</p>
</li>
<li>
<p><code>-f</code> is for filename</p>
</li>
</ul>
<hr />
<h3>GnuPG and gpg-agent</h3>
<details>
<summary> ‚úîÔ∏è Click to Expand GnuPG section </summary>
<p><code>gpg --full-generate-key</code> can be used to generate a basic keypair.</p>
<p><code>gpg --expert --full-generate-key</code> can be used for keys that require more
capabilities.</p>
<blockquote>
<p>‚ùó NOTE: We will first generate our GPG primary key that is required to
atleast have sign capabilities, we will then derive subkeys from said primary
key and use them for signing and encrypting. It is recommended to generate a
revoke certificate right after creating your primary key.</p>
</blockquote>
<p>To generate your gpg primary key you can do the following:</p>
<pre><code class="language-bash">gpg --full-generate-key
</code></pre>
<ul>
<li>
<p>Choose <code>(10) (sign only)</code></p>
</li>
<li>
<p>Give it a name and description</p>
</li>
<li>
<p>Give it an expiration date, 1y is common</p>
</li>
<li>
<p>Use a strong passphrase or password</p>
</li>
<li>
<p>Give it a comment, I typically add the date</p>
</li>
</ul>
<p>If you see a warning about incorrect permissions, you can run the following:</p>
<pre><code class="language-bash">chmod 700 ~/.gnupg
chmod 600 ~/.gnupg/*
</code></pre>
<p>Verify:</p>
<pre><code class="language-bash">ls -ld ~/.gnupg
# Should show: drwx------

ls -l ~/.gnupg
# Files should show: -rw-------
</code></pre>
<hr />
<h3>Generate a Revocation Certificate</h3>
<p><code>mykey</code> must be a key specifier, either the keyID of the primary keypair or any
part of the user ID that identifies the keypair:</p>
<p>Replace <code>mykeyID</code> with the keyID of your primary key and store the cert in a
safe place:</p>
<pre><code class="language-bash">gpg --output revoke.asc --gen-revoke mykeyID
Create a revocation certificate for this key? (y/N)
Please select the reason for the revocation:
  0 = No reason specified
  1 = Key has been compromised
  2 = Key is superseded
  3 = Key is no longer used
  Q = Cancel
(Probably you want to select 1 here)
Your decision?
</code></pre>
<p>The certificate will be output to a file <code>revoke.asc</code>. If the <code>--output</code> is
ommitted, the result will be placed on stdout.</p>
<p>Since it‚Äôs a short certificate, you can print a hardcopy and store it somewhere
safe. The cert shouldn‚Äôt be somewhere that others can access it since anyone
could publish the revoke cert and render the corresponding public key useless.</p>
<p>To apply the revoke cert, import it:</p>
<pre><code class="language-bash">gpg --import revoke.asc
# And optionally push the revoked key to public keyservers to notify others:
gpg --keyserver keyserver.ubuntu.com --send-keys YOUR_KEYID
</code></pre>
<hr />
<h3>Generate Gpg Subkeys</h3>
<pre><code class="language-bash"># Take note of your public key
gpg --list-keys --with-fingerprint
/home/jr/.gnupg/pubring.kbx
---------------------------
pub   ed25519/0x095782A1B124AF15 2025-08-23 [SCA] [expires: 2026-08-23]
Key fingerprint = 5908 9C5B FEC8 0D75 FCB0  E206 0958 82C1 A124 CF15
uid                   [ultimate] Jr (08-23-25) &lt;sayls8@proton.me&gt;
</code></pre>
<ul>
<li>Copy the KeyID, in this example it would be <code>0x095722B2A123CF15</code>. We will use
it for the command below.</li>
</ul>
<p>Now we will generate 2 subkeys, 1 for encryption and 1 for authentication.</p>
<pre><code class="language-bash">gpg --expert --edit-key 0x095722B2A123CF15
</code></pre>
<p>Choose 11 (set your own capabilities) and add A (Authenticate) and type Q.
Create another key while still in the menu with only encrypt capabilities.</p>
<blockquote>
<p>‚ùó <code>gpg --edit-key</code> has many more capabilities, after launching type <code>help</code>.</p>
</blockquote>
<p><strong>Add Keygrip of Authenticate Subkey to <code>sshcontrol</code> for gpg-agent</strong></p>
<pre><code class="language-bash">gpg --list-secret-keys --with-keygrip --keyid-format LONG
</code></pre>
<p>Copy the keygrip of the subkey with Authenticate capabilities</p>
<pre><code class="language-bash">echo "6BD11826F3845BC222127FE3D22C92C91BB3FB32" &gt; ~/.gnupg/sshcontrol
</code></pre>
<pre><code class="language-bash">ssh-add -L
# you should see something like:
ssh-ed25519 AABCC3NzaC1lZDI1NTE5ABBAIHyujgyCjjBTqIuFM3EMUSo6RGklmOXQW3uWRhWdJ1Mm (none)
</code></pre>
<ul>
<li>By itself, a keygrip cannot be used to reconstruct your private key. It‚Äôs
derived from the public key material, not from the secret key itself so it‚Äôs
safe to version control. Don‚Äôt put your keygrip in a public repo if you don‚Äôt
want people to know you use that key for signing/authentication. It‚Äôs not a
security risk, but it leaks a tiny bit of metadata.</li>
</ul>
<p>The following article mentions the keygrip being computed from public elements
of the key:</p>
<ul>
<li><a href="https://gnupg-users.gnupg.narkive.com/q5JtahdV/gpg-agent-what-is-a-keygrip">gnupg-users what-is-a-keygrip</a></li>
</ul>
<p>Create a <code>~/.gnupg/gpg.conf</code>:</p>
<p>Copy the KeyID of the key with Authenticate capabilities and use it as your
default-key in <code>gpg.conf</code>:</p>
<ul>
<li><a href="https://riseup.net/ru/security/message-security/openpgp/gpg-best-practices">RiseUp GPG Best Practices</a></li>
</ul>
<pre><code class="language-bash">#
# This is an implementation of the Riseup OpenPGP Best Practices
# https://help.riseup.net/en/security/message-security/openpgp/best-practices
#


#-----------------------------
# default key
#-----------------------------

# The default key to sign with. If this option is not used, the default key is
# the first key found in the secret keyring

#default-key 0xD8692123C4065DEA5E0F3AB5249B39D24F25E3B6


#-----------------------------
# behavior
#-----------------------------

# Disable inclusion of the version string in ASCII armored output
no-emit-version

# Disable comment string in clear text signatures and ASCII armored messages
no-comments

# Display long key IDs
keyid-format 0xlong

# List all keys (or the specified ones) along with their fingerprints
with-fingerprint

# Display the calculated validity of user IDs during key listings
list-options show-uid-validity
verify-options show-uid-validity

# Try to use the GnuPG-Agent. With this option, GnuPG first tries to connect to
# the agent before it asks for a passphrase.
use-agent


#-----------------------------
# keyserver
#-----------------------------

# This is the server that --recv-keys, --send-keys, and --search-keys will
# communicate with to receive keys from, send keys to, and search for keys on
keyserver hkps://keys.openpgp.org/

# Set the proxy to use for HTTP and HKP keyservers - default to the standard
# local Tor socks proxy
# It is encouraged to use Tor for improved anonymity. Preferrably use either a
# dedicated SOCKSPort for GnuPG and/or enable IsolateDestPort and
# IsolateDestAddr
#keyserver-options http-proxy=socks5-hostname://127.0.0.1:9050

# Don't leak DNS, see https://trac.torproject.org/projects/tor/ticket/2846
keyserver-options no-try-dns-srv

# When using --refresh-keys, if the key in question has a preferred keyserver
# URL, then disable use of that preferred keyserver to refresh the key from
keyserver-options no-honor-keyserver-url

# When searching for a key with --search-keys, include keys that are marked on
# the keyserver as revoked
keyserver-options include-revoked


#-----------------------------
# algorithm and ciphers
#-----------------------------

# list of personal digest preferences. When multiple digests are supported by
# all recipients, choose the strongest one
personal-cipher-preferences AES256 AES192 AES CAST5

# list of personal digest preferences. When multiple ciphers are supported by
# all recipients, choose the strongest one
personal-digest-preferences SHA512 SHA384 SHA256 SHA224

# message digest algorithm used when signing a key
cert-digest-algo SHA512

# This preference list is used for new keys and becomes the default for
# "setpref" in the edit menu
default-preference-list SHA512 SHA384 SHA256 SHA224 AES256 AES192 AES CAST5 ZLIB BZIP2 ZIP Uncompressed
</code></pre>
<p>Add the following to your shell config, either <code>.bashrc</code> or <code>.zshrc</code>:</p>
<pre><code class="language-zsh">GPG_TTY=$(tty)
export GPG_TTY
export SSH_AUTH_SOCK=$(gpgconf --list-dirs agent-ssh-socket)
gpgconf --launch gpg-agent
</code></pre>
<p>Rebuild and then restart <code>gpg-agent</code> if necessary:</p>
<pre><code class="language-bash">gpgconf --kill gpg-agent
gpgconf --launch gpg-agent
</code></pre>
<p>Test, these should match:</p>
<pre><code class="language-bash">echo "$SSH_AUTH_SOCK"
# output
/run/user/1000/gnupg/d.wft5hcsny4qqq3g31c76534j/S.gpg-agent.ssh

gpgconf --list-dirs agent-ssh-socket
# output
/run/user/1000/gnupg/d.wft5hcsny4qqq3g31c76834j/S.gpg-agent.ssh
</code></pre>
<pre><code class="language-bash">ssh-add -L
# Copy the entire following line:
ssh-ed25519 AABBC3NzaC1lZDI1NTE5AAAAIGXwhVokJ6cKgodYT+0+0ZrU0sBqMPPRDPJqFxqRtM+I (none)
</code></pre>
<ul>
<li>It shows <code>(none)</code> because the comment field is blank on subkeys.</li>
</ul>
<h3>Backing up Your Keys</h3>
<pre><code class="language-bash">gpg --export-secret-keys --armor --output my-private-key-backup.gpg
</code></pre>
<p>Your private keys will be encrypted with a passphrase into a .gpg file. Store
this backup in a secure location line an encrypted USB drive. This can prevent
you from losing access to your keys in the case of disk failure or accidents.</p>
<p>You can export your public keys and publish them publicly if you choose:</p>
<pre><code class="language-bash">gpg --export --armor --output my-public-keys.gpg
</code></pre>
<p>Now if your keys ever get lost or corrupted, you can import these backups.</p>
<hr />
<h3>Remove and Store your Primary Key offline</h3>
<blockquote>
<p>‚ùó NOTE: After you remove your primary key, you will no longer be able to
derive subkeys from it or sign keys unless you re-import it.</p>
</blockquote>
<pre><code class="language-bash"># extract the primary key
gpg -a --export-secret-key sayls8@proton.me &gt; secret_key
# extract the subkeys, which we will reimport later
gpg -a --export-secret-subkeys sayls8@proton.me &gt; secret_subkeys.gpg
# delete the secret keys from the keyring, so only subkeys are left
gpg --delete-secret-keys sayls8@proton.me
Delete this key from the keyring? (y/N) y
This is a secret key! - really delete? (y/N) y
# reimport the subkeys
gpg --import secret_subkeys.gpg
# verify everything is in order
gpg --list-secret-keys
# remove the subkeys from disk
rm secret_subkeys.gpg
</code></pre>
<p>I recommend also keeping a <code>.gpg</code> version to make it easy to re-import your
primary key: <code>gpg --export-secret-keys --armor --output private-key-bak.gpg</code></p>
<p>Then store <code>secret_key</code> on an encrypted USB drive or somewhere offline. If you
want to protect it for now, you can just use the encryption subkey that we
created to encrypt <code>secret_key</code> with a passphrase:</p>
<pre><code class="language-bash">gpg --list-keys --keyid-format LONG
</code></pre>
<p>Copy the KeyID of the subkey with encrypt capabilities for the following
command:</p>
<pre><code class="language-bash"># Encrypting your secret key for yourself
gpg --encrypt --recipient Ox37ACA569C5C44787 secret_key
</code></pre>
<p>You can check that the secret key material is missing with
<code>gpg --list-secret-keys</code>, you should see <code>sec#</code> instead of <code>sec</code>.</p>
<pre><code class="language-bash">gpg --list-secret-keys
# Output:
sec#  ed25519/0x
# ...snip...
</code></pre>
<p>The above set of commands are from the
<a href="https://riseup.net/ru/security/message-security/openpgp/gpg-best-practices#keep-your-primary-key-entirely-offline">RiseUp Keep your primary key offline</a></p>
</details>
<hr />
<h2>Hardening OpenSSH</h2>
<p>OpenSSH is a tool that allows you to remotely connect to your machine with the
SSH protocol. It encrypts all traffic to prevent eavesdropping, connection
hijacking, and other attacks.</p>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/OpenSSH">Arch Wiki OpenSSH</a></p>
</li>
<li>
<p><a href="https://www.openssh.com/">OpenSSH</a></p>
</li>
</ul>
<p>Install and configure fail2ban:</p>
<pre><code class="language-bash">sudo pacman -S fail2ban
</code></pre>
<p>Create a <code>/etc/fail2ban/jail.local</code> file:</p>
<pre><code class="language-bash">[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 5
bantime = 3600  # 1 hour in seconds
findtime = 600
ignoreip = 127.0.0.1/8 ::1
banaction = iptables-multiport
</code></pre>
<p>Start and enable the service:</p>
<pre><code class="language-bash">sudo systemctl enable fail2ban
sudo systemctl start fail2ban
</code></pre>
<p>Harden OpenSSH settings in <code>/etc/ssh/sshd_config</code>:</p>
<pre><code class="language-bash">PasswordAuthentication no
PermitEmptyPasswords no
PubkeyAuthentication yes
AuthorizedKeysFile     %h/.ssh/authorized_keys
UsePAM yes
PermitTunnel no
UseDNS no
KbdInteractiveAuthentication no
X11Forwarding no  # or yes if you have X server enabled
MaxAuthTries 3
MaxSessions 2
ClientAliveInterval 300
ClientAliveCountMax 0
AllowUsers your-user
TCPKeepAlive no
AllowTcpForwarding no
AllowAgentForwarding no
LogLevel VERBOSE
PermitRootLogin no
KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com
</code></pre>
<p>Enable and start sshd:</p>
<pre><code class="language-bash">sudo systemctl enable sshd
sudo systemctl start sshd
</code></pre>
<p>Ensure all of the permissions are correct:</p>
<pre><code class="language-bash">chmod 755 $HOME
chmod 700 $HOME/.ssh
</code></pre>
<p>Add the output of <code>ssh-add -L</code> to <code>~/.ssh/authorized_keys</code></p>
<pre><code class="language-bash">echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGXwhVokJ6cKgodYT+0+0ZrU0sBqMPPRDPJqFxqRtM+I (none)" &gt; ~/.ssh/authorized_keys
</code></pre>
<p>After adding the <code>authorized_key</code>, adjust the permission:</p>
<pre><code class="language-bash">chmod 600 $HOME/.ssh/authorized_keys
</code></pre>
<p>Finally, test an ssh connection:</p>
<pre><code class="language-bash">ssh user@hostname
# Example
ssh jr@archlinux
# Specify the port
ssh -p 22 user@hostname
</code></pre>
<hr />
<h4>Tip Change the Default Port</h4>
<blockquote>
<p>‚ö†Ô∏è Critical Warning: Do not close your existing SSH session until you
successfully connect using the new port. If you make a mistake and get locked
out, you‚Äôll need console access to your server to fix it</p>
</blockquote>
<p>Edit <code>/etc/ssh/sshd_config</code> to add the line:</p>
<pre><code class="language-config">Port 2222
</code></pre>
<p>Update the Firewall Rules in <code>/etc/nftables.conf</code>:</p>
<p>Replace this line:</p>
<pre><code class="language-conf">tcp dport ssh accept comment "allow sshd"
</code></pre>
<p>with:</p>
<pre><code class="language-conf">tcp dport 2222 accept comment "allow sshd on port 2222"
</code></pre>
<p>This change explicitly allows new incomming TCP connections on port 2222 for
SSH, ensuring remote access will work through the firewall.</p>
<p>Reload the Firewall:</p>
<pre><code class="language-bash">sudo nft -f /etc/nftables.conf
</code></pre>
<p>Restart sshd:</p>
<pre><code class="language-bash">sudo systemctl restart sshd
</code></pre>
<p>Finally, text a connection:</p>
<pre><code class="language-bash">ssh -p 2222 user@hostname
</code></pre>
<hr />
<h2>USB Port Protection</h2>
<ul>
<li><a href="https://wiki.archlinux.org/title/USBGuard">Arch Wiki USBGuard</a></li>
</ul>
<p>It‚Äôs important to protect your USB ports to prevent BadUSB attacks, data
exfiltration, unauthorized device access, malware injection, etc.</p>
<p>To get a list of your connected USB devices you can use <code>lsusb</code> from the
<code>usbutils</code> package.</p>
<pre><code class="language-bash">lsusb
</code></pre>
<p>Install usbguard:</p>
<pre><code class="language-bash">sudo pacman -S usbguard
# Optionally; paru -S usbguard-notifier fails with bad keys
# paru -S usbguard-notifier-git
</code></pre>
<p>Create a <code>usbguard</code> group and add your user to it:</p>
<pre><code class="language-bash">sudo groupadd usbguard
sudo usermod -aG usbguard username
</code></pre>
<p>Generate a policy based on your currently attached USB devices with:</p>
<pre><code class="language-bash">sudo usbguard generate-policy | sudo tee /etc/usbguard/rules.conf
# Or if everything else fails
# sudo bash -c "usbguard generate-policy &gt; /etc/usbguard/rules.conf"
</code></pre>
<pre><code class="language-bash">sudo chmod 600 /etc/usbguard/rules.d/99-policy.conf
</code></pre>
<h3>USBGuard Daemon</h3>
<blockquote>
<p>‚ùóÔ∏è If practicing zero-trust, you would want to change your default policy to
<code>apply-policy</code>. This way any device that isn‚Äôt explicitly allowed will be
blocked. It‚Äôs easy to lock yourself out if done incorrectly.</p>
</blockquote>
<p>Edit <code>/etc/usbguard/usbguard-daemon.conf</code> to set the policy to allow devices
that are already connected for members of the <code>usbguard</code> group:</p>
<pre><code class="language-conf"># ...snip...
RuleFile=/etc/usbguard/rules.conf

# Default policy for devices that were already connected when the daemon started.
# Supported values: apply-policy, allow, block, reject, keep.
PresentDevicePolicy=allow

# A list of users and groups that are allowed to interact with the daemon
# via the IPC interface.
#IPCAllowedUsers=root your-user
IPCAllowedUsers=usbguard
</code></pre>
<p>From the above file we can see that it expects its configuration file to be
located at <code>/etc/usbguard/rules.d/</code>:</p>
<pre><code class="language-bash">sudo mkdir -p /etc/usbguard/rules.d
</code></pre>
<p>Create a file <code>/etc/usbguard/rules.d/99-policy.conf</code>:</p>
<pre><code class="language-conf"># allow `only` devices with mass storage interfaces (USB Mass Storage)
allow with-interface equals { 08:*:* }

# allow mice and keyboards
# allow with-interface equals { 03:*:* }

# Reject devices with suspicious combination of interfaces
reject with-interface all-of { 08:*:* 03:00:* }
reject with-interface all-of { 08:*:* 03:01:* }
reject with-interface all-of { 08:*:* e0:*:* }
reject with-interface all-of { 08:*:* 02:*:* }
</code></pre>
<p>The above policy can be found in
<a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/security_guide/sec-using-usbguard">RedHat UsbGuard</a></p>
<p>The only allow rule is for devices with only mass storage interfaces (08:<em>:</em>)
i.e., USB Mass storage devices, devices like keyboards and mice (which use
interface class <code>03:*:*</code>) implicitly not allowed.(commented out)</p>
<p>The reject rules reject devices with a suspicious combination of interfaces. A
USB drive that implements a keyboard or a network interface is very suspicious,
these reject rules prevent that.</p>
<p>The <code>presentDevicePolicy = "allow"</code> allows any device that is present at daemon
start up even if they‚Äôre not explicitly allowed. However, newly plugged in
devices must match an allow rule or get denied implicitly.</p>
<p>Enable/Start <code>usbguard.service</code>:</p>
<pre><code class="language-bash">sudo systemctl enable usbguard
sudo systemctl start usbguard --now
</code></pre>
<ul>
<li>Sometimes a reboot is required. If your keyboard doesn‚Äôt work, after entering
your encryption passphrase, enter the TTY with <code>Alt+Ctrl+F2</code> and ensure the
<code>usbguard</code> group exists and your user is a member.</li>
</ul>
<p>Check status:</p>
<pre><code class="language-bash">sudo systemctl status usbguard
</code></pre>
<pre><code class="language-bash">sudo usbguard list-devices
</code></pre>
<ul>
<li>
<p>If you plug something new in and it doesn‚Äôt work, this is why. Remember this!</p>
</li>
<li>
<p><a href="https://docs.kernel.org/usb/authorization.html">Authorizing (or not) USB devices</a></p>
</li>
</ul>
<hr />
<h3>Firejail</h3>
<blockquote>
<p>‚ùóÔ∏è Critics such as madaidan say that Firejail worsens security by acting as a
privilege escalation hole. Firejail requires the executable to be setuid,
meaning it runs with root privileges. Experienced users are encouraged to use
bubblewrap for it‚Äôs minimal design and specificity of its purpose.</p>
</blockquote>
<p>A <strong>setuid binary</strong> is an executable file with a special permission bit set
called ‚Äúset user ID‚Äù (setuid). When a user runs a setuid binary, the program
executes with the permissions of the binary‚Äôs owner, rather than the permissions
of the user running it.</p>
<p>There are mitigations for the above risks I will share further down.</p>
<p>Another option here is <a href="https://wiki.archlinux.org/title/Bubblewrap">Bubblewrap</a></p>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/Firejail">Arch Wiki Firejail</a></p>
</li>
<li>
<p><a href="https://madaidans-insecurities.github.io/linux.html#firejail">Firejail weaknesses</a></p>
</li>
</ul>
<pre><code class="language-bash">sudo pacman -S firejail
</code></pre>
<p>Usage:</p>
<pre><code class="language-bash">firejail librewolf
</code></pre>
<p>Using by default:</p>
<pre><code class="language-bash">sudo firecfg
</code></pre>
<p>fix <code>.desktop</code> files with:</p>
<pre><code class="language-bash">firecfg --fix
</code></pre>
<p>This creates symbolic links in <code>/usr/local/bin/</code> pointing to <code>/usr/bin/firejail</code>
for programs for which Firejail has default or self-created profiles.</p>
<p>You can inspect <code>/etc/firejail/</code> to see all the pre-baked profiles available.</p>
<h2>Hardening Firejail</h2>
<p>Add the following line to <code>/etc/firejail/firejail.config</code>:</p>
<pre><code class="language-config">force-nonewprivs yes
</code></pre>
<ul>
<li>The above setting prevents Firejail and its child processes from gaining new
privileges after the sandbox is started.
<ul>
<li>Changing the owner and group to <code>root:firejail</code> and permissions to <code>4750</code>
means Firejail runs with setuid root but only allows execution by users in
the firejail group reducing the attack surface.</li>
</ul>
</li>
</ul>
<blockquote>
<p>‚ùóÔ∏è This breaks some apps such as VirtualBox which I don‚Äôt recommend and if
using the hardened kernel, Wireshark and Chromium-based browsers are also
affected.</p>
</blockquote>
<ul>
<li><a href="https://www.whonix.org/wiki/KVM#Why_Use_KVM_Over_VirtualBox?">Why Use KVM over VirtualBox</a></li>
</ul>
<p>Add a pacman hook to automatically change firejail owner and mode. Create
<code>/etc/pacman.d/hooks/firejail-permissions.hook</code> and place the following in it:</p>
<pre><code class="language-hook">[Trigger]
Operation = Install
Operation = Upgrade
Type = Package
Target = firejail
[Action]
Depends = coreutils
Depends = bash
When = PostTransaction
Exec = /usr/bin/sh -c "chown root:firejail /usr/bin/firejail &amp;&amp; chmod 4750 /usr/bin/firejail"
Description = Setting /usr/bin/firejail owner to "root:firejail" and mode "4750"
</code></pre>
<p>Create a <code>firejail</code> group:</p>
<pre><code class="language-bash">sudo groupadd firejail
</code></pre>
<p>and add your user to it:</p>
<pre><code class="language-bash">sudo gpasswd -a $USER firejail
</code></pre>
<p><strong>Verify Firejail‚Äôs being used</strong>:</p>
<p>Launch the program that you want to ensure is running sandboxed and run:</p>
<pre><code class="language-bash">firejail --list
# or more comprehensive
firejail --tree
</code></pre>
<p><strong>Enable AppArmor support</strong>:</p>
<pre><code class="language-bash">sudo apparmor_parser -r /etc/apparmor.d/firejail-default
</code></pre>
<p>With firejail running, I noticed that none of my browsers would allow me to
download anything. A fix for this is to run:</p>
<pre><code class="language-bash">sudo firejail --noprofile firefox
</code></pre>
<p>Download your file, close firefox and run again in the firejail sandbox.</p>
<blockquote>
<p>Tip from Arch Wiki <code>/etc/pacman.d/hooks/firejail.hook</code></p>
<p>For cases where you need to manually modify the <code>Exec=</code> line of the .desktop
file in <code>~/.local/share/applications</code> to explicitly call Firejail.</p>
<pre><code class="language-hook"> [Trigger]
 Type = Path
 Operation = Install
 Operation = Upgrade
 Operation = Remove
 Target = usr/bin/*
 Target = usr/share/applications/*.desktop

 [Action]
 Description = Configure symlinks in /usr/local/bin based on firecfg.config...
 When = PostTransaction
 Depends = firejail
 Exec = /bin/sh -c 'firecfg &gt;/dev/null 2&gt;&amp;1'
</code></pre>
</blockquote>
<p>To manually map individual applications, execute:</p>
<pre><code class="language-bash">sudo ln -s /usr/bin/firejail /usr/local/bin/application-to-sandbox
</code></pre>
<h3>Remove Firejail symlinks</h3>
<pre><code class="language-bash">sudo firecfg --clean
</code></pre>
<p>If you would rather confine an app with AppArmor or Bubblewrap:</p>
<pre><code class="language-bash">sudo rm /usr/local/bin/application
</code></pre>
<p>Also, comment out <code>application</code> in the <code>/etc/firejail/firecfg.config</code> to prevent
it from being added if you run <code>firecfg</code> again.</p>
<details>
<summary> ‚úîÔ∏è Click to Expand Firejail Resources </summary>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/Firejail">Arch Wiki Firejail</a></p>
</li>
<li>
<p><a href="https://github.com/netblue30/firejail/issues/2507">Profiles not in firecfg</a></p>
</li>
<li>
<p><a href="https://firejail.wordpress.com/documentation-2/">Firejail Docs</a></p>
</li>
<li>
<p><a href="https://github.com/netblue30/firejail/wiki/Debugging-Firejail">Debugging Firejail</a></p>
</li>
<li>
<p><a href="https://debugging.works/blog/debugging-firejail/">How to debug a firejail sandbox</a></p>
</li>
</ul>
</details>
<hr />
<h2>AppArmor</h2>
<p><a href="https://apparmor.net/">AppArmor</a> is a
<a href="https://wiki.archlinux.org/title/Mandatory_Access_Control">Mandatory Access Control</a>
(MAC) system, implemented upon the
<a href="https://en.wikipedia.org/wiki/Linux_Security_Modules">Linux Security Modules</a>(LSM)
‚Äì Arch Wiki</p>
<p>MAC systems generally block all access by default, only permitting actions that
are explicitly defined as allowed in their security policy or access profiles.</p>
<p>This is why, if you read about creating your own policy that they recommend
setting AppArmor to complain mode while you use said app using all functionality
and APIs you can think of before setting to enforce. Within a policy everything
is default-deny so any action not covered in the above steps will be blocked by
default.</p>
<blockquote>
<p>‚ùóÔ∏è The AppArmor policy con only be considered default deny if it is deployed
as a complete system policy which we don‚Äôt do here. The apps and parts of the
system that don‚Äôt have pre-defined policies aren‚Äôt covered by AppArmor so are
therefore default allow. You can get there in time but it‚Äôs beyond the scope
of this section.</p>
</blockquote>
<p>Install:</p>
<pre><code class="language-bash">sudo pacman -S apparmor
</code></pre>
<p>Edit <code>/etc/cmdline.d/security.conf</code>:</p>
<pre><code class="language-conf"># enable apparmor
lsm=landlock,lockdown,yama,integrity,apparmor,bpf audit=1 audit_backlog_limit=256
</code></pre>
<p>Save &amp; Reboot</p>
<p>Start/Enable AppArmor:</p>
<pre><code class="language-bash">sudo systemctl enable apparmor
sudo systemctl start apparmor
</code></pre>
<p>Ensure the LSM is loaded with:</p>
<pre><code class="language-bash">zgrep CONFIG_LSM=/proc/config.gz
# &amp;
cat /sys/kernel/security/lsm
</code></pre>
<p>Reboot, and run <code>sudo aa-enabled</code>, and <code>sudo aa-status</code>. You should see many
profiles in enforce mode.</p>
<h3>Switching an app from unconfined mode to enforce</h3>
<ul>
<li>First, ensure a profile exists</li>
</ul>
<p>Check AppArmor log messages:</p>
<p>Each time AppArmor denies applications from doing something potentially harmful
the event is logged.</p>
<pre><code class="language-bash">sudo journalctl -fx
</code></pre>
<p>NOTE: Your firewall can also trigger this.</p>
<h3>Disabling AppArmor</h3>
<p>Disable AppArmor by unloading all profiles for the current session:</p>
<pre><code class="language-bash">sudo aa-teardown
</code></pre>
<p>Further reading:</p>
<ul>
<li>
<p><a href="https://apparmor.net/">AppArmor Quick Intro</a></p>
</li>
<li>
<p><a href="https://gitlab.com/apparmor/apparmor/-/wikis/home">AppArmor Wiki</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/AppArmor">Arch Wiki AppArmor</a></p>
</li>
</ul>
<h2>Creating or adding profiles that aren‚Äôt pre-configured</h2>
<p>For example, thunderbird came with a profile that just allowed everything.
Rather than creating my own profile I cloned the <code>apparmor-profiles</code> repo and
got it from there.</p>
<pre><code class="language-bash">mkdir aa &amp;&amp; cd aa
git clone git://git.launchpad.net/apparmor-profiles
</code></pre>
<pre><code class="language-bash">sudo cp ~/aa/apparmor-profiles/thunderbird /etc/apparmor.d/usr.bin.thunderbird
</code></pre>
<p>Create a local override file, this is where you will make your personal changes
to existing profiles:</p>
<pre><code class="language-bash">sudo mkdir -p /etc/apparmor.d/local
sudo touch /etc/apparmor.d/local/usr.bin.thunderbird
</code></pre>
<p>Set the new profile to enforce mode:</p>
<pre><code class="language-bash">sudo aa-enforce /etc/apparmor.d/usr.bin.thunderbird
</code></pre>
<hr />
<p><strong>Creating a new profile</strong></p>
<ul>
<li><a href="https://gitlab.com/apparmor/apparmor/-/wikis/Profiling_with_tools">Profiling_with_tools</a></li>
</ul>
<ol>
<li>Temporarily disable kernel rate limiting on logs:</li>
</ol>
<pre><code class="language-bash">sudo sysctl -w kernel.printk_ratelimit=0
</code></pre>
<ol start="2">
<li>Start <code>aa-genprof</code>:</li>
</ol>
<pre><code class="language-bash">sudo aa-genprof &lt;path-to-executable&gt;
# Example
sudo aa-genprof /usr/bin/brave
</code></pre>
<ol start="3">
<li>Execute a test plan, open and close brave, download a file through brave,
adjust settings, do anything you can think of with brave.</li>
</ol>
<ul>
<li>
<p>Press S to Scan system log for AppArmor events</p>
</li>
<li>
<p>Press F to Finish</p>
</li>
</ul>
<p>This simple example created this profile in <code>/etc/apparmor.d/usr.bin.brave</code>:</p>
<pre><code class="language-text"># Last Modified: Wed Oct  8 09:29:51 2025
abi &lt;abi/4.0&gt;,

include &lt;tunables/global&gt;

/usr/bin/brave flags=(complain) {
  include &lt;abstractions/base&gt;

  /usr/bin/brave r,
  /usr/bin/env ix,

}
</code></pre>
<h3>Profiling by Hand</h3>
<p>Disable kernel rate limiting:</p>
<pre><code class="language-bash">sysctl -w kernel.printk_ratelimit=0
</code></pre>
<p>Lets pick up from our /usr/bin/brave example:</p>
<p>Create a preliminary profile</p>
<pre><code class="language-text"># Last Modified: Wed Oct  8 09:29:51 2025
abi &lt;abi/4.0&gt;,

include &lt;tunables/global&gt;

/usr/bin/brave flags=(complain) {
  include &lt;abstractions/base&gt;

  /usr/bin/brave r,
  /usr/bin/env ix,

}

</code></pre>
<h3>Auditd</h3>
<p>Linux audit makes your system more secure by providing you the means to analyze
what‚Äôs going on in your system in great detail. It does not provide any security
itself, but instead is useful for tracking these issues and helps you take
additional security measures to prevent them.</p>
<p>Install with:</p>
<pre><code class="language-bash">sudo pacman -S audit
</code></pre>
<ul>
<li>Enable audit at boot-time by setting <code>audit=1</code> as a kernel parameter,
typically either in <code>/etc/kernel/cmdline</code> or <code>/etc/cmdline.d/security.conf</code>
for UKIs.</li>
</ul>
<p>For example, this is my <code>/etc/cmdline.d/security.conf</code>:</p>
<pre><code class="language-conf"># enable apparmor                               # enable audit
lsm=landlock,lockdown,yama,integrity,apparmor,bpf audit=1 audit_backlog_limit=256
</code></pre>
<p>Create a group to follow principle of least privilege:</p>
<pre><code class="language-bash">sudo groupadd audit-view
sudo usermod -a -G audit-view $USER
</code></pre>
<p>In <code>/etc/audit/auditd.conf</code>, change <code>log_group = root</code> to:</p>
<pre><code class="language-conf">log_group = audit-view
</code></pre>
<p>Enable:</p>
<pre><code class="language-bash">sudo systemctl enable auditd
sudo systemctl start auditd --now
</code></pre>
<p>To create new profiles, <code>auditd</code> should be running. AppArmor can use kernel
audit logs from the userspace auditd daemon, allowing you to build new profiles.</p>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/Audit_framework">Audit Framework</a></p>
</li>
<li>
<p><a href="https://man.archlinux.org/man/auditd.8.en">Arch manpage auditd</a></p>
</li>
</ul>
<p>A basic set of rules could be to create a <code>/etc/audit/rules.d/audit.rules</code> with
the following contents:</p>
<pre><code class="language-audit.rules"># Clear existing rules
-D

# Set buffer size
-b 8192

# Monitor /etc/passwd for modifications
-w /etc/passwd -p wa -k passwd_changes

# Monitor sudo command execution
-w /usr/bin/sudo -p x -k sudo_usage

# Enable auditing
-e 1

# Make rules immutable
-e 2
</code></pre>
<p>Validate and load the rules, this will populate <code>/etc/audit/audit.rules</code> with
the rules we just set:</p>
<pre><code class="language-bash">sudo augenrules --load
</code></pre>
<p>Ensure <code>auditd</code> is running:</p>
<pre><code class="language-bash">sudo systemctl status auditd
</code></pre>
<p>Since we set a watch rule for sudo let‚Äôs run an update and check the auditd
logs:</p>
<pre><code class="language-bash">sudo pacman -Syu
</code></pre>
<p>View the logs:</p>
<pre><code class="language-bash">sudo ausearch -k sudo_usage
</code></pre>
<p>View the Summary Report:</p>
<pre><code class="language-bash">sudo aureport
sudo aureport --auth
man aureport
</code></pre>
<p>Verify the rules are loaded:</p>
<pre><code class="language-bash">sudo auditctl -l
</code></pre>
<p>Be careful here, if you enable <code>auditd</code> and don‚Äôt iron out the kinks I‚Äôve found
that it freezes after you enter your cryptroot passphrase. If this happens to
you, follow the chroot steps but skip the <code>arch-chroot /mnt</code> step and instead
run:</p>
<pre><code class="language-bash">systemctl --root=/mnt disable auditd
</code></pre>
<p>Unmount the partitions, close cryptroot, and Reboot.</p>
<hr />
<h3>Doas over sudo</h3>
<blockquote>
<p>‚ùóÔ∏è Removing sudo may cause compatibility issues with some scripts/tools that
expect it, I haven‚Äôt had many issues but you should test before completely
removing it.</p>
</blockquote>
<p>For a more minimalist version of <code>sudo</code> with a smaller codebase and attack
surface, consider <code>doas</code>:</p>
<pre><code class="language-bash">sudo pacman -S opendoas
</code></pre>
<p>Create a <code>doas</code> group:</p>
<pre><code class="language-bash">sudo groupadd doas
</code></pre>
<p>Add your user to the <code>doas</code> group:</p>
<pre><code class="language-bash">sudo usermod -aG doas $USER
</code></pre>
<p>Create <code>/etc/doas.conf</code> with the following contents:</p>
<pre><code class="language-conf">permit setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :doas
</code></pre>
<p>You can add a line below that one like <code>permit nopass your-username as root:</code>
Enabling your user passwordless usage, it‚Äôs much less secure but an option.</p>
<p>Alternatively, you can setup the doas persist feature with the following:</p>
<pre><code class="language-conf">permit persist setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :doas
</code></pre>
<ul>
<li>
<p>With the above setting, after you successfully authenticate. You won‚Äôt be
asked for your password for the next 5 minutes. It‚Äôs disabled by default
because it can be dangerous if used in the wrong environment.</p>
</li>
<li>
<p>You may need to either reboot or do a soft-reset for the groups to take
effect.</p>
</li>
</ul>
<p>For <code>yay</code>, you can run:</p>
<pre><code class="language-bash">yay --sudo doas --save
</code></pre>
<p>For <code>paru</code>, edit <code>/etc/paru.conf</code>. Near bottom:</p>
<pre><code class="language-conf">Sudo = doas
</code></pre>
<p>Edit <code>/etc/mkepkg.conf</code>:</p>
<pre><code class="language-bash">doas hx /etc/makepkg.conf
</code></pre>
<p>At the bottom of the file uncomment <code>PACMAN_AUTH=()</code> and add <code>doas</code>:</p>
<pre><code class="language-conf">PACMAN_AUTH=(doas)
</code></pre>
<p>Secure the <code>doas.conf</code>:</p>
<pre><code class="language-conf">doas chown -c root:root /etc/doas.conf
doas chmod -c 0400 /etc/doas.conf
</code></pre>
<pre><code class="language-bash">doas pacman -Syu
</code></pre>
<p>Test and ensure most commands that you use work before removing sudo so you‚Äôre
aware of potential issues. To benefit from the smaller codebase and attack
surface, you have to remove sudo.</p>
<pre><code class="language-bash">doas pacman -R sudo base-devel
</code></pre>
<p>Create a symlink replacing sudo with doas:</p>
<pre><code class="language-bash">ln -s $(which doas) /usr/bin/sudo
</code></pre>
<p>Now, when you run <code>sudo</code>, <code>doas</code> will be executed. There are some compatibility
issues with this method but not super common.</p>
<h2>Intrusion Detection</h2>
<details>
<summary> ‚úîÔ∏è Click to Expand AIDE Example </summary>
<p>From what I‚Äôve seen, this would work best if you‚Äôre running a server or self
hosting where your system will be running without you there tweaking settings
and AIDE will alert you if anything changes in the meantime.</p>
<pre><code class="language-bash">paru -S aide
</code></pre>
<ul>
<li>
<p><a href="https://aide.github.io/doc/">AIDE Manual</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/AIDE">Arch Wiki AIDE</a></p>
</li>
</ul>
<p>AIDE is an intrusion detection system (IDS) that will notify us whenever it
detects that a potential intrusion has occurred. When a system is compromised,
attackers typically will try to change file permissions and escalate to the root
user account and start to modify system files, AIDE can detect this.</p>
<p>To set up AIDE on your system follow these steps:</p>
<ol>
<li>
<p>There is a default config at <code>/etc/aide.conf</code>:</p>
</li>
<li>
<p>Initialize the database:</p>
</li>
</ol>
<pre><code class="language-bash">sudo aide -i
</code></pre>
<p>You will see in the output of the above command that
<code>AIDE successfully initialized database. New AIDE database written to /var/lib/aide/aide.db.new.gz</code></p>
<ol start="3">
<li>Move the new database and remove the <code>.new</code>:</li>
</ol>
<pre><code class="language-bash">sudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz
</code></pre>
<ol start="4">
<li>Check the system against the baseline database:</li>
</ol>
<pre><code class="language-bash">sudo aide -C
</code></pre>
<ol start="5">
<li>Whenever you make changes to system files, or especially after running a
system update or installing new tools, you have to rescan all files to update
their checksums in the AIDE database:</li>
</ol>
<pre><code class="language-bash">sudo aide -u
</code></pre>
<p>Unfortunately, AIDE doesn‚Äôt automatically replace the old database so you have
to rename the new one again:</p>
<pre><code class="language-bash">sudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz
</code></pre>
<p>And finally check again:</p>
<pre><code class="language-bash">sudo aide -C
Start timestamp: 2025-10-02 14:57:49 -0400 (AIDE 0.19.2)
AIDE found NO differences between database and filesystem. Looks okay!!
</code></pre>
<ul>
<li>
<p>The default settings are fairly strict, I kept getting reports of changes
detected because the mtime and ctime of a directory changed. It‚Äôs fairly easy
to set ignore rules by adding a <code>!</code> in front of the path.</p>
</li>
<li>
<p><a href="https://linux.die.net/man/1/aide">aide(1) man page</a></p>
</li>
</ul>
<p>Create the logfile:</p>
<pre><code class="language-bash">sudo mkdir -p /var/log/aide
sudo touch /var/log/aide/aide.log
</code></pre>
</details>
<h3>Resources</h3>
<details>
<summary> ‚úîÔ∏è Click to Expand Resources </summary>
<ul>
<li>
<p><a href="https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot">Arch Wiki Secure Boot</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/OpenVAS">Arch Wiki OpenVAS</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/AppArmor">Arch Wiki AppArmor</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/SELinux">Arch Wiki SELinux</a></p>
</li>
<li>
<p><a href="https://wiki.archlinux.org/title/Security">Arch Wiki Security</a></p>
</li>
<li>
<p><a href="https://github.com/archlinuxhardened/selinux">archlinuxhardened/selinux</a></p>
</li>
<li>
<p><a href="https://wiki.gentoo.org/wiki/Security_Handbook/Concepts">Gentoo Security_Handbook Concepts</a></p>
</li>
<li>
<p>STIGs are configuration standards developed by the Defense Information Systems
Agency (DISA) to secure systems and software for the U.S. Department of
Defense (DoD). They are considered a highly authoritative source for system
hardening.There are recommendations for hardening all kinds of software in the
<a href="https://stigviewer.com/stigs">Stig Viewer</a></p>
</li>
<li>
<p><a href="https://www.cisecurity.org/cis-benchmarks">CIS Benchmarks</a></p>
</li>
<li>
<p><a href="https://github.com/nsacyber">NSA Cybersecurity Directorate</a></p>
</li>
<li>
<p><a href="https://www.rodsbooks.com/efi-bootloaders/secureboot.html">rodsbooks Secure Boot</a></p>
</li>
<li>
<p><a href="https://web.archive.org/web/20140422190914/https://securityinabox.org/en/truecrypt_main">TrueCrypt Guide</a></p>
</li>
<li>
<p><a href="https://web.archive.org/web/20140220055801/http://crunchbang.org:80/forums/viewtopic.php?id=24722">#! Paranoid Security Guide</a></p>
</li>
<li>
<p><a href="https://cybersecuritynews.com/hardening-linux-servers">Hardening-Linux-Servers</a></p>
</li>
<li>
<p><a href="https://linux-audit.com/linux-server-hardening-most-important-steps-to-secure-systems/">linux-audit Linux Server hardening best practices</a></p>
</li>
<li>
<p><a href="https://linux-audit.com/linux-security-guide-extended-version/">linux-audit Linux security guide extended</a></p>
</li>
<li>
<p><a href="https://madaidans-insecurities.github.io/linux.html">madaidans-insecurities</a></p>
</li>
<li>
<p><a href="https://madaidans-insecurities.github.io/guides/linux-hardening.html">madaidans-insecurities Linux Hardening Guide</a></p>
</li>
<li>
<p><a href="https://zebracrossing.narwhalacademy.org/">Zebra Crossing digital safety checklist</a></p>
</li>
<li>
<p><a href="https://datadetoxkit.org/en/privacy/essentials#step-1">DataDetoxKit</a></p>
</li>
<li>
<p><a href="https://datadetoxkit.org/en/privacy/degooglise/">DataDetox Degooglise</a></p>
</li>
<li>
<p><a href="https://tb-manual.torproject.org/">Tor Browser User Manual</a></p>
</li>
<li>
<p><a href="https://gitlab.torproject.org/tpo/team/-/wikis/home">Tor Wiki</a></p>
</li>
<li>
<p><a href="https://onionshare.org/">VeraCrypt Beginners Tutorial</a></p>
</li>
</ul>
</details>
]]></description><author>saylesss88</author><guid>https://saylesss88.github.io/privacy-book/arch/hardening_arch.html</guid><pubDate>Fri, 28 Nov 2025 00:00:00 +0000</pubDate></item></channel></rss>